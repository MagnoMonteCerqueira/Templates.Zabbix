<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>6.0</version><date>2023-02-11T16:15:09Z</date><groups><group><uuid>748ad4d098d447d492bb935c907f652f</uuid><name>Templates/Databases</name></group></groups><templates><template><uuid>36116d8675da47b8a678193969d5a787</uuid><template>CockroachDB by HTTP</template><name>CockroachDB by HTTP</name><description>Get CockroachDB metrics from Prometheus and health endpoints by HTTP agent.

Internal node metrics are collected from Prometheus /_status/vars endpoint.
Node health metrics are collected from /health and /health?ready=1 endpoints.
Template doesn't require usage of session token.

Don't forget change macros {$COCKROACHDB.API.SCHEME} according to your situation (secure/insecure node).

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback

Template tooling version used: 0.41</description><groups><group><name>Templates/Databases</name></group></groups><items><item><uuid>90f7e9b6d22e4c30990f06f0320056d3</uuid><name>CockroachDB: CA certificate expiration date</name><type>DEPENDENT</type><key>cockroachdb.cert.expire_date.ca</key><delay>0</delay><history>7d</history><trends>0</trends><value_type>FLOAT</value_type><units>unixtime</units><description>CA certificate expires at that date.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>security_certificate_expiration_ca</parameter><parameter>value</parameter><parameter/></parameters><error_handler>DISCARD_VALUE</error_handler></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>6h</parameter></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>ca-certificate</value></tag></tags><triggers><trigger><uuid>76a2093eb0214185ab8e03986f3f1474</uuid><expression>(last(/CockroachDB by HTTP/cockroachdb.cert.expire_date.ca) - now()) / 86400 &lt; {$COCKROACHDB.CERT.CA.EXPIRY.WARN}</expression><name>CockroachDB: CA certificate expires soon</name><event_name>CockroachDB: CA certificate expires soon (less than {$COCKROACHDB.CERT.CA.EXPIRY.WARN} days)</event_name><priority>WARNING</priority><description>CA certificate expires soon.</description><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>0328c188d5954ae48dcc0649c9c01f52</uuid><name>CockroachDB: Node certificate expiration date</name><type>DEPENDENT</type><key>cockroachdb.cert.expire_date.node</key><delay>0</delay><history>7d</history><trends>0</trends><value_type>FLOAT</value_type><units>unixtime</units><description>Node certificate expires at that date.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>security_certificate_expiration_node</parameter><parameter>value</parameter><parameter/></parameters><error_handler>DISCARD_VALUE</error_handler></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>6h</parameter></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>node-certificate</value></tag></tags><triggers><trigger><uuid>592152fe1dde4e81abd4bee76c3dae9d</uuid><expression>(last(/CockroachDB by HTTP/cockroachdb.cert.expire_date.node) - now()) / 86400 &lt; {$COCKROACHDB.CERT.NODE.EXPIRY.WARN}</expression><name>CockroachDB: Node certificate expires soon</name><event_name>CockroachDB: Node certificate expires soon (less than {$COCKROACHDB.CERT.NODE.EXPIRY.WARN} days)</event_name><priority>WARNING</priority><description>Node certificate expires soon.</description><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>156d0c66c25a4938b87bd4527580cfd4</uuid><name>CockroachDB: Clock offset</name><type>DEPENDENT</type><key>cockroachdb.clock.offset</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>s</units><description>Mean clock offset of the node against the rest of the cluster.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>clock_offset_meannanos</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>0.000000001</parameter></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>system</value></tag></tags><triggers><trigger><uuid>bddc5c6ac7294bb4be9ed8a4f4d4f4a9</uuid><expression>min(/CockroachDB by HTTP/cockroachdb.clock.offset,5m) &gt; {$COCKROACHDB.CLOCK.OFFSET.MAX.WARN} * 0.001</expression><name>CockroachDB: Clock offset is too high</name><event_name>CockroachDB: Clock offset is too high (over {$COCKROACHDB.CLOCK.OFFSET.MAX.WARN}ms for 5m)</event_name><priority>WARNING</priority><description>Cockroach-measured clock offset is nearing limit (by default, servers kill themselves at 400ms from the mean).</description><tags><tag><tag>scope</tag><value>health</value></tag></tags></trigger></triggers></item><item><uuid>7b6ef56741c14222bef3d40af3bb6b44</uuid><name>CockroachDB: CPU: System time</name><type>DEPENDENT</type><key>cockroachdb.cpu.system_time</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>s</units><description>System CPU time.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_cpu_sys_ns</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>0.000000001</parameter></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>cpu</value></tag></tags></item><item><uuid>42008c218c0b4049a4e94daf40754dd7</uuid><name>CockroachDB: CPU: User time</name><type>DEPENDENT</type><key>cockroachdb.cpu.user_time</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>s</units><description>User CPU time.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_cpu_user_ns</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>0.000000001</parameter></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>cpu</value></tag></tags></item><item><uuid>b13dceebd399415f868c3f1ce68ee46a</uuid><name>CockroachDB: CPU: Utilization</name><type>DEPENDENT</type><key>cockroachdb.cpu.util</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>%</units><description>CPU utilization in %.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_cpu_combined_percent_normalized</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>100</parameter></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>cpu</value></tag></tags></item><item><uuid>e186df881d6e40ac966e23341b2dbd36</uuid><name>CockroachDB: File descriptors: Limit</name><type>DEPENDENT</type><key>cockroachdb.descriptors.limit</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Open file descriptors soft limit of the process.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_fd_softlimit</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>3h</parameter></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>storage</value></tag></tags></item><item><uuid>e21fd3d697294d0f93b504ba57e7552e</uuid><name>CockroachDB: File descriptors: Open</name><type>DEPENDENT</type><key>cockroachdb.descriptors.open</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The number of open file descriptors.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_fd_open</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>storage</value></tag></tags></item><item><uuid>4525de4ee6994c34af6ea3444295bd58</uuid><name>CockroachDB: Disk: IOPS in progress, rate</name><type>DEPENDENT</type><key>cockroachdb.disk.iops.in_progress.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of disk IO operations currently in progress on this host.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_host_disk_iopsinprogress</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>storage</value></tag></tags></item><item><uuid>1240655e000643c98694a5efbb0582d0</uuid><name>CockroachDB: Disk: Read IOPS, rate</name><type>DEPENDENT</type><key>cockroachdb.disk.iops.read.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of disk read operations per second across all disks since this process started.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_host_disk_read_count</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>storage</value></tag></tags></item><item><uuid>cfa381c7317d479ea5e24b0a3ac9de6a</uuid><name>CockroachDB: Disk: Write IOPS, rate</name><type>DEPENDENT</type><key>cockroachdb.disk.iops.write.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Disk write operations per second across all disks since this process started.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_host_disk_write_count</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>storage</value></tag></tags></item><item><uuid>e226b55a125d4360b853690dbd0d9b63</uuid><name>CockroachDB: Disk: Reads, rate</name><type>DEPENDENT</type><key>cockroachdb.disk.read.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>Bps</units><description>Bytes read from all disks per second since this process started</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_host_disk_read_bytes</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>storage</value></tag></tags></item><item><uuid>327d62286a5c40d49690b89b12350c31</uuid><name>CockroachDB: Disk: Writes, rate</name><type>DEPENDENT</type><key>cockroachdb.disk.write.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>Bps</units><description>Bytes written to all disks per second since this process started.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_host_disk_write_bytes</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>storage</value></tag></tags></item><item><uuid>8092c82f81824a168328a438d85a0a93</uuid><name>CockroachDB: GC: Pause time</name><type>DEPENDENT</type><key>cockroachdb.gc.pause_time</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>s</units><description>The amount of processor time used by Go's garbage collector across all nodes. During garbage collection, application code execution is paused.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_gc_pause_ns</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>0.000000001</parameter></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>gc</value></tag></tags></item><item><uuid>72298c0f0a00460e85562d13e3baf4b0</uuid><name>CockroachDB: GC: Runs, rate</name><type>DEPENDENT</type><key>cockroachdb.gc.runs.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The number of times that Go's garbage collector was invoked per second across all nodes.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_gc_count</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>gc</value></tag></tags></item><item><uuid>a8cd030e869b4d788126ee5fa35d3403</uuid><name>CockroachDB: Get health</name><type>HTTP_AGENT</type><key>cockroachdb.get_health</key><history>7d</history><description>Get node /health endpoint</description><valuemap><name>Node health</name></valuemap><preprocessing><step><type>CHECK_NOT_SUPPORTED</type><parameters><parameter/></parameters></step><step><type>REGEX</type><parameters><parameter>HTTP.*\s(\d+)</parameter><parameter>\1</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>3h</parameter></parameters></step></preprocessing><timeout>15s</timeout><url>{$COCKROACHDB.API.SCHEME}://{HOST.CONN}:{$COCKROACHDB.API.PORT}/health</url><status_codes>200,500</status_codes><retrieve_mode>HEADERS</retrieve_mode><tags><tag><tag>component</tag><value>health</value></tag></tags><triggers><trigger><uuid>6ccd74acda004a738c3003af4526cd91</uuid><expression>last(/CockroachDB by HTTP/cockroachdb.get_health) = 500</expression><name>CockroachDB: Node is unhealthy</name><priority>AVERAGE</priority><description>Node's /health endpoint has returned HTTP 500 Internal Server Error which indicates unhealthy mode.</description><dependencies><dependency><name>CockroachDB: Service is down</name><expression>last(/CockroachDB by HTTP/net.tcp.service[&quot;{$COCKROACHDB.API.SCHEME}&quot;,&quot;{HOST.CONN}&quot;,&quot;{$COCKROACHDB.API.PORT}&quot;]) = 0</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>health</value></tag></tags></trigger></triggers></item><item><uuid>926415babea74e2f951a0420bbdf1d8d</uuid><name>CockroachDB: Get metrics</name><type>HTTP_AGENT</type><key>cockroachdb.get_metrics</key><history>0</history><trends>0</trends><value_type>TEXT</value_type><description>Get raw metrics from the Prometheus endpoint.</description><preprocessing><step><type>CHECK_NOT_SUPPORTED</type><parameters><parameter/></parameters></step></preprocessing><timeout>15s</timeout><url>{$COCKROACHDB.API.SCHEME}://{HOST.CONN}:{$COCKROACHDB.API.PORT}/_status/vars</url><tags><tag><tag>component</tag><value>raw</value></tag></tags></item><item><uuid>3e5e18e02b1b4f8d8f17c2e7d993169c</uuid><name>CockroachDB: Get readiness</name><type>HTTP_AGENT</type><key>cockroachdb.get_readiness</key><history>7d</history><description>Get node /health?ready=1 endpoint</description><valuemap><name>Node readiness</name></valuemap><preprocessing><step><type>CHECK_NOT_SUPPORTED</type><parameters><parameter/></parameters></step><step><type>REGEX</type><parameters><parameter>HTTP.*\s(\d+)</parameter><parameter>\1</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>3h</parameter></parameters></step></preprocessing><timeout>15s</timeout><url>{$COCKROACHDB.API.SCHEME}://{HOST.CONN}:{$COCKROACHDB.API.PORT}/health?ready=1</url><status_codes>200,503</status_codes><retrieve_mode>HEADERS</retrieve_mode><tags><tag><tag>component</tag><value>health</value></tag></tags></item><item><uuid>a36bcb9217054c1db2e67c8533842d01</uuid><name>CockroachDB: Go: Goroutines count</name><type>DEPENDENT</type><key>cockroachdb.go.goroutines.count</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Current number of Goroutines. This count should rise and fall based on load.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_goroutines</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>go</value></tag></tags></item><item><uuid>9dcb023ceacb4023897af11b96592d6b</uuid><name>CockroachDB: Liveness heartbeats, rate</name><type>DEPENDENT</type><key>cockroachdb.heartbeaths.success.rate</key><delay>0</delay><history>7d</history><description>Number of successful node liveness heartbeats per second from this node.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>liveness_heartbeatsuccesses</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>liveness</value></tag></tags></item><item><uuid>1a01d2c75d934f489e171a3a147a2078</uuid><name>CockroachDB: KV transactions: Aborted, rate</name><type>DEPENDENT</type><key>cockroachdb.kv.transactions.aborted.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of aborted KV transactions per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>txn_aborts</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>kv</value></tag></tags></item><item><uuid>be9c377ac5a64579a3b849bbd28e4dc7</uuid><name>CockroachDB: KV transactions: Committed, rate</name><type>DEPENDENT</type><key>cockroachdb.kv.transactions.committed.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of KV transactions (including 1PC) committed per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>txn_commits</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>kv</value></tag></tags></item><item><uuid>872eaa89c9e34c358f60b845316a22c0</uuid><name>CockroachDB: Live nodes count</name><type>DEPENDENT</type><key>cockroachdb.live_count</key><delay>0</delay><history>7d</history><description>The number of live nodes in the cluster (will be 0 if this node is not itself live).</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>liveness_livenodes</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>3h</parameter></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>liveness</value></tag></tags></item><item><uuid>5a8bf48e85b845bf83346491ccf5cfac</uuid><name>CockroachDB: Memory: Allocated by Cgo</name><type>DEPENDENT</type><key>cockroachdb.memory.cgo.allocated</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>B</units><description>Current bytes of memory allocated by the C layer.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_cgo_allocbytes</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>cgo</value></tag><tag><tag>component</tag><value>memory</value></tag></tags></item><item><uuid>07dc780b07ee4a34abd9bc658416f507</uuid><name>CockroachDB: Memory: Managed by Cgo</name><type>DEPENDENT</type><key>cockroachdb.memory.cgo.managed</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>B</units><description>Total bytes of memory managed by the C layer.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_cgo_totalbytes</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>cgo</value></tag><tag><tag>component</tag><value>memory</value></tag></tags></item><item><uuid>af45fdeea2ff4b7ba2d488b704966f16</uuid><name>CockroachDB: Memory: Allocated by Go</name><type>DEPENDENT</type><key>cockroachdb.memory.go.allocated</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>B</units><description>Current bytes of memory allocated by the Go layer.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_go_allocbytes</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>go</value></tag><tag><tag>component</tag><value>memory</value></tag></tags></item><item><uuid>74669e09ce86441d877de519c86b3f83</uuid><name>CockroachDB: Memory: Managed by Go</name><type>DEPENDENT</type><key>cockroachdb.memory.go.managed</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>B</units><description>Total bytes of memory managed by the Go layer.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_go_totalbytes</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>go</value></tag><tag><tag>component</tag><value>memory</value></tag></tags></item><item><uuid>14524b3f8c5f4d509d15063af19c9569</uuid><name>CockroachDB: Memory: Allocated by SQL</name><type>DEPENDENT</type><key>cockroachdb.memory.sql</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>B</units><description>Current SQL statement memory usage for root.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_mem_root_current</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>memory</value></tag><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>c10b66dd872145528540e90ad3198b81</uuid><name>CockroachDB: Memory: Total usage</name><type>DEPENDENT</type><key>cockroachdb.memory.total</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>B</units><description>Resident set size (RSS) of memory in use by the node.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_rss</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>memory</value></tag></tags></item><item><uuid>aee505389afb4fb0a4a7d8b8dd58fe76</uuid><name>CockroachDB: Network: Bytes received, rate</name><type>DEPENDENT</type><key>cockroachdb.network.bytes.received.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>Bps</units><description>Bytes received per second on all network interfaces since this process started.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_host_net_recv_bytes</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>network</value></tag></tags></item><item><uuid>9b04fac1a84e40aa833366fda679a3e3</uuid><name>CockroachDB: Network: Bytes sent, rate</name><type>DEPENDENT</type><key>cockroachdb.network.bytes.sent.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>Bps</units><description>Bytes sent per second on all network interfaces since this process started.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_host_net_send_bytes</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>network</value></tag></tags></item><item><uuid>717ef9bbc00c46a09b28811910c4163a</uuid><name>CockroachDB: Slow requests: DistSender RPCs</name><type>DEPENDENT</type><key>cockroachdb.slow_requests.rpc</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of RPCs stuck or retrying for a long time.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>requests_slow_distsender</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>requests</value></tag></tags></item><item><uuid>dafcd171e5eb4a56ac6537cb4ae15071</uuid><name>CockroachDB: SQL: Bytes received, rate</name><type>DEPENDENT</type><key>cockroachdb.sql.bytes.received.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>Bps</units><description>Total amount of incoming SQL client network traffic in bytes per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_bytesin</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>2795f530365d4f80866926f49a3841df</uuid><name>CockroachDB: SQL: Bytes sent, rate</name><type>DEPENDENT</type><key>cockroachdb.sql.bytes.sent.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>Bps</units><description>Total amount of outgoing SQL client network traffic in bytes per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_bytesout</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>655018f6a2b7480a883c08ffd8c3c5e7</uuid><name>CockroachDB: SQL: Schema changes, rate</name><type>DEPENDENT</type><key>cockroachdb.sql.schema_changes.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Total number of SQL DDL statements successfully executed per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_ddl_count</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>79ed7dc3660a44cc8f30822e992154b6</uuid><name>CockroachDB: SQL sessions: Open</name><type>DEPENDENT</type><key>cockroachdb.sql.sessions</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Total number of open SQL sessions.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_conns</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>d4164a9763b34976ba8f89a49e9aaf25</uuid><name>CockroachDB: SQL statements: Active</name><type>DEPENDENT</type><key>cockroachdb.sql.statements.active</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Total number of SQL statements currently active.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_distsql_queries_active</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>bcae7af870ed48dc919be3dbd63df1ba</uuid><name>CockroachDB: SQL statements: Contention, rate</name><type>DEPENDENT</type><key>cockroachdb.sql.statements.contention.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Total number of SQL statements that experienced contention per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_distsql_contended_queries_count</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>80b08a576e334963a17e37a5c2305214</uuid><name>CockroachDB: SQL statements: DELETE, rate</name><type>DEPENDENT</type><key>cockroachdb.sql.statements.delete.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>A moving average of the number of DELETE statements successfully executed per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_delete_count</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>68532afbcda644f1928203c013335f2a</uuid><name>CockroachDB: SQL statements: Denials, rate</name><type>DEPENDENT</type><key>cockroachdb.sql.statements.denials.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The number of statements denied per second by a feature flag.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_feature_flag_denial</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>dc93958dabdc439f8a7ad9c5a12fddcd</uuid><name>CockroachDB: SQL statements: Errors, rate</name><type>DEPENDENT</type><key>cockroachdb.sql.statements.errors.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Total number of statements which returned a planning or runtime error per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_failure_count</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags><triggers><trigger><uuid>7307fc4f2c29438e99eea0256a8755ce</uuid><expression>min(/CockroachDB by HTTP/cockroachdb.sql.statements.errors.rate,5m) &gt; {$COCKROACHDB.STATEMENTS.ERRORS.MAX.WARN}</expression><name>CockroachDB: SQL statements errors rate is too high</name><event_name>CockroachDB: SQL statements errors rate is too high (over {$COCKROACHDB.STATEMENTS.ERRORS.MAX.WARN} per second for 5m)</event_name><priority>WARNING</priority><tags><tag><tag>scope</tag><value>health</value></tag></tags></trigger></triggers></item><item><uuid>3c9fb90492e44789ba9a899d03546b6d</uuid><name>CockroachDB: SQL statements: Executed, rate</name><type>DEPENDENT</type><key>cockroachdb.sql.statements.executed.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of SQL queries executed per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_query_count</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>ae83868ea1194089a65b9c3bfb81ef27</uuid><name>CockroachDB: SQL statements: Active flows distributed, rate</name><type>DEPENDENT</type><key>cockroachdb.sql.statements.flows.active.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The number of distributed SQL flows currently active per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_distsql_flows_active</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>b9c72429c3264119af27e3b4d1c7486a</uuid><name>CockroachDB: SQL statements: INSERT, rate</name><type>DEPENDENT</type><key>cockroachdb.sql.statements.insert.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>A moving average of the number of INSERT statements successfully executed per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_insert_count</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>d6fc464f4e784569911880f52020d08d</uuid><name>CockroachDB: SQL statements: SELECT, rate</name><type>DEPENDENT</type><key>cockroachdb.sql.statements.select.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>A moving average of the number of SELECT statements successfully executed per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_select_count</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>8832cd69551a4ad084c283fb076a17b6</uuid><name>CockroachDB: SQL statements: UPDATE, rate</name><type>DEPENDENT</type><key>cockroachdb.sql.statements.update.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>A moving average of the number of UPDATE statements successfully executed per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_update_count</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>6e2f06b2b71f447aae06940b205e22bf</uuid><name>CockroachDB: SQL transactions: Aborted, rate</name><type>DEPENDENT</type><key>cockroachdb.sql.transactions.aborted.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Total number of SQL transaction abort errors per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_txn_abort_count</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>d32b3f22158f4091926ebf9746439da3</uuid><name>CockroachDB: SQL transactions: Committed, rate</name><type>DEPENDENT</type><key>cockroachdb.sql.transactions.committed.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Total number of SQL transaction COMMIT statements successfully executed per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_txn_commit_count</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>ca529d30b36e4bf591c8b5e313f9bbc0</uuid><name>CockroachDB: SQL transactions: Initiated, rate</name><type>DEPENDENT</type><key>cockroachdb.sql.transactions.initiated.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Total number of SQL transaction BEGIN statements successfully executed per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_txn_begin_count</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>6490aac99d654eebae14cedb935c8d9f</uuid><name>CockroachDB: SQL transactions: Open</name><type>DEPENDENT</type><key>cockroachdb.sql.transactions.open</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Total number of currently open SQL transactions.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_txns_open</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>07274667c22d4e52b50ead17c864ae36</uuid><name>CockroachDB: SQL transactions: Rolled back, rate</name><type>DEPENDENT</type><key>cockroachdb.sql.transactions.rollbacks.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Total number of SQL transaction ROLLBACK statements successfully executed per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sql_txn_rollback_count</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>sql</value></tag></tags></item><item><uuid>5b96333392ac4e678204d048b4940135</uuid><name>CockroachDB: Time series: Sample errors, rate</name><type>DEPENDENT</type><key>cockroachdb.ts.samples.errors.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The number of errors encountered while attempting to write metrics to disk, per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>timeseries_write_errors</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>timeseries</value></tag></tags></item><item><uuid>444fbc4df9c64e92bd3f41022539a940</uuid><name>CockroachDB: Time series: Samples written, rate</name><type>DEPENDENT</type><key>cockroachdb.ts.samples.written.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The number of successfully written metric samples per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>timeseries_write_samples</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>timeseries</value></tag></tags></item><item><uuid>b200e1f665ad425394e631b2844a1fdb</uuid><name>CockroachDB: Uptime</name><type>DEPENDENT</type><key>cockroachdb.uptime</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>s</units><description>Process uptime.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sys_uptime</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>system</value></tag></tags><triggers><trigger><uuid>90f6cccaf3d94a3d853641482ccb5254</uuid><expression>nodata(/CockroachDB by HTTP/cockroachdb.uptime,5m) = 1</expression><name>CockroachDB: Failed to fetch node data</name><event_name>CockroachDB: Failed to fetch node data (or no data for 5m)</event_name><priority>WARNING</priority><description>Zabbix has not received data for items for the last 5 minutes.</description><dependencies><dependency><name>CockroachDB: Service is down</name><expression>last(/CockroachDB by HTTP/net.tcp.service[&quot;{$COCKROACHDB.API.SCHEME}&quot;,&quot;{HOST.CONN}&quot;,&quot;{$COCKROACHDB.API.PORT}&quot;]) = 0</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>availability</value></tag></tags></trigger><trigger><uuid>83802e38f1414ca9b40e2d2df2d94941</uuid><expression>last(/CockroachDB by HTTP/cockroachdb.uptime) &lt; 10m</expression><name>CockroachDB: Node has been restarted</name><event_name>CockroachDB: Node has been restarted (uptime &lt; 10m)</event_name><priority>INFO</priority><description>Uptime is less than 10 minutes.</description><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>d588fc919b364889abd98537dfc80575</uuid><name>CockroachDB: Version</name><type>DEPENDENT</type><key>cockroachdb.version</key><delay>0</delay><history>7d</history><trends>0</trends><value_type>CHAR</value_type><description>Build information.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>build_timestamp</parameter><parameter>label</parameter><parameter>tag</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>3h</parameter></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>system</value></tag></tags><triggers><trigger><uuid>620aee1613e841acb44a438b4b9b68c9</uuid><expression>last(/CockroachDB by HTTP/cockroachdb.version) &lt;&gt; last(/CockroachDB by HTTP/cockroachdb.version,#2) and length(last(/CockroachDB by HTTP/cockroachdb.version)) &gt; 0</expression><name>CockroachDB: Version has changed</name><event_name>CockroachDB: Version has changed (new version: {ITEM.VALUE})</event_name><priority>INFO</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>00afa7b32af9499c89e939c96e0e29d1</uuid><name>CockroachDB: Service ping</name><type>SIMPLE</type><key>net.tcp.service[&quot;{$COCKROACHDB.API.SCHEME}&quot;,&quot;{HOST.CONN}&quot;,&quot;{$COCKROACHDB.API.PORT}&quot;]</key><history>7d</history><description>Check if HTTP/HTTPS service accepts TCP connections.</description><valuemap><name>Service state</name></valuemap><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>10m</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>health</value></tag><tag><tag>component</tag><value>network</value></tag></tags><triggers><trigger><uuid>d3c0d0a9e1f44c95a2246ab7081f581b</uuid><expression>last(/CockroachDB by HTTP/net.tcp.service[&quot;{$COCKROACHDB.API.SCHEME}&quot;,&quot;{HOST.CONN}&quot;,&quot;{$COCKROACHDB.API.PORT}&quot;]) = 0</expression><name>CockroachDB: Service is down</name><priority>AVERAGE</priority><tags><tag><tag>scope</tag><value>availability</value></tag></tags></trigger></triggers></item></items><discovery_rules><discovery_rule><uuid>c201ddd6c35c4d67a05b9a99952f54f2</uuid><name>Storage metrics discovery</name><type>DEPENDENT</type><key>cockroachdb.store.discovery</key><delay>0</delay><description>Discover per store metrics.</description><item_prototypes><item_prototype><uuid>a12e4937d2c44eacada535774e74653a</uuid><name>CockroachDB: Storage [{#STORE}]: Queue processing failures: Consistency, rate</name><type>DEPENDENT</type><key>cockroachdb.queue.processing_failures.consistency.[{#STORE},rate]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of replicas which failed processing in the consistency checker queue per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>queue_consistency_process_failure{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>queues</value></tag></tags></item_prototype><item_prototype><uuid>5d328a66855d4cbba099713befd4d240</uuid><name>CockroachDB: Storage [{#STORE}]: Queue processing failures: GC, rate</name><type>DEPENDENT</type><key>cockroachdb.queue.processing_failures.gc.[{#STORE},rate]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of replicas which failed processing in the GC queue per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>queue_gc_process_failure{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>queues</value></tag></tags></item_prototype><item_prototype><uuid>b71cc221443b42888d64dea02e75d3f9</uuid><name>CockroachDB: Storage [{#STORE}]: Queue processing failures: Replica GC, rate</name><type>DEPENDENT</type><key>cockroachdb.queue.processing_failures.gc_replica.[{#STORE},rate]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of replicas which failed processing in the replica GC queue per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>queue_replicagc_process_failure{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>queues</value></tag></tags></item_prototype><item_prototype><uuid>eabbf198e158428aaf9b15f491dd0895</uuid><name>CockroachDB: Storage [{#STORE}]: Queue processing failures: Raft log, rate</name><type>DEPENDENT</type><key>cockroachdb.queue.processing_failures.raftlog.[{#STORE},rate]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of replicas which failed processing in the Raft log queue per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>queue_raftlog_process_failure{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>queues</value></tag></tags></item_prototype><item_prototype><uuid>2369ad2e98c84d2a83b64f3b1fce826e</uuid><name>CockroachDB: Storage [{#STORE}]: Queue processing failures: Raft snapshot, rate</name><type>DEPENDENT</type><key>cockroachdb.queue.processing_failures.raftsnapshot.[{#STORE},rate]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of replicas which failed processing in the Raft repair queue per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>queue_raftsnapshot_process_failure{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>queues</value></tag></tags></item_prototype><item_prototype><uuid>604df422fb084fba8480758e30fc81f3</uuid><name>CockroachDB: Storage [{#STORE}]: Queue processing failures: Replicate, rate</name><type>DEPENDENT</type><key>cockroachdb.queue.processing_failures.replicate.[{#STORE},rate]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of replicas which failed processing in the replicate queue per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>queue_replicate_process_failure{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>queues</value></tag></tags></item_prototype><item_prototype><uuid>40e94d8e2cc54c7b9c0a6c4d7c8dc308</uuid><name>CockroachDB: Storage [{#STORE}]: Queue processing failures: Split, rate</name><type>DEPENDENT</type><key>cockroachdb.queue.processing_failures.split.[{#STORE},rate]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of replicas which failed processing in the split queue per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>queue_split_process_failure{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>queues</value></tag></tags></item_prototype><item_prototype><uuid>ceb47605bc364044993e59430f37a07c</uuid><name>CockroachDB: Storage [{#STORE}]: Queue processing failures: Time series maintenance, rate</name><type>DEPENDENT</type><key>cockroachdb.queue.processing_failures.tsmaintenance.[{#STORE},rate]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of replicas which failed processing in the time series maintenance queue per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>queue_tsmaintenance_process_failure{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>queues</value></tag></tags></item_prototype><item_prototype><uuid>4ed616f13c9d4669879aa8bdad35a06a</uuid><name>CockroachDB: Storage [{#STORE}]: Ranges count</name><type>DEPENDENT</type><key>cockroachdb.ranges.[{#STORE},count]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of ranges.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>ranges{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>ranges</value></tag></tags></item_prototype><item_prototype><uuid>63e70400900a4b5caa8e89a18c83ebd7</uuid><name>CockroachDB: Storage [{#STORE}]: Ranges unavailable</name><type>DEPENDENT</type><key>cockroachdb.ranges.[{#STORE},unavailable]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of ranges with fewer live replicas than needed for quorum.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>ranges_unavailable{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>ranges</value></tag></tags></item_prototype><item_prototype><uuid>beea6adf48df454fa6628d44455ca52f</uuid><name>CockroachDB: Storage [{#STORE}]: Ranges underreplicated</name><type>DEPENDENT</type><key>cockroachdb.ranges.[{#STORE},underreplicated]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of ranges with fewer live replicas than the replication target.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>ranges_underreplicated{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>ranges</value></tag></tags></item_prototype><item_prototype><uuid>d0b45b5a00d64c39bce2117fdb35d373</uuid><name>CockroachDB: Storage [{#STORE}]: Rebalancing: Average queries, rate</name><type>DEPENDENT</type><key>cockroachdb.rebalancing.queries.average.[{#STORE},rate]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of kv-level requests received per second by the store, averaged over a large time period as used in rebalancing decisions.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>rebalancing_queriespersecond{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>rebalancing</value></tag></tags></item_prototype><item_prototype><uuid>b5c10de1a784458f9df54813cc10c32b</uuid><name>CockroachDB: Storage [{#STORE}]: Rebalancing: Average writes, rate</name><type>DEPENDENT</type><key>cockroachdb.rebalancing.writes.average.[{#STORE},rate]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of keys written (i.e. applied by raft) per second to the store, averaged over a large time period as used in rebalancing decisions.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>rebalancing_writespersecond{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>rebalancing</value></tag></tags></item_prototype><item_prototype><uuid>191985a08c554160bc371f5fca638336</uuid><name>CockroachDB: Storage [{#STORE}]: Replication: Replicas</name><type>DEPENDENT</type><key>cockroachdb.replication.replicas.[{#STORE},count]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of replicas.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>replicas{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>replication</value></tag></tags></item_prototype><item_prototype><uuid>089c354ee1c547808bbf8655d16d1a06</uuid><name>CockroachDB: Storage [{#STORE}]: Replication: Replicas quiesced</name><type>DEPENDENT</type><key>cockroachdb.replication.replicas.[{#STORE},quiesced]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of quiesced replicas.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>replicas_quiescent{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>replication</value></tag></tags></item_prototype><item_prototype><uuid>87f949f768b54ba1b648a04d86f4c4da</uuid><name>CockroachDB: Storage [{#STORE}]: Replication: Lease holders</name><type>DEPENDENT</type><key>cockroachdb.replication.[{#STORE},lease_holders]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of lease holders.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>replicas_leaseholders{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>replication</value></tag></tags></item_prototype><item_prototype><uuid>eb6202583eb24ac28b60a8d5f24c1ccf</uuid><name>CockroachDB: Storage [{#STORE}]: RocksDB cache hits, rate</name><type>DEPENDENT</type><key>cockroachdb.rocksdb.cache.hits.[{#STORE},rate]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Count of block cache hits per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>rocksdb_block_cache_hits{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>rocksdb</value></tag></tags></item_prototype><item_prototype><uuid>278d4cbcaa844f1281dd029da54300e4</uuid><name>CockroachDB: Storage [{#STORE}]: RocksDB cache misses, rate</name><type>DEPENDENT</type><key>cockroachdb.rocksdb.cache.misses.[{#STORE},rate]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Count of block cache misses per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>rocksdb_block_cache_misses{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>rocksdb</value></tag></tags></item_prototype><item_prototype><uuid>cafdf6248d114787b2a3f9647a4afea9</uuid><name>CockroachDB: Storage [{#STORE}]: RocksDB cache hit ratio</name><type>CALCULATED</type><key>cockroachdb.rocksdb.cache.[{#STORE},hit_ratio]</key><history>7d</history><value_type>FLOAT</value_type><units>%</units><params>last(//cockroachdb.rocksdb.cache.hits.[{#STORE},rate]) / (last(//cockroachdb.rocksdb.cache.hits.[{#STORE},rate]) + last(//cockroachdb.rocksdb.cache.misses.[{#STORE},rate])) * 100</params><description>Block cache hit ratio in %.</description><tags><tag><tag>component</tag><value>rocksdb</value></tag></tags></item_prototype><item_prototype><uuid>f4175e8984d14ad89c0bd1fce5b37372</uuid><name>CockroachDB: Storage [{#STORE}]: RocksDB read amplification</name><type>DEPENDENT</type><key>cockroachdb.rocksdb.[{#STORE},read_amp]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The average number of real read operations executed per logical read operation.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>rocksdb_read_amplification{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>rocksdb</value></tag></tags></item_prototype><item_prototype><uuid>edc1e5548d9e4d629b44b067ffc666b9</uuid><name>CockroachDB: Storage [{#STORE}]: RocksDB SSTables</name><type>DEPENDENT</type><key>cockroachdb.rocksdb.[{#STORE},sstables]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The number of SSTables in use.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>rocksdb_num_sstables{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>rocksdb</value></tag></tags></item_prototype><item_prototype><uuid>6e826e48da5844468ba8d14ae0f1acc4</uuid><name>CockroachDB: Storage [{#STORE}]: Slow requests: Latch acquisitions</name><type>DEPENDENT</type><key>cockroachdb.slow_requests.[{#STORE},latch_acquisitions]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of requests that have been stuck for a long time acquiring latches.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>requests_slow_latch{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>requests</value></tag></tags></item_prototype><item_prototype><uuid>0cc9c428567a47c6adb41d137965a362</uuid><name>CockroachDB: Storage [{#STORE}]: Slow requests: Lease acquisitions</name><type>DEPENDENT</type><key>cockroachdb.slow_requests.[{#STORE},lease_acquisitions]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of requests that have been stuck for a long time acquiring a lease.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>requests_slow_lease{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>requests</value></tag></tags></item_prototype><item_prototype><uuid>11c9e0dea4ec48a69ff3961aa6d1f910</uuid><name>CockroachDB: Storage [{#STORE}]: Slow requests: Raft proposals</name><type>DEPENDENT</type><key>cockroachdb.slow_requests.[{#STORE},raft_proposals]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of requests that have been stuck for a long time in raft.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>requests_slow_raft{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>requests</value></tag></tags></item_prototype><item_prototype><uuid>bbf0f281f3aa4964829ed2213db5dfc7</uuid><name>CockroachDB: Storage [{#STORE}]: Bytes: Live</name><type>DEPENDENT</type><key>cockroachdb.storage.bytes.[{#STORE},live]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>B</units><description>Number of logical bytes stored in live key-value pairs on this node. Live data excludes historical and deleted data.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>livebytes{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>storage</value></tag></tags></item_prototype><item_prototype><uuid>232970f8bf12412e8a6bd96978a7ad5f</uuid><name>CockroachDB: Storage [{#STORE}]: Bytes: Logical</name><type>DEPENDENT</type><key>cockroachdb.storage.bytes.[{#STORE},logical]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>B</units><description>Number of logical bytes stored in key-value pairs on this node. This includes historical and deleted data.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>totalbytes{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>storage</value></tag></tags></item_prototype><item_prototype><uuid>58d6f4d3c9ff41cab05697e7c59cf8e2</uuid><name>CockroachDB: Storage [{#STORE}]: Bytes: System</name><type>DEPENDENT</type><key>cockroachdb.storage.bytes.[{#STORE},system]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>B</units><description>Number of physical bytes stored in system key-value pairs.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>sysbytes{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>storage</value></tag></tags></item_prototype><item_prototype><uuid>01c02c5a9c174cd2b958634da07824e5</uuid><name>CockroachDB: Storage [{#STORE}]: Capacity available</name><type>DEPENDENT</type><key>cockroachdb.storage.capacity.[{#STORE},available]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>B</units><description>Available storage capacity.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>capacity_available{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>storage</value></tag></tags></item_prototype><item_prototype><uuid>bb07359b779d4e4080593a02c18dc8c1</uuid><name>CockroachDB: Storage [{#STORE}]: Capacity available in %</name><type>CALCULATED</type><key>cockroachdb.storage.capacity.[{#STORE},available_percent]</key><history>7d</history><value_type>FLOAT</value_type><units>%</units><params>last(//cockroachdb.storage.capacity.[{#STORE},available]) / last(//cockroachdb.storage.capacity.[{#STORE},total]) * 100</params><description>Available storage capacity in %.</description><tags><tag><tag>component</tag><value>storage</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>db07663014aa47a892faa2f9dbd97ec9</uuid><expression>max(/CockroachDB by HTTP/cockroachdb.storage.capacity.[{#STORE},available_percent],5m) &lt; {$COCKROACHDB.STORE.USED.MIN.CRIT}</expression><recovery_mode>RECOVERY_EXPRESSION</recovery_mode><recovery_expression>min(/CockroachDB by HTTP/cockroachdb.storage.capacity.[{#STORE},available_percent],5m) &gt; {$COCKROACHDB.STORE.USED.MIN.CRIT}</recovery_expression><name>CockroachDB: Storage [{#STORE}]: Available storage capacity is critically low</name><event_name>CockroachDB: Storage [{#STORE}]: Available storage capacity is critically low (less than {$COCKROACHDB.STORE.USED.MIN.CRIT}%)</event_name><priority>AVERAGE</priority><description>Storage is running critically low on free space (less than {$COCKROACHDB.STORE.USED.MIN.CRIT}% available).</description><tags><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger_prototype><trigger_prototype><uuid>a58b694f4cf642228ec0633f0efb04a7</uuid><expression>max(/CockroachDB by HTTP/cockroachdb.storage.capacity.[{#STORE},available_percent],5m) &lt; {$COCKROACHDB.STORE.USED.MIN.WARN}</expression><recovery_mode>RECOVERY_EXPRESSION</recovery_mode><recovery_expression>min(/CockroachDB by HTTP/cockroachdb.storage.capacity.[{#STORE},available_percent],5m) &gt; {$COCKROACHDB.STORE.USED.MIN.WARN}</recovery_expression><name>CockroachDB: Storage [{#STORE}]: Available storage capacity is low</name><event_name>CockroachDB: Storage [{#STORE}]: Available storage capacity is low (less than {$COCKROACHDB.STORE.USED.MIN.WARN}%)</event_name><priority>WARNING</priority><description>Storage is running low on free space (less than {$COCKROACHDB.STORE.USED.MIN.WARN}% available).</description><dependencies><dependency><name>CockroachDB: Storage [{#STORE}]: Available storage capacity is critically low</name><expression>max(/CockroachDB by HTTP/cockroachdb.storage.capacity.[{#STORE},available_percent],5m) &lt; {$COCKROACHDB.STORE.USED.MIN.CRIT}</expression><recovery_expression>min(/CockroachDB by HTTP/cockroachdb.storage.capacity.[{#STORE},available_percent],5m) &gt; {$COCKROACHDB.STORE.USED.MIN.CRIT}</recovery_expression></dependency></dependencies><tags><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><uuid>35ce626304fb4d39bd382161cb052346</uuid><name>CockroachDB: Storage [{#STORE}]: Capacity total</name><type>DEPENDENT</type><key>cockroachdb.storage.capacity.[{#STORE},total]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>B</units><description>Total storage capacity. This value may be explicitly set using --store. If a store size has not been set, this metric displays the actual disk capacity.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>capacity{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>3h</parameter></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>storage</value></tag></tags></item_prototype><item_prototype><uuid>b6db680d16bc41408d13f7275c603fca</uuid><name>CockroachDB: Storage [{#STORE}]: Capacity used</name><type>DEPENDENT</type><key>cockroachdb.storage.capacity.[{#STORE},used]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>B</units><description>Disk space in use by CockroachDB data on this node. This excludes the Cockroach binary, operating system, and other system files.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>capacity_used{store=&quot;{#STORE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters></step></preprocessing><master_item><key>cockroachdb.get_metrics</key></master_item><tags><tag><tag>component</tag><value>storage</value></tag></tags></item_prototype></item_prototypes><graph_prototypes><graph_prototype><uuid>4cd837e243f14174a6d259b359e4f90d</uuid><name>CockroachDB: Storage [{#STORE}]: Bytes</name><graph_items><graph_item><color>1A7C11</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.storage.bytes.[{#STORE},live]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.storage.bytes.[{#STORE},system]</key></item></graph_item></graph_items></graph_prototype><graph_prototype><uuid>f5054466f5834071ad9e3bd50764ba29</uuid><name>CockroachDB: Storage [{#STORE}]: Capacity</name><graph_items><graph_item><color>1A7C11</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.storage.capacity.[{#STORE},total]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.storage.capacity.[{#STORE},available]</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.storage.capacity.[{#STORE},used]</key></item></graph_item></graph_items></graph_prototype><graph_prototype><uuid>e6763dafd3c54e0787eae612921e35f8</uuid><name>CockroachDB: Storage [{#STORE}]: Queue processing failures</name><graph_items><graph_item><color>1A7C11</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.queue.processing_failures.consistency.[{#STORE},rate]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.queue.processing_failures.gc.[{#STORE},rate]</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.queue.processing_failures.raftlog.[{#STORE},rate]</key></item></graph_item><graph_item><sortorder>3</sortorder><color>A54F10</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.queue.processing_failures.raftsnapshot.[{#STORE},rate]</key></item></graph_item><graph_item><sortorder>4</sortorder><color>FC6EA3</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.queue.processing_failures.gc_replica.[{#STORE},rate]</key></item></graph_item><graph_item><sortorder>5</sortorder><color>6C59DC</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.queue.processing_failures.replicate.[{#STORE},rate]</key></item></graph_item><graph_item><sortorder>6</sortorder><color>AC8C14</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.queue.processing_failures.split.[{#STORE},rate]</key></item></graph_item><graph_item><sortorder>7</sortorder><color>611F27</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.queue.processing_failures.tsmaintenance.[{#STORE},rate]</key></item></graph_item></graph_items></graph_prototype><graph_prototype><uuid>0c4977666e5e4af1b5e1f840284fe7d0</uuid><name>CockroachDB: Storage [{#STORE}]: Ranges</name><graph_items><graph_item><color>1A7C11</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.ranges.[{#STORE},count]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.replication.[{#STORE},lease_holders]</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.ranges.[{#STORE},unavailable]</key></item></graph_item><graph_item><sortorder>3</sortorder><color>A54F10</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.ranges.[{#STORE},underreplicated]</key></item></graph_item></graph_items></graph_prototype><graph_prototype><uuid>811d38ab09494628ae6ac36aa54c1795</uuid><name>CockroachDB: Storage [{#STORE}]: Replica quiescence</name><graph_items><graph_item><color>1A7C11</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.replication.replicas.[{#STORE},count]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.replication.replicas.[{#STORE},quiesced]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes><master_item><key>cockroachdb.get_metrics</key></master_item><lld_macro_paths><lld_macro_path><lld_macro>{#STORE}</lld_macro><path>$.labels.store</path></lld_macro_path></lld_macro_paths><preprocessing><step><type>PROMETHEUS_TO_JSON</type><parameters><parameter>capacity</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>3h</parameter></parameters></step></preprocessing></discovery_rule></discovery_rules><tags><tag><tag>class</tag><value>database</value></tag><tag><tag>target</tag><value>cockroachdb</value></tag></tags><macros><macro><macro>{$COCKROACHDB.API.PORT}</macro><value>8080</value><description>The port of CockroachDB API and Prometheus endpoint.</description></macro><macro><macro>{$COCKROACHDB.API.SCHEME}</macro><value>http</value><description>Request scheme which may be http or https.</description></macro><macro><macro>{$COCKROACHDB.CERT.CA.EXPIRY.WARN}</macro><value>90</value><description>Number of days until the CA certificate expires.</description></macro><macro><macro>{$COCKROACHDB.CERT.NODE.EXPIRY.WARN}</macro><value>30</value><description>Number of days until the node certificate expires.</description></macro><macro><macro>{$COCKROACHDB.CLOCK.OFFSET.MAX.WARN}</macro><value>300</value><description>Maximum clock offset of the node against the rest of the cluster in milliseconds for trigger expression.</description></macro><macro><macro>{$COCKROACHDB.OPEN.FDS.MAX.WARN}</macro><value>80</value><description>Maximum percentage of used file descriptors.</description></macro><macro><macro>{$COCKROACHDB.STATEMENTS.ERRORS.MAX.WARN}</macro><value>2</value><description>Maximum number of SQL statements errors for trigger expression.</description></macro><macro><macro>{$COCKROACHDB.STORE.USED.MIN.CRIT}</macro><value>10</value><description>The critical threshold of the available disk space in percent.</description></macro><macro><macro>{$COCKROACHDB.STORE.USED.MIN.WARN}</macro><value>20</value><description>The warning threshold of the available disk space in percent.</description></macro></macros><dashboards><dashboard><uuid>fda49a1847d34b84be2fe5d9d12b8444</uuid><name>Hardware</name><pages><page><widgets><widget><type>GRAPH_CLASSIC</type><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>1</value></field><field><type>ITEM</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.cpu.util</key></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>5</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>0</value></field><field><type>GRAPH</type><name>graphid</name><value><host>CockroachDB by HTTP</host><name>CockroachDB: Memory usage</name></value></field></fields></widget><widget><type>GRAPH_PROTOTYPE</type><y>10</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>2</value></field><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>GRAPH_PROTOTYPE</type><name>graphid</name><value><host>CockroachDB by HTTP</host><name>CockroachDB: Storage [{#STORE}]: Capacity</name></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>15</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>0</value></field><field><type>GRAPH</type><name>graphid</name><value><host>CockroachDB by HTTP</host><name>CockroachDB: Disk: r/w, rate</name></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>20</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>0</value></field><field><type>GRAPH</type><name>graphid</name><value><host>CockroachDB by HTTP</host><name>CockroachDB: Disk: r/w IOPS, rate</name></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>25</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>1</value></field><field><type>ITEM</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.disk.iops.in_progress.rate</key></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>30</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>0</value></field><field><type>GRAPH</type><name>graphid</name><value><host>CockroachDB by HTTP</host><name>CockroachDB: Network traffic</name></value></field></fields></widget></widgets></page></pages></dashboard><dashboard><uuid>41dce007bcf54762ad321ac944a8b63e</uuid><name>Replication</name><pages><page><widgets><widget><type>GRAPH_PROTOTYPE</type><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>2</value></field><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>GRAPH_PROTOTYPE</type><name>graphid</name><value><host>CockroachDB by HTTP</host><name>CockroachDB: Storage [{#STORE}]: Ranges</name></value></field></fields></widget><widget><type>GRAPH_PROTOTYPE</type><y>5</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>INTEGER</type><name>source_type</name><value>3</value></field><field><type>ITEM_PROTOTYPE</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.replication.[{#STORE},lease_holders]</key></value></field></fields></widget><widget><type>GRAPH_PROTOTYPE</type><y>10</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>INTEGER</type><name>source_type</name><value>3</value></field><field><type>ITEM_PROTOTYPE</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.rebalancing.queries.average.[{#STORE},rate]</key></value></field></fields></widget><widget><type>GRAPH_PROTOTYPE</type><y>15</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>2</value></field><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>GRAPH_PROTOTYPE</type><name>graphid</name><value><host>CockroachDB by HTTP</host><name>CockroachDB: Storage [{#STORE}]: Replica quiescence</name></value></field></fields></widget></widgets></page></pages></dashboard><dashboard><uuid>0d9a3feb76ad403dac7379dbe04298f0</uuid><name>Runtime</name><pages><page><widgets><widget><type>GRAPH_CLASSIC</type><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>1</value></field><field><type>ITEM</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.live_count</key></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>5</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>0</value></field><field><type>GRAPH</type><name>graphid</name><value><host>CockroachDB by HTTP</host><name>CockroachDB: Memory usage</name></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>10</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>1</value></field><field><type>ITEM</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.go.goroutines.count</key></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>15</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>1</value></field><field><type>ITEM</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.gc.runs.rate</key></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>20</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>1</value></field><field><type>ITEM</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.gc.pause_time</key></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>25</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>0</value></field><field><type>GRAPH</type><name>graphid</name><value><host>CockroachDB by HTTP</host><name>CockroachDB: CPU Time</name></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>30</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>1</value></field><field><type>ITEM</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.clock.offset</key></value></field></fields></widget></widgets></page></pages></dashboard><dashboard><uuid>ac89b176f2c34fc1b885ee1ed43df590</uuid><name>Slow requests</name><pages><page><widgets><widget><type>GRAPH_PROTOTYPE</type><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>INTEGER</type><name>source_type</name><value>3</value></field><field><type>ITEM_PROTOTYPE</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.slow_requests.[{#STORE},raft_proposals]</key></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>5</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>1</value></field><field><type>ITEM</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.slow_requests.rpc</key></value></field></fields></widget><widget><type>GRAPH_PROTOTYPE</type><y>10</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>INTEGER</type><name>source_type</name><value>3</value></field><field><type>ITEM_PROTOTYPE</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.slow_requests.[{#STORE},lease_acquisitions]</key></value></field></fields></widget><widget><type>GRAPH_PROTOTYPE</type><y>15</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>INTEGER</type><name>source_type</name><value>3</value></field><field><type>ITEM_PROTOTYPE</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.slow_requests.[{#STORE},latch_acquisitions]</key></value></field></fields></widget></widgets></page></pages></dashboard><dashboard><uuid>b1086a92f1b54c45be99efd996b33457</uuid><name>SQL</name><pages><page><widgets><widget><type>GRAPH_CLASSIC</type><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>1</value></field><field><type>ITEM</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.sql.sessions</key></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><x>12</x><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>1</value></field><field><type>ITEM</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.sql.transactions.open</key></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>5</y><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>1</value></field><field><type>ITEM</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.sql.statements.active</key></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><x>12</x><y>5</y><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>0</value></field><field><type>GRAPH</type><name>graphid</name><value><host>CockroachDB by HTTP</host><name>CockroachDB: SQL: Traffic</name></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>10</y><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>0</value></field><field><type>GRAPH</type><name>graphid</name><value><host>CockroachDB by HTTP</host><name>CockroachDB: SQL statements</name></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><x>12</x><y>10</y><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>1</value></field><field><type>ITEM</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.sql.statements.errors.rate</key></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>15</y><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>1</value></field><field><type>ITEM</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.sql.statements.contention.rate</key></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><x>12</x><y>15</y><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>1</value></field><field><type>ITEM</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.sql.statements.flows.active.rate</key></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>20</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>0</value></field><field><type>GRAPH</type><name>graphid</name><value><host>CockroachDB by HTTP</host><name>CockroachDB: SQL transactions</name></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>25</y><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>1</value></field><field><type>ITEM</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.memory.sql</key></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><x>12</x><y>25</y><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>1</value></field><field><type>ITEM</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.sql.schema_changes.rate</key></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>30</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>1</value></field><field><type>ITEM</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.sql.statements.denials.rate</key></value></field></fields></widget></widgets></page></pages></dashboard><dashboard><uuid>aa41ca45023c4d0eb126596f89f20f98</uuid><name>Storage</name><pages><page><widgets><widget><type>GRAPH_PROTOTYPE</type><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>2</value></field><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>GRAPH_PROTOTYPE</type><name>graphid</name><value><host>CockroachDB by HTTP</host><name>CockroachDB: Storage [{#STORE}]: Capacity</name></value></field></fields></widget><widget><type>GRAPH_PROTOTYPE</type><x>12</x><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>2</value></field><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>GRAPH_PROTOTYPE</type><name>graphid</name><value><host>CockroachDB by HTTP</host><name>CockroachDB: Storage [{#STORE}]: Bytes</name></value></field></fields></widget><widget><type>GRAPH_PROTOTYPE</type><y>5</y><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>INTEGER</type><name>source_type</name><value>3</value></field><field><type>ITEM_PROTOTYPE</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.rocksdb.[{#STORE},read_amp]</key></value></field></fields></widget><widget><type>GRAPH_PROTOTYPE</type><x>12</x><y>5</y><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>INTEGER</type><name>source_type</name><value>3</value></field><field><type>ITEM_PROTOTYPE</type><name>itemid</name><value><host>CockroachDB by HTTP</host><key>cockroachdb.rocksdb.[{#STORE},sstables]</key></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>10</y><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>0</value></field><field><type>GRAPH</type><name>graphid</name><value><host>CockroachDB by HTTP</host><name>CockroachDB: File descriptors</name></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><x>12</x><y>10</y><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>0</value></field><field><type>GRAPH</type><name>graphid</name><value><host>CockroachDB by HTTP</host><name>CockroachDB: Time series</name></value></field></fields></widget></widgets></page></pages></dashboard></dashboards><valuemaps><valuemap><uuid>2e7ddaadebce4b1089dcf01a91d01293</uuid><name>Node health</name><mappings><mapping><value>200</value><newvalue>Healthy</newvalue></mapping><mapping><value>500</value><newvalue>Not healthy</newvalue></mapping></mappings></valuemap><valuemap><uuid>705e364c9e1b44dbb3fb50a1b27a8cdb</uuid><name>Node readiness</name><mappings><mapping><value>200</value><newvalue>Ready</newvalue></mapping><mapping><value>503</value><newvalue>Not ready</newvalue></mapping></mappings></valuemap><valuemap><uuid>cc5f50f62d4a4895aa64d167f56cb99c</uuid><name>Service state</name><mappings><mapping><value>0</value><newvalue>Down</newvalue></mapping><mapping><value>1</value><newvalue>Up</newvalue></mapping></mappings></valuemap></valuemaps></template></templates><triggers><trigger><uuid>8c2035ad44ea44b2b690b086d11e8cfc</uuid><expression>min(/CockroachDB by HTTP/cockroachdb.descriptors.open,10m) / last(/CockroachDB by HTTP/cockroachdb.descriptors.limit) * 100 &gt; {$COCKROACHDB.OPEN.FDS.MAX.WARN}</expression><name>CockroachDB: Current number of open files is too high</name><event_name>CockroachDB: Current number of open files is too high (over {$COCKROACHDB.OPEN.FDS.MAX.WARN}% for 10m)</event_name><priority>WARNING</priority><description>Getting close to open file descriptor limit.</description></trigger><trigger><uuid>b099e323ec974823bfd84317b152a1fb</uuid><expression>last(/CockroachDB by HTTP/cockroachdb.sql.sessions) &gt; 0 and last(/CockroachDB by HTTP/cockroachdb.sql.statements.executed.rate) = 0</expression><name>CockroachDB: Node is not executing SQL</name><priority>WARNING</priority><description>Node is not executing SQL despite having connections.</description><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>0d2fa3b6ea434a07867b9f4d6156ea81</uuid><expression>last(/CockroachDB by HTTP/cockroachdb.get_readiness) = 503 and last(/CockroachDB by HTTP/cockroachdb.uptime) &gt; 5m</expression><name>CockroachDB: Node is not ready</name><priority>AVERAGE</priority><description>Node's /health?ready=1 endpoint has returned HTTP 503 Service Unavailable. Possible reasons:
- node is in the wait phase of the node shutdown sequence;
- node is unable to communicate with a majority of the other nodes in the cluster, likely because the cluster is unavailable due to too many nodes being down.</description><dependencies><dependency><name>CockroachDB: Service is down</name><expression>last(/CockroachDB by HTTP/net.tcp.service[&quot;{$COCKROACHDB.API.SCHEME}&quot;,&quot;{HOST.CONN}&quot;,&quot;{$COCKROACHDB.API.PORT}&quot;]) = 0</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>health</value></tag></tags></trigger></triggers><graphs><graph><uuid>4706e010045343cfa5a6d211ec6c0efd</uuid><name>CockroachDB: CPU Time</name><graph_items><graph_item><color>1A7C11</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.cpu.user_time</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.cpu.system_time</key></item></graph_item></graph_items></graph><graph><uuid>5d194c6e35c64bfd88a801668bc5ac49</uuid><name>CockroachDB: Disk: r/w, rate</name><graph_items><graph_item><color>1A7C11</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.disk.read.rate</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.disk.write.rate</key></item></graph_item></graph_items></graph><graph><uuid>7808c1bcbf8b4672b5d8a7c26ec97745</uuid><name>CockroachDB: Disk: r/w IOPS, rate</name><graph_items><graph_item><color>1A7C11</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.disk.iops.read.rate</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.disk.iops.write.rate</key></item></graph_item></graph_items></graph><graph><uuid>1206fc26b6c342b9a85b4a9ea4b1f8b5</uuid><name>CockroachDB: File descriptors</name><graph_items><graph_item><color>1A7C11</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.descriptors.limit</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.descriptors.open</key></item></graph_item></graph_items></graph><graph><uuid>919586b301534623b16d5aadef0de5a6</uuid><name>CockroachDB: KV transactions</name><graph_items><graph_item><color>1A7C11</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.kv.transactions.committed.rate</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.kv.transactions.aborted.rate</key></item></graph_item></graph_items></graph><graph><uuid>0bc7a266933e407c85e903cfb6b2b7c9</uuid><name>CockroachDB: Memory usage</name><graph_items><graph_item><color>1A7C11</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.memory.total</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.memory.go.allocated</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.memory.go.managed</key></item></graph_item><graph_item><sortorder>3</sortorder><color>A54F10</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.memory.cgo.allocated</key></item></graph_item><graph_item><sortorder>4</sortorder><color>FC6EA3</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.memory.cgo.managed</key></item></graph_item></graph_items></graph><graph><uuid>4f02255476334f79a9373c1966a1b787</uuid><name>CockroachDB: Network traffic</name><graph_items><graph_item><color>1A7C11</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.network.bytes.received.rate</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.network.bytes.sent.rate</key></item></graph_item></graph_items></graph><graph><uuid>b6f9d3cda4a5451da3d90107960e91b7</uuid><name>CockroachDB: SQL: Traffic</name><graph_items><graph_item><color>1A7C11</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.sql.bytes.received.rate</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.sql.bytes.sent.rate</key></item></graph_item></graph_items></graph><graph><uuid>76bfd0743c63481db9793e3c55181bc9</uuid><name>CockroachDB: SQL statements</name><graph_items><graph_item><color>1A7C11</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.sql.statements.update.rate</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.sql.statements.select.rate</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.sql.statements.insert.rate</key></item></graph_item><graph_item><sortorder>3</sortorder><color>A54F10</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.sql.statements.delete.rate</key></item></graph_item></graph_items></graph><graph><uuid>53151cd0e61d487485f8d201c6881d59</uuid><name>CockroachDB: SQL transactions</name><graph_items><graph_item><color>1A7C11</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.sql.transactions.initiated.rate</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.sql.transactions.committed.rate</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.sql.transactions.rollbacks.rate</key></item></graph_item><graph_item><sortorder>3</sortorder><color>A54F10</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.sql.transactions.aborted.rate</key></item></graph_item></graph_items></graph><graph><uuid>0c313bd2041942649c1f1c441e812388</uuid><name>CockroachDB: Time series</name><graph_items><graph_item><color>1A7C11</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.ts.samples.written.rate</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>CockroachDB by HTTP</host><key>cockroachdb.ts.samples.errors.rate</key></item></graph_item></graph_items></graph></graphs></zabbix_export>
