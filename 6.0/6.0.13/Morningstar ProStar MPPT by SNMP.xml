<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>6.0</version><date>2023-02-11T16:14:50Z</date><groups><group><uuid>36bff6c29af64692839d077febfc7079</uuid><name>Templates/Network devices</name></group></groups><templates><template><uuid>b84324c2a40a496dbbb379bbf5dde8d5</uuid><template>Morningstar ProStar MPPT by SNMP</template><name>Morningstar ProStar MPPT by SNMP</name><description>MIBs used:
PROSTAR-MPPT

Template tooling version used: 0.41</description><groups><group><name>Templates/Network devices</name></group></groups><items><item><uuid>a517a7aafbab426eb6ced8d5f57c1fa4</uuid><name>Array: Sweep Pmax</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.64.0</snmp_oid><key>array.sweep_pmax[arrayMaxPowerSweep.0]</key><history>7d</history><value_type>FLOAT</value_type><units>W</units><description>MIB: PROSTAR-MPPT
Array Max. Power (sweep)
 Description:Array Max. Power (last sweep)
 Scaling Factor:1.0
 Units:W
 Range:[0.0, 500]
 Modbus address:0x003E</description><tags><tag><tag>component</tag><value>array</value></tag></tags></item><item><uuid>7714c76013e341f8b6753cc5a50a960f</uuid><name>Array: Sweep Vmp</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.63.0</snmp_oid><key>array.sweep_vmp[arrayVmp.0]</key><history>7d</history><value_type>FLOAT</value_type><units>V</units><description>MIB: PROSTAR-MPPT
Array Vmp
  Description:Array Max. Power Point Voltage
  Scaling Factor:1.0
  Units:V
  Range:[0.0, 5000.0]
  Modbus address:0x003D</description><tags><tag><tag>component</tag><value>array</value></tag></tags></item><item><uuid>379ab969ad784968a1090ff98f5801ff</uuid><name>Array: Sweep Voc</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.65.0</snmp_oid><key>array.sweep_voc[arrayVoc.0]</key><history>7d</history><value_type>FLOAT</value_type><units>V</units><description>MIB: PROSTAR-MPPT
Array Voc
 Description:Array Open Circuit Voltage
 Scaling Factor:1.0
 Units:V
 Range:[0.0, 80.0]
 Modbus address:0x003F</description><tags><tag><tag>component</tag><value>array</value></tag></tags></item><item><uuid>41a1118e1be3417daa79faace733d861</uuid><name>Array: Voltage</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.31.0</snmp_oid><key>array.voltage[arrayVoltage.0]</key><history>7d</history><value_type>FLOAT</value_type><units>V</units><description>MIB: PROSTAR-MPPT
Array Voltage
  Description:Array Voltage
  Scaling Factor:1.0
  Units:V
  Range:[0, 80]
  Modbus address:0x0013</description><tags><tag><tag>component</tag><value>array</value></tag></tags></item><item><uuid>fe5c3b724e894573acdaf522a2213adb</uuid><name>Battery: Battery Voltage discovery</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.30.0</snmp_oid><key>battery.voltage.discovery[batteryTerminalVoltage.0]</key><delay>15m</delay><history>0</history><value_type>FLOAT</value_type><units>V</units><description>MIB: PROSTAR-MPPT</description><tags><tag><tag>component</tag><value>battery</value></tag><tag><tag>component</tag><value>discovery</value></tag><tag><tag>component</tag><value>raw</value></tag></tags></item><item><uuid>ed1d54fce0904b7c9d0895a094f55108</uuid><name>Battery: Charge Current</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.33.0</snmp_oid><key>charge.current[chargeCurrent.0]</key><history>7d</history><value_type>FLOAT</value_type><units>A</units><description>MIB: PROSTAR-MPPT
Charge Current
  Description:Charge Current
  Scaling Factor:1.0
  Units:A
  Range:[0, 40]
  Modbus address:0x0010</description><tags><tag><tag>component</tag><value>battery</value></tag></tags></item><item><uuid>1b1b61995c0d4d89a7f9ad4e14c3541f</uuid><name>Battery: Charge State</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.45.0</snmp_oid><key>charge.state[chargeState.0]</key><history>7d</history><value_type>FLOAT</value_type><description>MIB: PROSTAR-MPPT
Charge State
  Description:Control State
  Modbus address:0x0021

  0: Start
  1: NightCheck
  2: Disconnect
  3: Night
  4: Fault
  5: BulkMppt
  6: Absorption
  7: Float
  8: Equalize
  9: Slave
  10: Fixed</description><valuemap><name>ProStar MPPT charge state</name></valuemap><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>battery</value></tag></tags><triggers><trigger><uuid>fe4863fdd4d64e1c977328bd3d0f687f</uuid><expression>last(/Morningstar ProStar MPPT by SNMP/charge.state[chargeState.0])={$CHARGE.STATE.CRIT}</expression><name>Battery: Device charge in critical state</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>4d064e4877474d72b85c9cdfb7b09dad</uuid><expression>last(/Morningstar ProStar MPPT by SNMP/charge.state[chargeState.0])={$CHARGE.STATE.WARN}</expression><name>Battery: Device charge in warning state</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><dependencies><dependency><name>Battery: Device charge in critical state</name><expression>last(/Morningstar ProStar MPPT by SNMP/charge.state[chargeState.0])={$CHARGE.STATE.CRIT}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>009eb72ff6674da49d1dd85a6f9459cf</uuid><name>Counter: Charge Amp-hours</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.49.0</snmp_oid><key>counter.charge_amp_hours[ahChargeResettable.0]</key><history>7d</history><value_type>FLOAT</value_type><units>Ah</units><description>MIB: PROSTAR-MPPT
Ah Charge (Resettable)
 Description:Ah Charge (Resettable)
 Scaling Factor:0.1
 Units:Ah
 Range:[0.0, 4294967294]
 Modbus addresses:H=0x0026 L=0x0027</description><preprocessing><step><type>MULTIPLIER</type><parameters><parameter>0.1</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>counter</value></tag></tags></item><item><uuid>4a53a2211a1249d59369ad65762ffe47</uuid><name>Counter: Charge KW-hours</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.51.0</snmp_oid><key>counter.charge_kw_hours[kwhChargeResettable.0]</key><history>7d</history><value_type>FLOAT</value_type><units>!kWh</units><description>MIB: PROSTAR-MPPT
kWh Charge (Resettable)
Description:Kilowatt Hours Charge (Resettable)
Scaling Factor:1.0
Units:kWh
Range:[0.0, 65535]
Modbus address:0x002A</description><tags><tag><tag>component</tag><value>counter</value></tag></tags></item><item><uuid>c72ef851c2d240c9835c1703cec49fd6</uuid><name>Counter: Load Amp-hours</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.56.0</snmp_oid><key>counter.load_amp_hours[ahLoadResettable.0]</key><history>7d</history><value_type>FLOAT</value_type><units>Ah</units><description>MIB: PROSTAR-MPPT
Description:Ah Load (Resettable)
Scaling Factor:0.1
Units:Ah
Range:[0.0, 4294967294]
Modbus addresses:H=0x0032 L=0x0033</description><preprocessing><step><type>MULTIPLIER</type><parameters><parameter>0.1</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>counter</value></tag></tags></item><item><uuid>29a7d76472fb4025bc78fbeab273e955</uuid><name>Load: Current</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.34.0</snmp_oid><key>load.current[loadCurrent.0]</key><history>7d</history><value_type>FLOAT</value_type><units>A</units><description>MIB: PROSTAR-MPPT
Load Current
 Description:Load Current
 Scaling Factor:1.0
 Units:A
 Range:[0, 60]
 Modbus address:0x0016</description><tags><tag><tag>component</tag><value>load</value></tag></tags></item><item><uuid>ae927b5cba5b43f5a2136fd3ee71b63d</uuid><name>Load: State</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.53.0</snmp_oid><key>load.state[loadState.0]</key><history>7d</history><value_type>FLOAT</value_type><description>MIB: PROSTAR-MPPT
Load State
 Description:Load State
 Modbus address:0x002E

 0: Start
1: Normal
2: LvdWarning
3: Lvd
4: Fault
5: Disconnect
6: NormalOff
7: Override
8: NotUsed</description><valuemap><name>ProStar MPPT load state</name></valuemap><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>load</value></tag></tags><triggers><trigger><uuid>a88025c5e5a748e3a6dfa01685ba075b</uuid><expression>last(/Morningstar ProStar MPPT by SNMP/load.state[loadState.0])={$LOAD.STATE.CRIT:&quot;lvd&quot;} or last(/Morningstar ProStar MPPT by SNMP/load.state[loadState.0])={$LOAD.STATE.CRIT:&quot;fault&quot;}</expression><name>Load: Device load in critical state</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>9ab107b39b874fed83d09e7c1964a699</uuid><expression>last(/Morningstar ProStar MPPT by SNMP/load.state[loadState.0])={$LOAD.STATE.WARN:&quot;lvdWarning&quot;}  or last(/Morningstar ProStar MPPT by SNMP/load.state[loadState.0])={$LOAD.STATE.WARN:&quot;override&quot;}</expression><name>Load: Device load in warning state</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><dependencies><dependency><name>Load: Device load in critical state</name><expression>last(/Morningstar ProStar MPPT by SNMP/load.state[loadState.0])={$LOAD.STATE.CRIT:&quot;lvd&quot;} or last(/Morningstar ProStar MPPT by SNMP/load.state[loadState.0])={$LOAD.STATE.CRIT:&quot;fault&quot;}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>47894752dd1d41f1aa882387acf6dc3a</uuid><name>Load: Voltage</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.32.0</snmp_oid><key>load.voltage[loadVoltage.0]</key><history>7d</history><value_type>FLOAT</value_type><units>V</units><description>MIB: PROSTAR-MPPT
Load Voltage
 Description:Load Voltage
 Scaling Factor:1.0
 Units:V
 Range:[0, 80]
 Modbus address:0x0014</description><tags><tag><tag>component</tag><value>load</value></tag></tags></item><item><uuid>d44cb5d7db31402dae79275a9148817d</uuid><name>Status: Alarms</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.59.0</snmp_oid><key>status.alarms[alarms.0]</key><history>1h</history><trends>0</trends><value_type>TEXT</value_type><description>MIB: PROSTAR-MPPT
Description:Alarms
Modbus addresses:H=0x0038 L=0x0039</description><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step><step><type>JAVASCRIPT</type><parameters><parameter>var FIELDS = [
  'rtsOpen',
  'rtsShorted',
  'rtsDisconnected',
  'heatsinkTempSensorOpen',
  'heatsinkTempSensorShorted',
  'heatsinkTempLimit',
  'inductorTempSensorOpen',
  'inductorTempSensorShorted',
  'inductorTempLimit',
  'currentLimit',
  'currentMeasurementError',
  'batterySenseOutOfRange',
  'batterySenseDisconnected',
  'uncalibrated',
  'tb5v',
  'fp10SupplyOutOfRange',
  'unused',
  'mosfetOpen',
  'arrayCurrentOffset',
  'loadCurrentOffset',
  'p33SupplyOutOfRange',
  'p12SupplyOutOfRange',
  'hightInputVoltageLimit',
  'controllerReset',
  'loadLvd',
  'logTimeout',
  'eepromAccessFailure'
];

var flags = parseInt(value.replace(/\x20/g, ''), 16),
  result = [];

for (var i = 0, f = 1 &lt;&lt; 31 &gt;&gt;&gt; 0, l = FIELDS.length; i &lt; l; i++, f &gt;&gt;&gt;= 1) {
    if (flags &amp; f) {
        result.push(FIELDS[i]);
    }
}

return result.length ? result.join('\n') : 'No alarms';</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>status</value></tag></tags><triggers><trigger><uuid>a2d0ab5150dd4bad8b5ec4f2c6aa13f8</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;arrayCurrentOffset&quot;)=2</expression><name>Status: Device has &quot;arrayCurrentOffset&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>cc6a15f16fd8470a9dcd9a9e01cba61c</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;batterySenseDisconnected&quot;)=2</expression><name>Status: Device has &quot;batterySenseDisconnected&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>55d4726d9b9047c79cf690353d950797</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;batterySenseOutOfRange&quot;)=2</expression><name>Status: Device has &quot;batterySenseOutOfRange&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>7f015198395042219666cde4458d407c</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;controllerReset&quot;)=2</expression><name>Status: Device has &quot;controllerReset&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>48339339e5a7465fbc67266998c9a8fe</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;currentLimit&quot;)=2</expression><name>Status: Device has &quot;currentLimit&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>c88074037099498c896bb4793e04fea3</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;currentMeasurementError&quot;)=2</expression><name>Status: Device has &quot;currentMeasurementError&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>cecd8ee17e5143ffb46495e927750c82</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;eepromAccessFailure&quot;)=2</expression><name>Status: Device has &quot;eepromAccessFailure&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>4affa15e1c1c42459ea8dd6820d1c008</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;fp10SupplyOutOfRange&quot;)=2</expression><name>Status: Device has &quot;fp10SupplyOutOfRange&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>41e4225072a3468696cfb534c65b9736</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;heatsinkTempLimit&quot;)=2</expression><name>Status: Device has &quot;heatsinkTempLimit&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>5d269997a57d44ceb545e751e8e2d919</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;heatsinkTempSensorOpen&quot;)=2</expression><name>Status: Device has &quot;heatsinkTempSensorOpen&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>a8342a4e2fff40a7b830086dec303fd9</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;heatsinkTempSensorShorted&quot;)=2</expression><name>Status: Device has &quot;heatsinkTempSensorShorted&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>32e5b7ae81ce4ebea9b05ff7ab411e5a</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;hightInputVoltageLimit&quot;)=2</expression><name>Status: Device has &quot;hightInputVoltageLimit&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>c10d27c1d9d54b8981a639e7bf0dfc02</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;inductorTempLimit&quot;)=2</expression><name>Status: Device has &quot;inductorTempLimit&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>9f80959684b34b6498a1634097cd0d22</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;inductorTempSensorOpen&quot;)=2</expression><name>Status: Device has &quot;inductorTempSensorOpen&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>cc735ddcc98e4c099bb770e2b2a171b5</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;inductorTempSensorShorted&quot;)=2</expression><name>Status: Device has &quot;inductorTempSensorShorted&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>217935cd6c7547bc95f5af51b3e643d4</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;loadCurrentOffset&quot;)=2</expression><name>Status: Device has &quot;loadCurrentOffset&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>cb05261f120240bf944b304ffc4979e6</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;loadLvd&quot;)=2</expression><name>Status: Device has &quot;loadLvd&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>1ed1de932e084ce5ba03747bdd8ca4e5</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;logTimeout&quot;)=2</expression><name>Status: Device has &quot;logTimeout&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>8824f80f1ef245508d6d0d660e3cabf1</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;mosfetOpen&quot;)=2</expression><name>Status: Device has &quot;mosfetOpen&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>59569aaebf32403c9fd310f6b26845b0</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;p12SupplyOutOfRange&quot;)=2</expression><name>Status: Device has &quot;p12SupplyOutOfRange&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>4775d3a7b843455eb404661c070be092</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;p33SupplyOutOfRange&quot;)=2</expression><name>Status: Device has &quot;p33SupplyOutOfRange&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>2015d2b876564ad79699a23fc6b60f07</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;rtsDisconnected&quot;)=2</expression><name>Status: Device has &quot;rtsDisconnected&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>cce1eb2bee094a3b9a993ec2d60d182b</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;rtsShorted&quot;)=2</expression><name>Status: Device has &quot;rtsShorted&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>7a07b757660a4c9a879ac03a94832720</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;tb5v&quot;)=2</expression><name>Status: Device has &quot;tb5v&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>39205fc6d2cd4888994cccb016b4b2f8</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;uncalibrated&quot;)=2</expression><name>Status: Device has &quot;uncalibrated&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>8fbb5c650fa040c892a1d10a17fbbf14</uuid><name>Status: Array Faults</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.46.0</snmp_oid><key>status.array_faults[arrayFaults.0]</key><history>1h</history><trends>0</trends><value_type>TEXT</value_type><description>MIB: PROSTAR-MPPT
Description:Array Faults
Modbus address:0x0022</description><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step><step><type>JAVASCRIPT</type><parameters><parameter>var FIELDS = [
  'overcurrent',
  'mosfetSShorted',
  'software',
  'batteryHvd',
  'arrayHvd',
  'customSettingsEdit',
  'rtsShorted',
  'rtsNoLongerValid',
  'localTempSensorDamaged',
  'batteryLowVoltageDisconnect',
  'slaveTimeout',
  'dipSwitchChanged',
];

var flags = parseInt(value.replace(/\x20/g, ''), 16),
  result = [];

for (var i = 0, f = 1 &lt;&lt; 31 &gt;&gt;&gt; 0, l = FIELDS.length; i &lt; l; i++, f &gt;&gt;&gt;= 1) {
    if (flags &amp; f) {
        result.push(FIELDS[i]);
    }
}

return result.length ? result.join('\n') : 'No faults';</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>status</value></tag></tags><triggers><trigger><uuid>8322f8ca8e2e462a8799dc399f17ba27</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;arrayHvd&quot;)=2</expression><name>Status: Device has &quot;arrayHvd&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>6a138cd2af754bb3a22173e8da28b254</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;batteryHvd&quot;)=2</expression><name>Status: Device has &quot;batteryHvd&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>8e42cf21ec10409da840021bfd26f74c</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;batteryLowVoltageDisconnect&quot;)=2</expression><name>Status: Device has &quot;batteryLowVoltageDisconnect&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>d1112d9828064a879d56626ac6339dbf</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;customSettingsEdit&quot;)=2</expression><name>Status: Device has &quot;customSettingsEdit&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>75a67f17a33e41eea34585fade6319ef</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;dipSwitchChanged&quot;)=2</expression><name>Status: Device has &quot;dipSwitchChanged&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>4502112383524f0499ea13e6f83ce789</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;localTempSensorDamaged&quot;)=2</expression><name>Status: Device has &quot;localTempSensorDamaged&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>f1489dc1f8574895bd233b14ce080748</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;mosfetSShorted&quot;)=2</expression><name>Status: Device has &quot;mosfetSShorted&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>4ea903d3e8644ddaa5309eaa9715b894</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;overcurrent&quot;)=2</expression><name>Status: Device has &quot;overcurrent&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>e12a29ec16ea423cb69ca4ce460f201b</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;rtsNoLongerValid&quot;)=2</expression><name>Status: Device has &quot;rtsNoLongerValid&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>3ec4307bb2c444fc8eca27f9b7a136e2</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;rtsShorted&quot;)=2</expression><name>Status: Device has &quot;rtsShorted&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>915c00d98e144ee7a9a2d50d0bd474c0</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;slaveTimeout&quot;)=2</expression><name>Status: Device has &quot;slaveTimeout&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>9aac314eef594a8d86fd4b88308428e5</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;software&quot;)=2</expression><name>Status: Device has &quot;software&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>712a9b442bec4e89acf4ee5d5bf26fb8</uuid><name>Status: Uptime (hardware)</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.2.1.25.1.1.0</snmp_oid><key>status.hw.uptime</key><history>7d</history><units>uptime</units><description>The amount of time since this host was last initialized. Note that this is different from sysUpTime in the SNMPv2-MIB [RFC1907] because sysUpTime is the uptime of the network management portion of the system.</description><preprocessing><step><type>CHECK_NOT_SUPPORTED</type><parameters><parameter/></parameters><error_handler>CUSTOM_VALUE</error_handler><error_handler_params>0</error_handler_params></step><step><type>MULTIPLIER</type><parameters><parameter>0.01</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>status</value></tag></tags></item><item><uuid>fb4d2147a8224b599ad908eca1b019e4</uuid><name>Status: Load Faults</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.54.0</snmp_oid><key>status.load_faults[loadFaults.0]</key><history>1h</history><trends>0</trends><value_type>TEXT</value_type><description>MIB: PROSTAR-MPPT
Description:Array Faults
Modbus address:0x0022</description><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step><step><type>JAVASCRIPT</type><parameters><parameter>var FIELDS = [
  'externalShortCircuit',
  'overcurrent',
  'mosfetShorted',
  'software',
  'loadHvd',
  'highTempDisconnect',
  'dipSwitchChanged',
  'customSettingsEdit'
];

var flags = parseInt(value.replace(/\x20/g, ''), 16),
  result = [];

for (var i = 0, f = 1 &lt;&lt; 31 &gt;&gt;&gt; 0, l = FIELDS.length; i &lt; l; i++, f &gt;&gt;&gt;= 1) {
    if (flags &amp; f) {
        result.push(FIELDS[i]);
    }
}

return result.length ? result.join('\n') : 'No faults';</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>status</value></tag></tags><triggers><trigger><uuid>93750f768ba94f1bb9302fc17c76faeb</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.load_faults[loadFaults.0],#3,&quot;like&quot;,&quot;customSettingsEdit&quot;)=2</expression><name>Status: Device has &quot;customSettingsEdit&quot; load faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>456e2c36369f4519b2c80bcfe1acb4b0</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.load_faults[loadFaults.0],#3,&quot;like&quot;,&quot;dipSwitchChanged&quot;)=2</expression><name>Status: Device has &quot;dipSwitchChanged&quot; load faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>359df17c40684187b7ae92c8aa0c9624</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.load_faults[loadFaults.0],#3,&quot;like&quot;,&quot;externalShortCircuit&quot;)=2</expression><name>Status: Device has &quot;externalShortCircuit&quot; load faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>6dadf09064304f4381ad9ed0436e562a</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.load_faults[loadFaults.0],#3,&quot;like&quot;,&quot;highTempDisconnect&quot;)=2</expression><name>Status: Device has &quot;highTempDisconnect&quot; load faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>bc41145ae8074290913a47cc3fd11e1e</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.load_faults[loadFaults.0],#3,&quot;like&quot;,&quot;loadHvd&quot;)=2</expression><name>Status: Device has &quot;loadHvd&quot; load faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>8c8a7021928e4bf78b6309574e298876</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.load_faults[loadFaults.0],#3,&quot;like&quot;,&quot;mosfetShorted&quot;)=2</expression><name>Status: Device has &quot;mosfetShorted&quot; load faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>b7d3f05837bd4d788d14f1aaf18b0482</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.load_faults[loadFaults.0],#3,&quot;like&quot;,&quot;overcurrent&quot;)=2</expression><name>Status: Device has &quot;overcurrent&quot; load faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>801728740c1948b1a751469e6443daab</uuid><expression>count(/Morningstar ProStar MPPT by SNMP/status.load_faults[loadFaults.0],#3,&quot;like&quot;,&quot;software&quot;)=2</expression><name>Status: Device has &quot;software&quot; load faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>526ee94df484462a9264e57d92954e64</uuid><name>Status: Uptime (network)</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.2.1.1.3.0</snmp_oid><key>status.net.uptime</key><history>7d</history><units>uptime</units><description>The time (in hundredths of a second) since the network management portion of the system was last re-initialized.</description><preprocessing><step><type>MULTIPLIER</type><parameters><parameter>0.01</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>status</value></tag></tags><triggers><trigger><uuid>59cbcaaee8304b38a1144b3abf40bd9d</uuid><expression>nodata(/Morningstar ProStar MPPT by SNMP/status.net.uptime,5m)=1</expression><name>Status: Failed to fetch data</name><event_name>Status: Failed to fetch data (or no data for 5m)</event_name><priority>WARNING</priority><description>Zabbix has not received data for items for the last 5 minutes.</description><manual_close>YES</manual_close><tags><tag><tag>scope</tag><value>availability</value></tag></tags></trigger></triggers></item><item><uuid>20ce95acdff6486684461f10579a73b4</uuid><name>Battery: Target Voltage</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.48.0</snmp_oid><key>target.voltage[targetVoltage.0]</key><history>7d</history><value_type>FLOAT</value_type><units>V</units><description>MIB: PROSTAR-MPPT
Target Voltage
 Description:Target Regulation Voltage
 Scaling Factor:1.0
 Units:V
 Range:[0.0, 80.0]
 Modbus address:0x0024</description><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>battery</value></tag></tags></item><item><uuid>9a87cdcf65184059be334e986bcf801d</uuid><name>Temperature: Ambient</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.40.0</snmp_oid><key>temp.ambient[ambientTemperature.0]</key><history>7d</history><value_type>FLOAT</value_type><units>C</units><description>MIB: PROSTAR-MPPT
Ambient Temperature
 Description:Ambient Temperature
 Scaling Factor:1.0
 Units:deg C
 Range:[-128, 127]
 Modbus address:0x001C</description><tags><tag><tag>component</tag><value>temperature</value></tag></tags></item><item><uuid>1a8e79f49e86429abc80dd29598299ee</uuid><name>Temperature: Battery</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.39.0</snmp_oid><key>temp.battery[batteryTemperature.0]</key><history>7d</history><value_type>FLOAT</value_type><units>C</units><description>MIB: PROSTAR-MPPT
Battery Temperature
  Description:Battery Temperature
  Scaling Factor:1.0
  Units:deg C
  Range:[-128, 127]
  Modbus address:0x001B</description><tags><tag><tag>component</tag><value>temperature</value></tag></tags><triggers><trigger><uuid>c74e1d3be1c24bde986bbce068db4bb8</uuid><expression>min(/Morningstar ProStar MPPT by SNMP/temp.battery[batteryTemperature.0],5m)&gt;{$BATTERY.TEMP.MAX.CRIT}</expression><name>Temperature: Critically high battery temperature</name><event_name>Temperature: Critically high battery temperature (over {$BATTERY.TEMP.MAX.CRIT}C for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>0c2180ae5deb41adb503e37bf91c34e2</uuid><expression>max(/Morningstar ProStar MPPT by SNMP/temp.battery[batteryTemperature.0],5m)&lt;{$BATTERY.TEMP.MIN.CRIT}</expression><name>Temperature: Critically low battery temperature</name><event_name>Temperature: Critically low battery temperature (below {$BATTERY.TEMP.MIN.WARN}C for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>1ab91d781c734f1eb2b9552f6dee9370</uuid><expression>min(/Morningstar ProStar MPPT by SNMP/temp.battery[batteryTemperature.0],5m)&gt;{$BATTERY.TEMP.MAX.WARN}</expression><name>Temperature: High battery temperature</name><event_name>Temperature: High battery temperature (over {$BATTERY.TEMP.MAX.WARN}C for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><dependencies><dependency><name>Temperature: Critically high battery temperature</name><expression>min(/Morningstar ProStar MPPT by SNMP/temp.battery[batteryTemperature.0],5m)&gt;{$BATTERY.TEMP.MAX.CRIT}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>6ec855dc6a5c42a79f1f40e14655418a</uuid><expression>max(/Morningstar ProStar MPPT by SNMP/temp.battery[batteryTemperature.0],5m)&lt;{$BATTERY.TEMP.MIN.WARN}</expression><name>Temperature: Low battery temperature</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><dependencies><dependency><name>Temperature: Critically low battery temperature</name><expression>max(/Morningstar ProStar MPPT by SNMP/temp.battery[batteryTemperature.0],5m)&lt;{$BATTERY.TEMP.MIN.CRIT}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>7d0cf28c0d334154971738df11775d1f</uuid><name>Temperature: Heatsink</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.38.0</snmp_oid><key>temp.heatsink[heatsinkTemperature.0]</key><history>7d</history><value_type>FLOAT</value_type><units>C</units><description>MIB: PROSTAR-MPPT
Heatsink Temperature
 Description:Heatsink Temperature
 Scaling Factor:1.0
 Units:deg C
 Range:[-128, 127]
 Modbus address:0x001A</description><tags><tag><tag>component</tag><value>temperature</value></tag></tags></item></items><discovery_rules><discovery_rule><uuid>1a21c30663c74c23b60e6ad72e228681</uuid><name>Battery voltage discovery</name><type>DEPENDENT</type><key>battery.voltage.discovery</key><delay>0</delay><description>Discovery for battery voltage triggers</description><item_prototypes><item_prototype><uuid>c02c73a349ec4a6b8557e142c4866148</uuid><name>Battery: Voltage{#SINGLETON}</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.5.30.0</snmp_oid><key>battery.voltage[batteryTerminalVoltage.0{#SINGLETON}]</key><history>7d</history><value_type>FLOAT</value_type><units>V</units><description>MIB: PROSTAR-MPPT
Battery Terminal Voltage
Description:Battery  Terminal Voltage
Scaling Factor:1.0
Units:V
Range:[0.0, 80.0]
Modbus address:0x0012</description><tags><tag><tag>component</tag><value>battery</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>402f73ca5b8d412689a7e715223e890d</uuid><expression>min(/Morningstar ProStar MPPT by SNMP/battery.voltage[batteryTerminalVoltage.0{#SINGLETON}],5m)&gt;{#VOLTAGE.MAX.CRIT}</expression><name>Battery: Critically high battery voltage</name><event_name>Battery: Critically high battery voltage (over {#VOLTAGE.MAX.CRIT}V for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger_prototype><trigger_prototype><uuid>753a0d25832d434186f586f895124f31</uuid><expression>max(/Morningstar ProStar MPPT by SNMP/battery.voltage[batteryTerminalVoltage.0{#SINGLETON}],5m)&lt;{#VOLTAGE.MIN.CRIT}</expression><name>Battery: Critically low battery voltage</name><event_name>Battery: Critically low battery voltage (below {#VOLTAGE.MIN.CRIT}V for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger_prototype><trigger_prototype><uuid>66e1fdfbfa5740dfa8945626f7f8be78</uuid><expression>min(/Morningstar ProStar MPPT by SNMP/battery.voltage[batteryTerminalVoltage.0{#SINGLETON}],5m)&gt;{#VOLTAGE.MAX.WARN}</expression><name>Battery: High battery voltage</name><event_name>Battery: High battery voltage (over {#VOLTAGE.MAX.WARN}V for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><dependencies><dependency><name>Battery: Critically high battery voltage</name><expression>min(/Morningstar ProStar MPPT by SNMP/battery.voltage[batteryTerminalVoltage.0{#SINGLETON}],5m)&gt;{#VOLTAGE.MAX.CRIT}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger_prototype><trigger_prototype><uuid>c9f3d03ce06641eb9b184f511a3a0341</uuid><expression>max(/Morningstar ProStar MPPT by SNMP/battery.voltage[batteryTerminalVoltage.0{#SINGLETON}],5m)&lt;{#VOLTAGE.MIN.WARN}</expression><name>Battery: Low battery voltage</name><event_name>Battery: Low battery voltage (below {#VOLTAGE.MIN.WARN}V for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><dependencies><dependency><name>Battery: Critically low battery voltage</name><expression>max(/Morningstar ProStar MPPT by SNMP/battery.voltage[batteryTerminalVoltage.0{#SINGLETON}],5m)&lt;{#VOLTAGE.MIN.CRIT}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype></item_prototypes><graph_prototypes><graph_prototype><uuid>480e4c11060a4e34851b48bf7b9c5bb1</uuid><name>Voltage: Battery/Load{#SINGLETON}</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>Morningstar ProStar MPPT by SNMP</host><key>battery.voltage[batteryTerminalVoltage.0{#SINGLETON}]</key></item></graph_item><graph_item><sortorder>1</sortorder><drawtype>GRADIENT_LINE</drawtype><color>2774A4</color><item><host>Morningstar ProStar MPPT by SNMP</host><key>load.voltage[loadVoltage.0]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes><master_item><key>battery.voltage.discovery[batteryTerminalVoltage.0]</key></master_item><preprocessing><step><type>JAVASCRIPT</type><parameters><parameter>var v_range = [
      [[0, 18], [12, 15, 11.5, 15.5]],
      [[18, 36], [24, 30, 23, 31]],
      [[36, 99], [48, 60, 46, 62]],
  ],
  result = [];

for (var idx in v_range) {
    if (v_range[idx][0][0] &lt; value &amp;&amp; value &lt;= v_range[idx][0][1]) {
        result = [{
            '{#VOLTAGE.MIN.WARN}': parseInt({$VOLTAGE.MIN.WARN}) || v_range[idx][1][0],
            '{#VOLTAGE.MAX.WARN}': parseInt({$VOLTAGE.MAX.WARN}) || v_range[idx][1][1],
            '{#VOLTAGE.MIN.CRIT}': parseInt({$VOLTAGE.MIN.CRIT}) || v_range[idx][1][2],
            '{#VOLTAGE.MAX.CRIT}': parseInt({$VOLTAGE.MAX.CRIT}) || v_range[idx][1][3],
            '{#SINGLETON}': ''
        }];
        break;
    }
}

return JSON.stringify(result);</parameter></parameters></step></preprocessing></discovery_rule></discovery_rules><tags><tag><tag>class</tag><value>power</value></tag><tag><tag>target</tag><value>morningstar</value></tag></tags><macros><macro><macro>{$BATTERY.TEMP.MAX.CRIT}</macro><value>60</value><description>Battery high temperature critical value</description></macro><macro><macro>{$BATTERY.TEMP.MAX.WARN}</macro><value>45</value><description>Battery high temperature warning value</description></macro><macro><macro>{$BATTERY.TEMP.MIN.CRIT}</macro><value>-20</value><description>Battery low temperature critical value</description></macro><macro><macro>{$BATTERY.TEMP.MIN.WARN}</macro><value>0</value><description>Battery low temperature warning value</description></macro><macro><macro>{$CHARGE.STATE.CRIT}</macro><value>4</value><description>fault</description></macro><macro><macro>{$CHARGE.STATE.WARN}</macro><value>2</value><description>disconnect</description></macro><macro><macro>{$LOAD.STATE.CRIT:&quot;fault&quot;}</macro><value>4</value><description>fault</description></macro><macro><macro>{$LOAD.STATE.CRIT:&quot;lvd&quot;}</macro><value>3</value><description>lvd</description></macro><macro><macro>{$LOAD.STATE.WARN:&quot;disconnect&quot;}</macro><value>5</value><description>disconnect</description></macro><macro><macro>{$LOAD.STATE.WARN:&quot;lvdWarning&quot;}</macro><value>2</value><description>lvdWarning</description></macro><macro><macro>{$LOAD.STATE.WARN:&quot;override&quot;}</macro><value>7</value><description>override</description></macro><macro><macro>{$VOLTAGE.MAX.CRIT}</macro></macro><macro><macro>{$VOLTAGE.MAX.WARN}</macro></macro><macro><macro>{$VOLTAGE.MIN.CRIT}</macro></macro><macro><macro>{$VOLTAGE.MIN.WARN}</macro></macro></macros><valuemaps><valuemap><uuid>1703c3aeb1b24641821e1c6d2cb4c8b7</uuid><name>ProStar MPPT charge state</name><mappings><mapping><value>0</value><newvalue>Start</newvalue></mapping><mapping><value>1</value><newvalue>NightCheck</newvalue></mapping><mapping><value>2</value><newvalue>Disconnect</newvalue></mapping><mapping><value>3</value><newvalue>Night</newvalue></mapping><mapping><value>4</value><newvalue>Fault</newvalue></mapping><mapping><value>5</value><newvalue>BulkMppt</newvalue></mapping><mapping><value>6</value><newvalue>Absorption</newvalue></mapping><mapping><value>7</value><newvalue>Float</newvalue></mapping><mapping><value>8</value><newvalue>Equalize</newvalue></mapping><mapping><value>9</value><newvalue>Slave</newvalue></mapping><mapping><value>10</value><newvalue>Fixed</newvalue></mapping></mappings></valuemap><valuemap><uuid>b5403a0805a54b9294f69a1e11a438b1</uuid><name>ProStar MPPT load state</name><mappings><mapping><value>0</value><newvalue>Start</newvalue></mapping><mapping><value>1</value><newvalue>Normal</newvalue></mapping><mapping><value>2</value><newvalue>LvdWarning</newvalue></mapping><mapping><value>3</value><newvalue>Lvd</newvalue></mapping><mapping><value>4</value><newvalue>Fault</newvalue></mapping><mapping><value>5</value><newvalue>Disconnect</newvalue></mapping><mapping><value>6</value><newvalue>NormalOff</newvalue></mapping><mapping><value>7</value><newvalue>Override</newvalue></mapping><mapping><value>8</value><newvalue>NotUsed</newvalue></mapping></mappings></valuemap></valuemaps></template></templates><triggers><trigger><uuid>ca65a39c019046c29a522a6ca93ceb75</uuid><expression>(last(/Morningstar ProStar MPPT by SNMP/status.hw.uptime)&gt;0 and last(/Morningstar ProStar MPPT by SNMP/status.hw.uptime)&lt;10m) or (last(/Morningstar ProStar MPPT by SNMP/status.hw.uptime)=0 and last(/Morningstar ProStar MPPT by SNMP/status.net.uptime)&lt;10m)</expression><name>Status: Device has been restarted</name><event_name>Status: Device has been restarted (uptime &lt; 10m)</event_name><priority>INFO</priority><description>Uptime is less than 10 minutes.</description><manual_close>YES</manual_close><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers><graphs><graph><uuid>0662dc480c2b487e9f9afc389166a15b</uuid><name>Array: Voltage</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>Morningstar ProStar MPPT by SNMP</host><key>array.sweep_vmp[arrayVmp.0]</key></item></graph_item><graph_item><sortorder>1</sortorder><drawtype>GRADIENT_LINE</drawtype><color>2774A4</color><item><host>Morningstar ProStar MPPT by SNMP</host><key>array.sweep_voc[arrayVoc.0]</key></item></graph_item><graph_item><sortorder>2</sortorder><drawtype>GRADIENT_LINE</drawtype><color>F63100</color><item><host>Morningstar ProStar MPPT by SNMP</host><key>array.voltage[arrayVoltage.0]</key></item></graph_item></graph_items></graph><graph><uuid>94bbfd8a60a8412998ff617011db9372</uuid><name>Current: Charge/Load</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>Morningstar ProStar MPPT by SNMP</host><key>charge.current[chargeCurrent.0]</key></item></graph_item><graph_item><sortorder>1</sortorder><drawtype>GRADIENT_LINE</drawtype><color>2774A4</color><item><host>Morningstar ProStar MPPT by SNMP</host><key>load.current[loadCurrent.0]</key></item></graph_item></graph_items></graph><graph><uuid>02652b1251244702bf28f691e72ba27e</uuid><name>Temperature: Ambient/Battery/Heatsink</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>Morningstar ProStar MPPT by SNMP</host><key>temp.ambient[ambientTemperature.0]</key></item></graph_item><graph_item><sortorder>1</sortorder><drawtype>GRADIENT_LINE</drawtype><color>2774A4</color><item><host>Morningstar ProStar MPPT by SNMP</host><key>temp.battery[batteryTemperature.0]</key></item></graph_item><graph_item><sortorder>2</sortorder><drawtype>GRADIENT_LINE</drawtype><color>F63100</color><item><host>Morningstar ProStar MPPT by SNMP</host><key>temp.heatsink[heatsinkTemperature.0]</key></item></graph_item></graph_items></graph></graphs></zabbix_export>
