<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>6.0</version><date>2023-02-11T16:14:52Z</date><groups><group><uuid>748ad4d098d447d492bb935c907f652f</uuid><name>Templates/Databases</name></group></groups><templates><template><uuid>d38b271797bd41f2ad8c79d83b9d8d9c</uuid><template>MongoDB cluster by Zabbix agent 2</template><name>MongoDB cluster by Zabbix agent 2</name><description>Get MongoDB metrics from plugin for the zabbix-agent2.
  1. Setup and configure zabbix-agent2 compiled with the MongoDB monitoring plugin.
  2. Set the {$MONGODB.CONNSTRING} such as &lt;protocol(host:port)&gt; or named session.
  3. Set the user name and password in host macros ({$MONGODB.USER}, {$MONGODB.PASSWORD}) if you want to override parameters from the Zabbix agent configuration file.

  All sharded Mongodb nodes (mongod) will be discovered with attached template &quot;MongoDB node&quot;.

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/420659-discussion-thread-for-official-zabbix-template-db-mongodb

Template tooling version used: 0.41</description><groups><group><name>Templates/Databases</name></group></groups><items><item><uuid>78db5504896649198605e140abb942be</uuid><name>MongoDB cluster: Configserver heartbeat</name><type>DEPENDENT</type><key>mongodb.config_server_heartbeat</key><delay>0</delay><history>7d</history><units>s</units><description>Difference between the latest optime of the CSRS primary that the mongos has seen and cluster time.</description><preprocessing><step><type>JAVASCRIPT</type><parameters><parameter>data = JSON.parse(value);
return (data[&quot;$clusterTime&quot;].clusterTime.T - data.sharding.lastSeenConfigServerOpTime.ts.T);</parameter></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>configserver</value></tag></tags></item><item><uuid>fccb23cdee01483cabe6ef14a532664b</uuid><name>MongoDB cluster: Connections, active</name><type>DEPENDENT</type><key>mongodb.connections.active</key><delay>0</delay><history>7d</history><description>&quot;The number of active client connections to the server.
Active client connections refers to client connections that currently have operations in progress.
Available starting in  4.0.7, 0 for older versions.&quot;</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.connections.active</parameter></parameters><error_handler>CUSTOM_VALUE</error_handler><error_handler_params>0</error_handler_params></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags></item><item><uuid>1f881cbd515d462eb5839fe4e1e21ee1</uuid><name>MongoDB cluster: Connections, available</name><type>DEPENDENT</type><key>mongodb.connections.available</key><delay>0</delay><history>7d</history><description>&quot;The number of unused incoming connections available.&quot;</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.connections.available</parameter></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags><triggers><trigger><uuid>eae86b6f98db49099259a466b78d1c59</uuid><expression>max(/MongoDB cluster by Zabbix agent 2/mongodb.connections.available,5m)&lt;{$MONGODB.CONNS.AVAILABLE.MIN.WARN}</expression><name>MongoDB cluster: Available connections is low</name><event_name>MongoDB cluster: Available connections less then {$MONGODB.CONNS.AVAILABLE.MIN.WARN}</event_name><priority>WARNING</priority><description>&quot;Too few available connections.
Consider this value in combination with the value of connections current to understand the connection load on the database&quot;</description><tags><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger></triggers></item><item><uuid>087d1a405b7a456692a52b0d20c43eb3</uuid><name>MongoDB cluster: Connections, current</name><type>DEPENDENT</type><key>mongodb.connections.current</key><delay>0</delay><history>7d</history><description>&quot;The number of incoming connections from clients to the database server.
This number includes the current shell session&quot;</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.connections.current</parameter></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags></item><item><uuid>18ed07f0efb54f55970483d15613d320</uuid><name>MongoDB cluster: New connections, rate</name><type>DEPENDENT</type><key>mongodb.connections.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>&quot;Rate of all incoming connections created to the server.&quot;</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.connections.totalCreated</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags></item><item><uuid>281e5a1a19dc402a992331252b27ee63</uuid><name>MongoDB cluster: Connection pool: available</name><type>DEPENDENT</type><key>mongodb.connection_pool.available</key><delay>0</delay><history>7d</history><description>The total number of available outgoing connections from the current mongos instance to other members of the sharded cluster.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.totalAvailable</parameter></parameters></step></preprocessing><master_item><key>mongodb.connpool.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags></item><item><uuid>58522550e8bc4f479681d961ba789b92</uuid><name>MongoDB cluster: Connection pool: client connections</name><type>DEPENDENT</type><key>mongodb.connection_pool.client</key><delay>0</delay><history>7d</history><description>The number of active and stored outgoing synchronous connections from the current mongos instance to other members of the sharded cluster.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.numClientConnections</parameter></parameters></step></preprocessing><master_item><key>mongodb.connpool.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags></item><item><uuid>9b9d601d2d5c4d8da5d97c2785d8e0fa</uuid><name>MongoDB cluster: Connection pool: created, rate</name><type>DEPENDENT</type><key>mongodb.connection_pool.created.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The total number of outgoing connections created per second by the current mongos instance to other members of the sharded cluster.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.totalCreated</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>mongodb.connpool.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags></item><item><uuid>9394a15a25e342688335b7d83db25b2d</uuid><name>MongoDB cluster: Connection pool: in use</name><type>DEPENDENT</type><key>mongodb.connection_pool.in_use</key><delay>0</delay><history>7d</history><description>Reports the total number of outgoing connections from the current mongos instance to other members of the sharded cluster set that are currently in use.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.totalInUse</parameter></parameters></step></preprocessing><master_item><key>mongodb.connpool.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags></item><item><uuid>22c66363ffae4ae2b436a26b8ecca3ab</uuid><name>MongoDB cluster: Connection pool: refreshing</name><type>DEPENDENT</type><key>mongodb.connection_pool.refreshing</key><delay>0</delay><history>7d</history><description>Reports the total number of outgoing connections from the current mongos instance to other members of the sharded cluster that are currently being refreshed.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.totalRefreshing</parameter></parameters></step></preprocessing><master_item><key>mongodb.connpool.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags></item><item><uuid>55dbfe5d52c44954b9e5669a043f10b4</uuid><name>MongoDB cluster: Connection pool: scoped</name><type>DEPENDENT</type><key>mongodb.connection_pool.scoped</key><delay>0</delay><history>7d</history><description>Number of active and stored outgoing scoped synchronous connections from the current mongos instance to other members of the sharded cluster.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.numAScopedConnections</parameter></parameters></step></preprocessing><master_item><key>mongodb.connpool.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags></item><item><uuid>f34fcc3866b446748b7a8d11311edd82</uuid><name>MongoDB cluster: Get mongodb.connpool.stats</name><key>mongodb.connpool.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key><history>0</history><trends>0</trends><value_type>TEXT</value_type><description>Returns current info about connpool.stats.</description><tags><tag><tag>component</tag><value>connections</value></tag><tag><tag>component</tag><value>raw</value></tag></tags></item><item><uuid>22ca0c06006b49009f25fcd829f1b5bf</uuid><name>MongoDB cluster: Cursor: open pinned</name><type>DEPENDENT</type><key>mongodb.cursor.open.pinned</key><delay>0</delay><history>7d</history><description>Number of pinned open cursors.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.metrics.cursor.open.pinned</parameter></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>cursors</value></tag></tags></item><item><uuid>45bfa997dab9498e8e3851de750e21a2</uuid><name>MongoDB cluster: Cursor: open total</name><type>DEPENDENT</type><key>mongodb.cursor.open.total</key><delay>0</delay><history>7d</history><description>Number of cursors that MongoDB is maintaining for clients.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.metrics.cursor.open.total</parameter></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>cursors</value></tag></tags><triggers><trigger><uuid>67db1f543818476ca0b07e2cc1709452</uuid><expression>min(/MongoDB cluster by Zabbix agent 2/mongodb.cursor.open.total,5m)&gt;{$MONGODB.CURSOR.OPEN.MAX.WARN}</expression><name>MongoDB cluster: Too many cursors opened by MongoDB for clients</name><event_name>MongoDB cluster: Too many cursors opened by MongoDB for clients (over {$MONGODB.CURSOR.OPEN.MAX.WARN} in 5m)</event_name><priority>WARNING</priority><tags><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger></triggers></item><item><uuid>5d3a3c724a6a45fb99a0af5330bf9cf2</uuid><name>MongoDB cluster: Cursor: timed out, rate</name><type>DEPENDENT</type><key>mongodb.cursor.timed_out.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of cursors that time out, per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.metrics.cursor.timedOut</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>cursors</value></tag></tags><triggers><trigger><uuid>5ea8cf9c955940a6a580cd6f4bb2cc78</uuid><expression>min(/MongoDB cluster by Zabbix agent 2/mongodb.cursor.timed_out.rate,5m)&gt;{$MONGODB.CURSOR.TIMEOUT.MAX.WARN}</expression><name>MongoDB cluster: Too many cursors are timing out</name><event_name>MongoDB cluster: Too many cursors are timing out (over {$MONGODB.CURSOR.TIMEOUT.MAX.WARN} per second in 5m)</event_name><priority>WARNING</priority><tags><tag><tag>scope</tag><value>performance</value></tag></tags></trigger></triggers></item><item><uuid>110685e463e141ca800b2638e3532d51</uuid><name>MongoDB cluster: Jumbo chunks</name><key>mongodb.jumbo_chunks.count[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key><history>7d</history><description>Total number of 'jumbo' chunks in the mongo cluster.</description><tags><tag><tag>component</tag><value>application</value></tag></tags></item><item><uuid>fa28a98992e74cdf8c54b4faa01de89a</uuid><name>MongoDB cluster: Last seen configserver</name><type>DEPENDENT</type><key>mongodb.last_seen_config_server</key><delay>0</delay><history>7d</history><units>unixtime</units><description>The latest optime of the CSRS primary that the mongos has seen.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.sharding.lastSeenConfigServerOpTime.ts.T</parameter></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>configserver</value></tag></tags></item><item><uuid>df2423ff36e24357809c7a7211144898</uuid><name>MongoDB cluster: Architecture</name><type>DEPENDENT</type><key>mongodb.mem.bits</key><delay>0</delay><history>7d</history><units>bit</units><description>A number, either 64 or 32, that indicates whether the MongoDB instance is compiled for 64-bit or 32-bit architecture.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.mem.bits</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>3h</parameter></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>application</value></tag></tags></item><item><uuid>f6a06e0d7cf84cc1a40d8d2dcde7b01a</uuid><name>MongoDB cluster: Memory: resident</name><type>DEPENDENT</type><key>mongodb.mem.resident</key><delay>0</delay><history>7d</history><units>B</units><description>Amount of memory currently used by the database process.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.mem.resident</parameter></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>1048576</parameter></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>memory</value></tag></tags></item><item><uuid>2c5548ae9c614efb81e58a2e4ec3d3e4</uuid><name>MongoDB cluster: Memory: virtual</name><type>DEPENDENT</type><key>mongodb.mem.virtual</key><delay>0</delay><history>7d</history><units>B</units><description>Amount of virtual memory used by the mongos process.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.mem.virtual</parameter></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>1048576</parameter></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>memory</value></tag></tags></item><item><uuid>16925e0ca40747d1818e512962d31a83</uuid><name>MongoDB cluster: Cursor: open no timeout</name><type>DEPENDENT</type><key>mongodb.metrics.cursor.open.no_timeout</key><delay>0</delay><history>7d</history><description>Number of open cursors with the option DBQuery.Option.noTimeout set to prevent timeout after a period of inactivity.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.metrics.cursor.open.noTimeout</parameter></parameters><error_handler>DISCARD_VALUE</error_handler></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>cursors</value></tag></tags></item><item><uuid>59481dcb9b5a487985297e2f41f72dd1</uuid><name>MongoDB cluster: Bytes in, rate</name><type>DEPENDENT</type><key>mongodb.network.bytes_in.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The total number of bytes that the server has received over network connections initiated by clients or other mongod/mongos instances per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.network.bytesIn</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>network</value></tag></tags></item><item><uuid>13cba18ba344440bba4371585fd8e4c0</uuid><name>MongoDB cluster: Bytes out, rate</name><type>DEPENDENT</type><key>mongodb.network.bytes_out.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>Bps</units><description>The total number of bytes that the server has sent over network connections initiated by clients or other mongod/mongos instances per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.network.bytesOut</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>network</value></tag></tags></item><item><uuid>eb821875b59c4bf8bc98f9afec146e88</uuid><name>MongoDB cluster: Requests, rate</name><type>DEPENDENT</type><key>mongodb.network.numRequests.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>!Rps</units><description>Number of distinct requests that the server has received per second</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.network.numRequests</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>network</value></tag></tags></item><item><uuid>b98fb6d98b9a4282ba0b2d9770722035</uuid><name>MongoDB cluster: Operations: command</name><type>DEPENDENT</type><key>mongodb.opcounters.command.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>&quot;The number of commands issued to the database per second.
Counts all commands except the write commands: insert, update, and delete.&quot;</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.opcounters.command</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>operations</value></tag></tags></item><item><uuid>f4e917e9cdd3439abbe6ea7b9a9034b7</uuid><name>MongoDB cluster: Operations: delete</name><type>DEPENDENT</type><key>mongodb.opcounters.delete.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The number of delete operations the mongos instance per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.opcounters.delete</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>operations</value></tag></tags></item><item><uuid>165d5a180ed541ba9a19916134962368</uuid><name>MongoDB cluster: Operations: getmore, rate</name><type>DEPENDENT</type><key>mongodb.opcounters.getmore.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>&quot;The number of “getmore” operations the mongos per second. This counter can be high even if the query count is low.
Secondary nodes send getMore operations as part of the replication process.&quot;</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.opcounters.getmore</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>operations</value></tag></tags></item><item><uuid>021a00004efe434a9b2f316c0d25c175</uuid><name>MongoDB cluster: Operations: insert, rate</name><type>DEPENDENT</type><key>mongodb.opcounters.insert.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The number of insert operations received the mongos instance per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.opcounters.insert</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>operations</value></tag></tags></item><item><uuid>0866b3b6bc1748a98e8bfd9308152304</uuid><name>MongoDB cluster: Operations: query, rate</name><type>DEPENDENT</type><key>mongodb.opcounters.query.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The number of queries received the mongos instance per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.opcounters.query</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>operations</value></tag></tags></item><item><uuid>329e6d41de1c47dba8f3f9d287c93eda</uuid><name>MongoDB cluster: Operations: update, rate</name><type>DEPENDENT</type><key>mongodb.opcounters.update.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The number of update operations the mongos instance per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.opcounters.update</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>operations</value></tag></tags></item><item><uuid>ff979eb9ba4a4420a753913df5431219</uuid><name>MongoDB cluster: Ping</name><key>mongodb.ping[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key><delay>30s</delay><history>7d</history><description>Test if a connection is alive or not.</description><valuemap><name>Service state</name></valuemap><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>30m</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>health</value></tag></tags><triggers><trigger><uuid>cd74289970204ca281c5bc7d5c695e95</uuid><expression>last(/MongoDB cluster by Zabbix agent 2/mongodb.ping[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;])=0</expression><name>MongoDB cluster: Connection to mongos proxy is unavailable</name><priority>HIGH</priority><description>Connection to mongos proxy instance is currently unavailable.</description><tags><tag><tag>scope</tag><value>availability</value></tag></tags></trigger></triggers></item><item><uuid>b8c6dadff060447e9718b49fdc796d8d</uuid><name>MongoDB cluster: Get server status</name><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key><history>0</history><trends>0</trends><value_type>TEXT</value_type><description>The mongos statistic</description><tags><tag><tag>component</tag><value>raw</value></tag></tags></item><item><uuid>e88da2ca6ccc4fdfa256fa51e050792d</uuid><name>MongoDB cluster: Uptime</name><type>DEPENDENT</type><key>mongodb.uptime</key><delay>0</delay><history>7d</history><units>s</units><description>Number of seconds since Mongos server start</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.uptime</parameter></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>application</value></tag></tags><triggers><trigger><uuid>ee70d6da232a4068b574c9c147c622c9</uuid><expression>nodata(/MongoDB cluster by Zabbix agent 2/mongodb.uptime,10m)=1</expression><name>MongoDB cluster: Failed to fetch info data</name><event_name>MongoDB cluster: Failed to fetch info data (or no data for 10m)</event_name><priority>WARNING</priority><description>Zabbix has not received data for items for the last 10 minutes</description><manual_close>YES</manual_close><dependencies><dependency><name>MongoDB cluster: Connection to mongos proxy is unavailable</name><expression>last(/MongoDB cluster by Zabbix agent 2/mongodb.ping[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;])=0</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>99ff438a7e3e4b0a8190b2ab9f41f076</uuid><expression>last(/MongoDB cluster by Zabbix agent 2/mongodb.uptime)&lt;10m</expression><name>MongoDB cluster: has been restarted</name><event_name>MongoDB cluster: has been restarted (uptime &lt; 10m)</event_name><priority>INFO</priority><description>Uptime is less than 10 minutes.</description><manual_close>YES</manual_close><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>dda1722d6e6b4189978fd44ace0f8f86</uuid><name>MongoDB cluster: Mongos version</name><type>DEPENDENT</type><key>mongodb.version</key><delay>0</delay><history>7d</history><trends>0</trends><value_type>CHAR</value_type><description>Version of the Mongos server</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.version</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>3h</parameter></parameters></step></preprocessing><master_item><key>mongodb.server.status[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key></master_item><tags><tag><tag>component</tag><value>application</value></tag></tags><triggers><trigger><uuid>921ee489887943838d69558f103ad646</uuid><expression>last(/MongoDB cluster by Zabbix agent 2/mongodb.version,#1)&lt;&gt;last(/MongoDB cluster by Zabbix agent 2/mongodb.version,#2) and length(last(/MongoDB cluster by Zabbix agent 2/mongodb.version))&gt;0</expression><name>MongoDB cluster: Version has changed</name><event_name>MongoDB cluster: Version has changed (new version: {ITEM.VALUE})</event_name><priority>INFO</priority><description>MongoDB cluster version has changed. Ack to close.</description><manual_close>YES</manual_close><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item></items><discovery_rules><discovery_rule><uuid>eb57a506cc5640a79e6df51179321ba0</uuid><name>Config servers discovery</name><key>mongodb.cfg.discovery[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key><delay>30m</delay><description>Discovery shared cluster config servers.</description><host_prototypes><host_prototype><uuid>809db5d8d32a45898e8401f288a42fac</uuid><host>{#HOSTNAME}</host><name>{#HOSTNAME}</name><group_links><group_link><group><name>Templates/Databases</name></group></group_link></group_links><group_prototypes><group_prototype><name>MongoDB sharded cluster/{#REPLICASET}</name></group_prototype></group_prototypes><templates><template><name>MongoDB node by Zabbix agent 2</name></template></templates><macros><macro><macro>{$MONGODB.CONNSTRING}</macro><value>{#MONGOD_URI}</value><description>Connection string in the URI format (password is not used).</description></macro></macros></host_prototype></host_prototypes></discovery_rule><discovery_rule><uuid>61a19fbf4f9f4c2f9ad215b08d41e544</uuid><name>Collection discovery</name><key>mongodb.collections.discovery[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key><delay>30m</delay><filter><evaltype>AND</evaltype><conditions><condition><macro>{#DBNAME}</macro><value>{$MONGODB.LLD.FILTER.DB.MATCHES}</value><formulaid>C</formulaid></condition><condition><macro>{#DBNAME}</macro><value>{$MONGODB.LLD.FILTER.DB.NOT_MATCHES}</value><operator>NOT_MATCHES_REGEX</operator><formulaid>D</formulaid></condition><condition><macro>{#COLLECTION}</macro><value>{$MONGODB.LLD.FILTER.COLLECTION.MATCHES}</value><formulaid>A</formulaid></condition><condition><macro>{#COLLECTION}</macro><value>{$MONGODB.LLD.FILTER.COLLECTION.NOT_MATCHES}</value><operator>NOT_MATCHES_REGEX</operator><formulaid>B</formulaid></condition></conditions></filter><description>Collect collections metrics.
Note, depending on the number of DBs and collections this discovery operation may be expensive. Use filters with macros {$MONGODB.LLD.FILTER.DB.MATCHES}, {$MONGODB.LLD.FILTER.DB.NOT_MATCHES}, {$MONGODB.LLD.FILTER.COLLECTION.MATCHES}, {$MONGODB.LLD.FILTER.COLLECTION.NOT_MATCHES}.</description><item_prototypes><item_prototype><uuid>253af5ef7858482fbeaa0c06c033b47a</uuid><name>MongoDB {#DBNAME}.{#COLLECTION}: Objects, avg size</name><type>DEPENDENT</type><key>mongodb.collection.avg_obj_size[&quot;{#DBNAME}&quot;,&quot;{#COLLECTION}&quot;]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>B</units><description>The size of the average object in the collection in bytes.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.avgObjSize</parameter></parameters><error_handler>DISCARD_VALUE</error_handler></step></preprocessing><master_item><key>mongodb.collection.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;,&quot;{#DBNAME}&quot;,&quot;{#COLLECTION}&quot;]</key></master_item><tags><tag><tag>collection</tag><value>{#COLLECTION}</value></tag><tag><tag>component</tag><value>objects</value></tag><tag><tag>database</tag><value>{#DBNAME}</value></tag></tags></item_prototype><item_prototype><uuid>59465dc6e9384c7baf1a6239a6c66f0e</uuid><name>MongoDB {#DBNAME}.{#COLLECTION}: Capped</name><type>DEPENDENT</type><key>mongodb.collection.capped[&quot;{#DBNAME}&quot;,&quot;{#COLLECTION}&quot;]</key><delay>0</delay><history>7d</history><trends>0</trends><value_type>CHAR</value_type><description>Whether or not the collection is capped.</description><valuemap><name>MongoDB flag</name></valuemap><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.capped</parameter></parameters></step><step><type>BOOL_TO_DECIMAL</type><parameters><parameter/></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>3h</parameter></parameters></step></preprocessing><master_item><key>mongodb.collection.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;,&quot;{#DBNAME}&quot;,&quot;{#COLLECTION}&quot;]</key></master_item><tags><tag><tag>collection</tag><value>{#COLLECTION}</value></tag><tag><tag>component</tag><value>application</value></tag><tag><tag>database</tag><value>{#DBNAME}</value></tag></tags></item_prototype><item_prototype><uuid>03b8eb71502a4805902f7a5856e7c7b6</uuid><name>MongoDB {#DBNAME}.{#COLLECTION}: Objects, count</name><type>DEPENDENT</type><key>mongodb.collection.count[&quot;{#DBNAME}&quot;,&quot;{#COLLECTION}&quot;]</key><delay>0</delay><history>7d</history><description>Total number of objects in the collection.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.count</parameter></parameters></step></preprocessing><master_item><key>mongodb.collection.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;,&quot;{#DBNAME}&quot;,&quot;{#COLLECTION}&quot;]</key></master_item><tags><tag><tag>collection</tag><value>{#COLLECTION}</value></tag><tag><tag>component</tag><value>objects</value></tag><tag><tag>database</tag><value>{#DBNAME}</value></tag></tags></item_prototype><item_prototype><uuid>2a78fa441bef4523bd0fee4934fc7b55</uuid><name>MongoDB {#DBNAME}.{#COLLECTION}: Capped, max number</name><type>DEPENDENT</type><key>mongodb.collection.max[&quot;{#DBNAME}&quot;,&quot;{#COLLECTION}&quot;]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Maximum number of documents in a capped collection.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.max</parameter></parameters><error_handler>DISCARD_VALUE</error_handler></step></preprocessing><master_item><key>mongodb.collection.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;,&quot;{#DBNAME}&quot;,&quot;{#COLLECTION}&quot;]</key></master_item><tags><tag><tag>collection</tag><value>{#COLLECTION}</value></tag><tag><tag>component</tag><value>application</value></tag><tag><tag>database</tag><value>{#DBNAME}</value></tag></tags></item_prototype><item_prototype><uuid>294985df777b42e0a56a229366bbac5d</uuid><name>MongoDB {#DBNAME}.{#COLLECTION}: Capped, max size</name><type>DEPENDENT</type><key>mongodb.collection.max_size[&quot;{#DBNAME}&quot;,&quot;{#COLLECTION}&quot;]</key><delay>0</delay><history>7d</history><units>B</units><description>Maximum size of a capped collection in bytes.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.maxSize</parameter></parameters><error_handler>DISCARD_VALUE</error_handler></step></preprocessing><master_item><key>mongodb.collection.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;,&quot;{#DBNAME}&quot;,&quot;{#COLLECTION}&quot;]</key></master_item><tags><tag><tag>collection</tag><value>{#COLLECTION}</value></tag><tag><tag>component</tag><value>disk</value></tag><tag><tag>database</tag><value>{#DBNAME}</value></tag></tags></item_prototype><item_prototype><uuid>8da7cc960e8d42ccb3efe065fff5f0e9</uuid><name>MongoDB {#DBNAME}.{#COLLECTION}: Indexes</name><type>DEPENDENT</type><key>mongodb.collection.nindexes[&quot;{#DBNAME}&quot;,&quot;{#COLLECTION}&quot;]</key><delay>0</delay><history>7d</history><description>Total number of indices on the collection.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.nindexes</parameter></parameters></step></preprocessing><master_item><key>mongodb.collection.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;,&quot;{#DBNAME}&quot;,&quot;{#COLLECTION}&quot;]</key></master_item><tags><tag><tag>collection</tag><value>{#COLLECTION}</value></tag><tag><tag>component</tag><value>application</value></tag><tag><tag>database</tag><value>{#DBNAME}</value></tag></tags></item_prototype><item_prototype><uuid>191a21d9a1b94b238009e31433dbaa38</uuid><name>MongoDB {#DBNAME}.{#COLLECTION}: Size</name><type>DEPENDENT</type><key>mongodb.collection.size[&quot;{#DBNAME}&quot;,&quot;{#COLLECTION}&quot;]</key><delay>0</delay><history>7d</history><units>B</units><description>The total size in bytes of the data in the collection plus the size of every indexes on the mongodb.collection.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.size</parameter></parameters></step></preprocessing><master_item><key>mongodb.collection.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;,&quot;{#DBNAME}&quot;,&quot;{#COLLECTION}&quot;]</key></master_item><tags><tag><tag>collection</tag><value>{#COLLECTION}</value></tag><tag><tag>component</tag><value>disk</value></tag><tag><tag>database</tag><value>{#DBNAME}</value></tag></tags></item_prototype><item_prototype><uuid>aa964be0bc5c4318bc92c3192c269d8e</uuid><name>MongoDB {#DBNAME}.{#COLLECTION}: Get collection stats {#DBNAME}.{#COLLECTION}</name><key>mongodb.collection.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;,&quot;{#DBNAME}&quot;,&quot;{#COLLECTION}&quot;]</key><history>0</history><trends>0</trends><value_type>TEXT</value_type><description>Returns a variety of storage statistics for a given collection.</description><tags><tag><tag>collection</tag><value>{#COLLECTION}</value></tag><tag><tag>component</tag><value>raw</value></tag><tag><tag>database</tag><value>{#DBNAME}</value></tag></tags></item_prototype><item_prototype><uuid>ef82b9f814cd4917b3714e73d7ac87ac</uuid><name>MongoDB {#DBNAME}.{#COLLECTION}: Storage size</name><type>DEPENDENT</type><key>mongodb.collection.storage_size[&quot;{#DBNAME}&quot;,&quot;{#COLLECTION}&quot;]</key><delay>0</delay><history>7d</history><units>B</units><description>Total storage space allocated to this collection for document storage.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.storageSize</parameter></parameters></step></preprocessing><master_item><key>mongodb.collection.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;,&quot;{#DBNAME}&quot;,&quot;{#COLLECTION}&quot;]</key></master_item><tags><tag><tag>collection</tag><value>{#COLLECTION}</value></tag><tag><tag>component</tag><value>disk</value></tag><tag><tag>database</tag><value>{#DBNAME}</value></tag></tags></item_prototype></item_prototypes></discovery_rule><discovery_rule><uuid>25ece32c5f764461913f605ba3d7736a</uuid><name>Database discovery</name><key>mongodb.db.discovery[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key><delay>30m</delay><filter><evaltype>AND</evaltype><conditions><condition><macro>{#DBNAME}</macro><value>{$MONGODB.LLD.FILTER.DB.MATCHES}</value><formulaid>A</formulaid></condition><condition><macro>{#DBNAME}</macro><value>{$MONGODB.LLD.FILTER.DB.NOT_MATCHES}</value><operator>NOT_MATCHES_REGEX</operator><formulaid>B</formulaid></condition></conditions></filter><description>Collect database metrics.
Note, depending on the number of DBs this discovery operation may be expensive. Use filters with macros {$MONGODB.LLD.FILTER.DB.MATCHES}, {$MONGODB.LLD.FILTER.DB.NOT_MATCHES}.</description><item_prototypes><item_prototype><uuid>6dea9a371b94402aad9f8c6d7fcc5761</uuid><name>MongoDB {#DBNAME}: Size, data</name><type>DEPENDENT</type><key>mongodb.db.data_size[&quot;{#DBNAME}&quot;]</key><delay>0</delay><history>7d</history><units>B</units><description>Total size of the data held in this database including the padding factor.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.dataSize</parameter></parameters></step></preprocessing><master_item><key>mongodb.db.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;,&quot;{#DBNAME}&quot;]</key></master_item><tags><tag><tag>component</tag><value>disk</value></tag><tag><tag>database</tag><value>{#DBNAME}</value></tag></tags></item_prototype><item_prototype><uuid>98c9e25c24b146aeaec4953913bb720a</uuid><name>MongoDB {#DBNAME}: Extents</name><type>DEPENDENT</type><key>mongodb.db.extents[&quot;{#DBNAME}&quot;]</key><delay>0</delay><history>7d</history><description>Contains a count of the number of extents in the database across all collections.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.numExtents</parameter></parameters><error_handler>DISCARD_VALUE</error_handler></step></preprocessing><master_item><key>mongodb.db.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;,&quot;{#DBNAME}&quot;]</key></master_item><tags><tag><tag>component</tag><value>collections</value></tag><tag><tag>database</tag><value>{#DBNAME}</value></tag></tags></item_prototype><item_prototype><uuid>cfb3598af7f14911965d548ea815cb33</uuid><name>MongoDB {#DBNAME}: Size, file</name><type>DEPENDENT</type><key>mongodb.db.file_size[&quot;{#DBNAME}&quot;]</key><delay>0</delay><history>7d</history><units>B</units><description>Total size of the data held in this database including the padding factor (only available with the mmapv1 storage engine).</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.fileSize</parameter></parameters><error_handler>DISCARD_VALUE</error_handler></step></preprocessing><master_item><key>mongodb.db.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;,&quot;{#DBNAME}&quot;]</key></master_item><tags><tag><tag>component</tag><value>disk</value></tag><tag><tag>database</tag><value>{#DBNAME}</value></tag></tags></item_prototype><item_prototype><uuid>1716a51105f2415eb179a43022656e4a</uuid><name>MongoDB {#DBNAME}: Size, index</name><type>DEPENDENT</type><key>mongodb.db.index_size[&quot;{#DBNAME}&quot;]</key><delay>0</delay><history>7d</history><units>B</units><description>Total size of all indexes created on this database.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.indexSize</parameter></parameters></step></preprocessing><master_item><key>mongodb.db.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;,&quot;{#DBNAME}&quot;]</key></master_item><tags><tag><tag>component</tag><value>disk</value></tag><tag><tag>database</tag><value>{#DBNAME}</value></tag></tags></item_prototype><item_prototype><uuid>f28f2df7b1e64aea99b20ca8deda2a25</uuid><name>MongoDB {#DBNAME}: Objects, count</name><type>DEPENDENT</type><key>mongodb.db.objects[&quot;{#DBNAME}&quot;]</key><delay>0</delay><history>7d</history><description>Number of objects (documents) in the database across all collections.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.objects</parameter></parameters></step></preprocessing><master_item><key>mongodb.db.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;,&quot;{#DBNAME}&quot;]</key></master_item><tags><tag><tag>component</tag><value>objects</value></tag><tag><tag>database</tag><value>{#DBNAME}</value></tag></tags></item_prototype><item_prototype><uuid>ed3076f82f494b6e953a9a5a3199df06</uuid><name>MongoDB {#DBNAME}: Objects, avg size</name><type>DEPENDENT</type><key>mongodb.db.size[&quot;{#DBNAME}&quot;]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>B</units><description>The average size of each document in bytes.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.avgObjSize</parameter></parameters></step></preprocessing><master_item><key>mongodb.db.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;,&quot;{#DBNAME}&quot;]</key></master_item><tags><tag><tag>component</tag><value>objects</value></tag><tag><tag>database</tag><value>{#DBNAME}</value></tag></tags></item_prototype><item_prototype><uuid>7fbc424bca06451d9ed1fe689ea81bf9</uuid><name>MongoDB {#DBNAME}: Get db stats {#DBNAME}</name><key>mongodb.db.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;,&quot;{#DBNAME}&quot;]</key><history>0</history><trends>0</trends><value_type>TEXT</value_type><description>Returns statistics reflecting the database system's state.</description><tags><tag><tag>component</tag><value>database</value></tag><tag><tag>component</tag><value>raw</value></tag><tag><tag>database</tag><value>{#DBNAME}</value></tag></tags></item_prototype><item_prototype><uuid>ae54fbae851b4b5a949611420fbc8ce0</uuid><name>MongoDB {#DBNAME}: Size, storage</name><type>DEPENDENT</type><key>mongodb.db.storage_size[&quot;{#DBNAME}&quot;]</key><delay>0</delay><history>7d</history><units>B</units><description>Total amount of space allocated to collections in this database for document storage.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.storageSize</parameter></parameters></step></preprocessing><master_item><key>mongodb.db.stats[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;,&quot;{#DBNAME}&quot;]</key></master_item><tags><tag><tag>component</tag><value>disk</value></tag><tag><tag>database</tag><value>{#DBNAME}</value></tag></tags></item_prototype></item_prototypes><graph_prototypes><graph_prototype><uuid>44e0e02d1e9a420b9dc917d8cf4bf983</uuid><name>MongoDB {#DBNAME}: Disk usage</name><graph_items><graph_item><color>1A7C11</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.db.index_size[&quot;{#DBNAME}&quot;]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.db.storage_size[&quot;{#DBNAME}&quot;]</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.db.file_size[&quot;{#DBNAME}&quot;]</key></item></graph_item><graph_item><sortorder>3</sortorder><color>A54F10</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.db.data_size[&quot;{#DBNAME}&quot;]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes></discovery_rule><discovery_rule><uuid>a8bcea1509974c0f9d0051591e92cd5a</uuid><name>Shards discovery</name><key>mongodb.sh.discovery[&quot;{$MONGODB.CONNSTRING}&quot;,&quot;{$MONGODB.USER}&quot;,&quot;{$MONGODB.PASSWORD}&quot;]</key><delay>30m</delay><description>Discovery shared cluster hosts.</description><host_prototypes><host_prototype><uuid>3fcd3244b1234186bda9a35c8f61c850</uuid><host>{#HOSTNAME}</host><name>{#HOSTNAME}</name><group_links><group_link><group><name>Templates/Databases</name></group></group_link></group_links><group_prototypes><group_prototype><name>MongoDB sharded cluster/{#ID}</name></group_prototype></group_prototypes><templates><template><name>MongoDB node by Zabbix agent 2</name></template></templates><macros><macro><macro>{$MONGODB.CONNSTRING}</macro><value>{#MONGOD_URI}</value><description>Connection string in the URI format (password is not used).</description></macro></macros></host_prototype></host_prototypes></discovery_rule></discovery_rules><tags><tag><tag>class</tag><value>database</value></tag><tag><tag>target</tag><value>mongodb-cluster</value></tag></tags><macros><macro><macro>{$MONGODB.CONNS.AVAILABLE.MIN.WARN}</macro><value>1000</value><description>Minimum number of available connections</description></macro><macro><macro>{$MONGODB.CONNSTRING}</macro><value>tcp://localhost:27017</value><description>Connection string in the URI format (password is not used). This param overwrites a value configured in the &quot;Server&quot; option of the configuration file (if it's set), otherwise, the plugin's default value is used: &quot;tcp://localhost:27017&quot;</description></macro><macro><macro>{$MONGODB.CURSOR.OPEN.MAX.WARN}</macro><value>10000</value><description>Maximum number of open cursors</description></macro><macro><macro>{$MONGODB.CURSOR.TIMEOUT.MAX.WARN}</macro><value>1</value><description>Maximum number of cursors timing out per second</description></macro><macro><macro>{$MONGODB.LLD.FILTER.COLLECTION.MATCHES}</macro><value>.*</value><description>Filter of discoverable collections</description></macro><macro><macro>{$MONGODB.LLD.FILTER.COLLECTION.NOT_MATCHES}</macro><value>CHANGE_IF_NEEDED</value><description>Filter to exclude discovered collections</description></macro><macro><macro>{$MONGODB.LLD.FILTER.DB.MATCHES}</macro><value>.*</value><description>Filter of discoverable databases</description></macro><macro><macro>{$MONGODB.LLD.FILTER.DB.NOT_MATCHES}</macro><value>(admin|config|local)</value><description>Filter to exclude discovered databases</description></macro><macro><macro>{$MONGODB.PASSWORD}</macro><description>MongoDB user password</description></macro><macro><macro>{$MONGODB.USER}</macro><description>MongoDB username</description></macro></macros><valuemaps><valuemap><uuid>2014769595e34d4bb18dbcf4d9eaf112</uuid><name>MongoDB flag</name><mappings><mapping><value>0</value><newvalue>False</newvalue></mapping><mapping><value>1</value><newvalue>True</newvalue></mapping></mappings></valuemap><valuemap><uuid>3cedce4712fa4a3eba63ccd7a790ecf6</uuid><name>Service state</name><mappings><mapping><value>0</value><newvalue>Down</newvalue></mapping><mapping><value>1</value><newvalue>Up</newvalue></mapping></mappings></valuemap></valuemaps></template></templates><graphs><graph><uuid>311d33ada96e4910a350e62abc6d5321</uuid><name>MongoDB cluster: Connection pool</name><graph_items><graph_item><color>1A7C11</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.connection_pool.available</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.connection_pool.refreshing</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.connection_pool.in_use</key></item></graph_item><graph_item><sortorder>3</sortorder><color>A54F10</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.connection_pool.scoped</key></item></graph_item><graph_item><sortorder>4</sortorder><color>FC6EA3</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.connection_pool.client</key></item></graph_item></graph_items></graph><graph><uuid>71a5a2d563d64bceacd564fe25b4d49e</uuid><name>MongoDB cluster: Connections</name><graph_items><graph_item><color>1A7C11</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.connections.available</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.connections.active</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.connections.current</key></item></graph_item><graph_item><sortorder>3</sortorder><drawtype>BOLD_LINE</drawtype><color>A54F10</color><yaxisside>RIGHT</yaxisside><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.connections.rate</key></item></graph_item></graph_items></graph><graph><uuid>b4277ddaf3c5486cacba0f9b7208c5b2</uuid><name>MongoDB cluster: Cursors</name><graph_items><graph_item><color>1A7C11</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.cursor.open.total</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.cursor.open.pinned</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.metrics.cursor.open.no_timeout</key></item></graph_item></graph_items></graph><graph><uuid>d612246739784b9b9403dee6024493ce</uuid><name>MongoDB cluster: Network</name><graph_items><graph_item><color>1A7C11</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.network.bytes_out.rate</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.network.bytes_in.rate</key></item></graph_item></graph_items></graph><graph><uuid>4228deefccae4cd2959b183ba3e36295</uuid><name>MongoDB cluster: Operations rate</name><graph_items><graph_item><drawtype>BOLD_LINE</drawtype><color>1A7C11</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.opcounters.query.rate</key></item></graph_item><graph_item><sortorder>1</sortorder><drawtype>BOLD_LINE</drawtype><color>2774A4</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.opcounters.insert.rate</key></item></graph_item><graph_item><sortorder>2</sortorder><drawtype>BOLD_LINE</drawtype><color>F63100</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.opcounters.getmore.rate</key></item></graph_item><graph_item><sortorder>3</sortorder><drawtype>BOLD_LINE</drawtype><color>A54F10</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.opcounters.update.rate</key></item></graph_item><graph_item><sortorder>4</sortorder><drawtype>BOLD_LINE</drawtype><color>FC6EA3</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.opcounters.delete.rate</key></item></graph_item><graph_item><sortorder>5</sortorder><drawtype>BOLD_LINE</drawtype><color>6C59DC</color><item><host>MongoDB cluster by Zabbix agent 2</host><key>mongodb.opcounters.command.rate</key></item></graph_item></graph_items></graph></graphs></zabbix_export>
