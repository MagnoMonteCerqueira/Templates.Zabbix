<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>6.0</version><date>2023-02-11T16:15:08Z</date><groups><group><uuid>a571c0d144b14fd4a87a9d9b2aa9fcd6</uuid><name>Templates/Applications</name></group></groups><templates><template><uuid>ece96efdf0a045b99ede7978fa9366d6</uuid><template>Kubernetes Scheduler by HTTP</template><name>Kubernetes Scheduler by HTTP</name><description>Get Kubernetes Scheduler metrics by HTTP agent from Prometheus metrics endpoint.

Don't forget change macros {$KUBE.API.SERVER.URL}.
Some metrics may not be collected depending on your Kubernetes Scheduler instance version and configuration.

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback

Template tooling version used: 0.41</description><groups><group><name>Templates/Applications</name></group></groups><items><item><uuid>87e91f23320043549457a5b2ab8ddf74</uuid><name>Kubernetes Scheduler: REST Client requests: 2xx, rate</name><type>DEPENDENT</type><key>kubernetes.scheduler.client_http_requests_200.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of HTTP requests with 2xx status code per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>rest_client_requests_total{code =~ &quot;2..&quot;}</parameter><parameter>function</parameter><parameter>sum</parameter></parameters><error_handler>DISCARD_VALUE</error_handler></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><tags><tag><tag>component</tag><value>rest</value></tag><tag><tag>http-code</tag><value>2xx</value></tag></tags></item><item><uuid>b790f8c9a6b44f54837a6b3cb1dcec41</uuid><name>Kubernetes Scheduler: REST Client requests: 3xx, rate</name><type>DEPENDENT</type><key>kubernetes.scheduler.client_http_requests_300.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of HTTP requests with 3xx status code per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>rest_client_requests_total{code =~ &quot;3..&quot;}</parameter><parameter>function</parameter><parameter>sum</parameter></parameters><error_handler>DISCARD_VALUE</error_handler></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><tags><tag><tag>component</tag><value>rest</value></tag><tag><tag>http-code</tag><value>3xx</value></tag></tags></item><item><uuid>84e09cb3134b492b983649bc29da11ee</uuid><name>Kubernetes Scheduler: REST Client requests: 4xx, rate</name><type>DEPENDENT</type><key>kubernetes.scheduler.client_http_requests_400.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of HTTP requests with 4xx status code per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>rest_client_requests_total{code =~ &quot;4..&quot;}</parameter><parameter>function</parameter><parameter>sum</parameter></parameters><error_handler>DISCARD_VALUE</error_handler></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><tags><tag><tag>component</tag><value>rest</value></tag><tag><tag>http-code</tag><value>4xx</value></tag></tags></item><item><uuid>d94fce6ae59b4735b93e1ccfb9084dc2</uuid><name>Kubernetes Scheduler: REST Client requests: 5xx, rate</name><type>DEPENDENT</type><key>kubernetes.scheduler.client_http_requests_500.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of HTTP requests with 5xx status code per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>rest_client_requests_total{code =~ &quot;5..&quot;}</parameter><parameter>function</parameter><parameter>sum</parameter></parameters><error_handler>DISCARD_VALUE</error_handler></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><tags><tag><tag>component</tag><value>rest</value></tag><tag><tag>http-code</tag><value>5xx</value></tag></tags><triggers><trigger><uuid>ea92474a61214053b2cd20775817010e</uuid><expression>min(/Kubernetes Scheduler by HTTP/kubernetes.scheduler.client_http_requests_500.rate,5m)&gt;{$KUBE.SCHEDULER.HTTP.CLIENT.ERROR}</expression><name>Kubernetes Scheduler: Too many REST Client errors</name><event_name>Kubernetes Scheduler: Too many REST Client errors (over {$KUBE.SCHEDULER.HTTP.CLIENT.ERROR} for 5m)</event_name><priority>WARNING</priority><description>&quot;Kubernetes Scheduler REST Client requests is experiencing high error rate (with 5xx HTTP code).</description><tags><tag><tag>scope</tag><value>availability</value></tag></tags></trigger></triggers></item><item><uuid>b1d79dbb773d47668476a12ca8ee3d08</uuid><name>Kubernetes Scheduler: CPU</name><type>DEPENDENT</type><key>kubernetes.scheduler.cpu.util</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>%</units><description>Total user and system CPU usage ratio.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>process_cpu_seconds_total</parameter><parameter>value</parameter><parameter/></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>100</parameter></parameters></step></preprocessing><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><tags><tag><tag>component</tag><value>cpu</value></tag></tags></item><item><uuid>2534eacdaf9b44d68388b366da40af59</uuid><name>Kubernetes Scheduler: Get Scheduler metrics</name><type>HTTP_AGENT</type><key>kubernetes.scheduler.get_metrics</key><history>0</history><trends>0</trends><value_type>TEXT</value_type><description>Get raw metrics from Scheduler instance /metrics endpoint.</description><preprocessing><step><type>CHECK_NOT_SUPPORTED</type><parameters><parameter/></parameters></step></preprocessing><timeout>15s</timeout><url>{$KUBE.SCHEDULER.SERVER.URL}</url><headers><header><name>Authorization</name><value>Bearer {$KUBE.API.TOKEN}</value></header></headers><tags><tag><tag>component</tag><value>raw</value></tag></tags></item><item><uuid>a21ec7ee8a76449f99199777d35cdd03</uuid><name>Kubernetes Scheduler: Goroutines</name><type>DEPENDENT</type><key>kubernetes.scheduler.go_goroutines</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of goroutines that currently exist.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>go_goroutines</parameter><parameter>function</parameter><parameter>sum</parameter></parameters><error_handler>DISCARD_VALUE</error_handler></step></preprocessing><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><tags><tag><tag>component</tag><value>goroutines</value></tag></tags></item><item><uuid>d7493f23748f440b8cae127e6ff70bb7</uuid><name>Kubernetes Scheduler: Go threads</name><type>DEPENDENT</type><key>kubernetes.scheduler.go_threads</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of OS threads created.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>go_threads</parameter><parameter>value</parameter><parameter/></parameters><error_handler>DISCARD_VALUE</error_handler></step></preprocessing><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><tags><tag><tag>component</tag><value>go-threads</value></tag></tags></item><item><uuid>11471cff0d664bdb906cf54821af9710</uuid><name>Kubernetes Scheduler: Fds max</name><type>DEPENDENT</type><key>kubernetes.scheduler.max_fds</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Maximum allowed open file descriptors.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>process_max_fds</parameter><parameter>value</parameter><parameter/></parameters><error_handler>DISCARD_VALUE</error_handler></step></preprocessing><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><tags><tag><tag>component</tag><value>fds</value></tag></tags></item><item><uuid>2aa6fb05cb3e4f33a05ebf331be1ed54</uuid><name>Kubernetes Scheduler: Fds open</name><type>DEPENDENT</type><key>kubernetes.scheduler.open_fds</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of open file descriptors.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>process_open_fds</parameter><parameter>value</parameter><parameter/></parameters><error_handler>DISCARD_VALUE</error_handler></step></preprocessing><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><tags><tag><tag>component</tag><value>fds</value></tag></tags></item><item><uuid>f8272f957dc447f19876395994050edd</uuid><name>Kubernetes Scheduler: Resident memory, bytes</name><type>DEPENDENT</type><key>kubernetes.scheduler.process_resident_memory_bytes</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>B</units><description>Resident memory size in bytes.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>process_resident_memory_bytes</parameter><parameter>value</parameter><parameter/></parameters><error_handler>DISCARD_VALUE</error_handler></step></preprocessing><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><tags><tag><tag>component</tag><value>memory</value></tag></tags></item><item><uuid>0319ccb3efb94aeba6181c1f34cc999a</uuid><name>Kubernetes Scheduler: Virtual memory, bytes</name><type>DEPENDENT</type><key>kubernetes.scheduler.process_virtual_memory_bytes</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>B</units><description>Virtual memory size in bytes.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>process_virtual_memory_bytes</parameter><parameter>value</parameter><parameter/></parameters><error_handler>DISCARD_VALUE</error_handler></step></preprocessing><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><tags><tag><tag>component</tag><value>memory</value></tag></tags></item><item><uuid>f198d7705dd34d52b57a31aa8b5a423a</uuid><name>Kubernetes Scheduler: Schedule attempts: error</name><type>DEPENDENT</type><key>kubernetes.scheduler.scheduler_schedule_attempts.error.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of attempts to schedule pods with result &quot;error&quot; per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>scheduler_schedule_attempts_total{result = &quot;error&quot;}</parameter><parameter>function</parameter><parameter>sum</parameter></parameters><error_handler>DISCARD_VALUE</error_handler></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><tags><tag><tag>component</tag><value>scheduler</value></tag></tags><triggers><trigger><uuid>9116327bc14f4f189ca867b43187f6bd</uuid><expression>min(/Kubernetes Scheduler by HTTP/kubernetes.scheduler.scheduler_schedule_attempts.error.rate,5m)&gt;{$KUBE.SCHEDULER.ERROR}</expression><name>Kubernetes Scheduler: Too many schedule attempts with errors</name><event_name>Kubernetes Scheduler: Too many schedule attempts with errors (over {$KUBE.SCHEDULER.ERROR} for 5m)</event_name><priority>WARNING</priority><description>&quot;Number of attempts to schedule pods with 'error' result is too high. 'error' means an internal scheduler problem.&quot;</description><tags><tag><tag>scope</tag><value>performance</value></tag></tags></trigger></triggers></item><item><uuid>d5c901849f134b40b077c50e02415fff</uuid><name>Kubernetes Scheduler: Schedule attempts: scheduled</name><type>DEPENDENT</type><key>kubernetes.scheduler.scheduler_schedule_attempts.scheduled.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of attempts to schedule pods with result &quot;scheduled&quot; per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>scheduler_schedule_attempts_total{result = &quot;scheduled&quot;}</parameter><parameter>function</parameter><parameter>sum</parameter></parameters><error_handler>DISCARD_VALUE</error_handler></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><tags><tag><tag>component</tag><value>scheduler</value></tag></tags></item><item><uuid>5736a89200684c709c22f9fb3711bb83</uuid><name>Kubernetes Scheduler: Schedule attempts: unschedulable</name><type>DEPENDENT</type><key>kubernetes.scheduler.scheduler_schedule_attempts.unschedulable.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of attempts to schedule pods with result &quot;unschedulable&quot; per second.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>scheduler_schedule_attempts_total{result = &quot;unschedulable&quot;}</parameter><parameter>function</parameter><parameter>sum</parameter></parameters><error_handler>DISCARD_VALUE</error_handler></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><tags><tag><tag>component</tag><value>scheduler</value></tag></tags><triggers><trigger><uuid>16efba4ba322416fa2b8986273b83904</uuid><expression>min(/Kubernetes Scheduler by HTTP/kubernetes.scheduler.scheduler_schedule_attempts.unschedulable.rate,5m)&gt;{$KUBE.SCHEDULER.UNSCHEDULABLE}</expression><name>Kubernetes Scheduler: Too many unschedulable pods</name><event_name>Kubernetes Scheduler: Too many unschedulable pods (over {$KUBE.SCHEDULER.UNSCHEDULABLE} for 5m)</event_name><priority>WARNING</priority><description>&quot;Number of attempts to schedule pods with 'unschedulable' result is too high. 'unschedulable' means a pod could not be scheduled.&quot;</description><tags><tag><tag>scope</tag><value>performance</value></tag></tags></trigger></triggers></item></items><discovery_rules><discovery_rule><uuid>0dacff4b5ab841569642350388f4e534</uuid><name>e2e scheduling histogram</name><type>DEPENDENT</type><key>kubernetes.controller.e2e_scheduling.discovery</key><delay>0</delay><description>Discovery raw data and percentile items of e2e scheduling latency.</description><item_prototypes><item_prototype><uuid>eaeb8c321626466bbf7c08008a82b9c8</uuid><name>Kubernetes Scheduler: [&quot;{#RESULT}&quot;]: e2e scheduling seconds bucket, {#LE}</name><type>DEPENDENT</type><key>kubernetes.scheduler.e2e_scheduling_bucket[{#LE},&quot;{#RESULT}&quot;]</key><delay>0</delay><history>1h</history><trends>0</trends><discover>NO_DISCOVER</discover><value_type>FLOAT</value_type><description>E2e scheduling latency in seconds (scheduling algorithm + binding)</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>scheduler_e2e_scheduling_duration_seconds_bucket{result = &quot;{#RESULT}&quot;,le = &quot;{#LE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters><error_handler>DISCARD_VALUE</error_handler></step></preprocessing><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><tags><tag><tag>component</tag><value>e2e-scheduling</value></tag><tag><tag>result</tag><value>{#RESULT}</value></tag></tags></item_prototype><item_prototype><uuid>b8fd5b4454484f4298e2c2b1e5c832c5</uuid><name>Kubernetes Scheduler: [&quot;{#RESULT}&quot;]: e2e scheduling, p50</name><type>CALCULATED</type><key>kubernetes.scheduler.e2e_scheduling_p50[&quot;{#RESULT}&quot;]</key><history>7d</history><discover>NO_DISCOVER</discover><value_type>FLOAT</value_type><units>s</units><params>bucket_percentile(//kubernetes.scheduler.e2e_scheduling_bucket[*,&quot;{#RESULT}&quot;],5m,50)</params><description>50 percentile of e2e scheduling latency.</description><tags><tag><tag>component</tag><value>e2e-scheduling</value></tag><tag><tag>result</tag><value>{#RESULT}</value></tag></tags></item_prototype><item_prototype><uuid>01edd56cd1c94d4b80589d91349e4be5</uuid><name>Kubernetes Scheduler: [&quot;{#RESULT}&quot;]: e2e scheduling, p90</name><type>CALCULATED</type><key>kubernetes.scheduler.e2e_scheduling_p90[&quot;{#RESULT}&quot;]</key><history>7d</history><discover>NO_DISCOVER</discover><value_type>FLOAT</value_type><units>s</units><params>bucket_percentile(//kubernetes.scheduler.e2e_scheduling_bucket[*,&quot;{#RESULT}&quot;],5m,90)</params><description>90 percentile of e2e scheduling latency.</description><tags><tag><tag>component</tag><value>e2e-scheduling</value></tag><tag><tag>result</tag><value>{#RESULT}</value></tag></tags></item_prototype><item_prototype><uuid>706fc27da4d34a4e9189c566c7aa96ff</uuid><name>Kubernetes Scheduler: [&quot;{#RESULT}&quot;]: e2e scheduling, p95</name><type>CALCULATED</type><key>kubernetes.scheduler.e2e_scheduling_p95[&quot;{#RESULT}&quot;]</key><history>7d</history><discover>NO_DISCOVER</discover><value_type>FLOAT</value_type><units>s</units><params>bucket_percentile(//kubernetes.scheduler.e2e_scheduling_bucket[*,&quot;{#RESULT}&quot;],5m,95)</params><description>95 percentile of e2e scheduling latency.</description><tags><tag><tag>component</tag><value>e2e-scheduling</value></tag><tag><tag>result</tag><value>{#RESULT}</value></tag></tags></item_prototype><item_prototype><uuid>829627aeab764590b3a17e6b10c56709</uuid><name>Kubernetes Scheduler: [&quot;{#RESULT}&quot;]: e2e scheduling, p99</name><type>CALCULATED</type><key>kubernetes.scheduler.e2e_scheduling_p99[&quot;{#RESULT}&quot;]</key><history>7d</history><discover>NO_DISCOVER</discover><value_type>FLOAT</value_type><units>s</units><params>bucket_percentile(//kubernetes.scheduler.e2e_scheduling_bucket[*,&quot;{#RESULT}&quot;],5m,99)</params><description>95 percentile of e2e scheduling latency.</description><tags><tag><tag>component</tag><value>e2e-scheduling</value></tag><tag><tag>result</tag><value>{#RESULT}</value></tag></tags></item_prototype></item_prototypes><graph_prototypes><graph_prototype><uuid>be0cb738e2a346f8a24cabf0f76a6e6a</uuid><name>Kubernetes Scheduler: [&quot;{#RESULT}&quot;] E2e latency</name><graph_items><graph_item><color>1A7C11</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.e2e_scheduling_p50[&quot;{#RESULT}&quot;]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.e2e_scheduling_p90[&quot;{#RESULT}&quot;]</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.e2e_scheduling_p95[&quot;{#RESULT}&quot;]</key></item></graph_item><graph_item><sortorder>3</sortorder><color>A54F10</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.e2e_scheduling_p99[&quot;{#RESULT}&quot;]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><preprocessing><step><type>PROMETHEUS_TO_JSON</type><parameters><parameter>{__name__=~ &quot;scheduler_e2e_scheduling_duration_*&quot;, result =~ &quot;.*&quot;}</parameter></parameters></step><step><type>JAVASCRIPT</type><parameters><parameter>var lookup = {},
    result = [];

JSON.parse(value).forEach(function (item) {
    if (item.name === &quot;scheduler_e2e_scheduling_duration_seconds_count&quot;){
        var label_result = item.labels.result;

        if (lookup[label_result]) {
            return;
        }
        lookup[label_result] = 1;
        result.push({
            '{#TYPE}': 'totals',
            '{#RESULT}': label_result
        });

      }
    else if  (item.name === &quot;scheduler_e2e_scheduling_duration_seconds_bucket&quot;){
        result.push({
            '{#TYPE}': 'buckets',
            '{#RESULT}': item.labels.result,
            '{#LE}': item.labels.le
        });
    }
});

return JSON.stringify(result);</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>3h</parameter></parameters></step></preprocessing><overrides><override><name>bucket item</name><step>1</step><filter><conditions><condition><macro>{#TYPE}</macro><value>buckets</value><formulaid>A</formulaid></condition></conditions></filter><operations><operation><operationobject>ITEM_PROTOTYPE</operationobject><operator>LIKE</operator><value>bucket</value><status>ENABLED</status><discover>DISCOVER</discover></operation></operations></override><override><name>total item</name><step>2</step><filter><conditions><condition><macro>{#TYPE}</macro><value>totals</value><formulaid>A</formulaid></condition></conditions></filter><operations><operation><operationobject>ITEM_PROTOTYPE</operationobject><operator>NOT_LIKE</operator><value>bucket</value><status>ENABLED</status><discover>DISCOVER</discover></operation></operations></override></overrides></discovery_rule><discovery_rule><uuid>8cfc88eb0f6b4ae09d93bd9fc275659d</uuid><name>Binding histogram</name><type>DEPENDENT</type><key>kubernetes.scheduler.binding.discovery</key><delay>0</delay><description>Discovery raw data of binding latency.</description><item_prototypes><item_prototype><uuid>17a3d7122cd844ea905059020532907b</uuid><name>Kubernetes Scheduler: Binding duration bucket, {#LE}</name><type>DEPENDENT</type><key>kubernetes.scheduler.binding_duration[{#LE}]</key><delay>0</delay><history>1h</history><trends>0</trends><discover>NO_DISCOVER</discover><value_type>FLOAT</value_type><description>Binding latency in seconds.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>scheduler_binding_duration_seconds_bucket{le = &quot;{#LE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters><error_handler>DISCARD_VALUE</error_handler></step></preprocessing><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><tags><tag><tag>component</tag><value>binding</value></tag></tags></item_prototype><item_prototype><uuid>5f40c030c1964ff7ab7786cee97bee81</uuid><name>Kubernetes Scheduler: Binding duration, p50</name><type>CALCULATED</type><key>kubernetes.scheduler.binding_duration_p50[{#SINGLETON}]</key><history>7d</history><discover>NO_DISCOVER</discover><value_type>FLOAT</value_type><units>s</units><params>bucket_percentile(//kubernetes.scheduler.binding_duration[*],5m,50)</params><description>50 percentile of binding latency in seconds.</description><tags><tag><tag>component</tag><value>binding</value></tag></tags></item_prototype><item_prototype><uuid>19ba0e215a9f4e13b3079fcdaf124cc5</uuid><name>Kubernetes Scheduler: Binding duration, p90</name><type>CALCULATED</type><key>kubernetes.scheduler.binding_duration_p90[{#SINGLETON}]</key><history>7d</history><discover>NO_DISCOVER</discover><value_type>FLOAT</value_type><units>s</units><params>bucket_percentile(//kubernetes.scheduler.binding_duration[*],5m,90)</params><description>90 percentile of binding latency in seconds.</description><tags><tag><tag>component</tag><value>binding</value></tag></tags></item_prototype><item_prototype><uuid>b24d657a1568437fac77535a80d63bc3</uuid><name>Kubernetes Scheduler: Binding duration, p95</name><type>CALCULATED</type><key>kubernetes.scheduler.binding_duration_p95[{#SINGLETON}]</key><history>7d</history><discover>NO_DISCOVER</discover><value_type>FLOAT</value_type><units>s</units><params>bucket_percentile(//kubernetes.scheduler.binding_duration[*],5m,95)</params><description>99 percentile of binding latency in seconds.</description><tags><tag><tag>component</tag><value>binding</value></tag></tags></item_prototype><item_prototype><uuid>258d5d4b6534488a92ba29185e3ca56f</uuid><name>Kubernetes Scheduler: Binding duration, p99</name><type>CALCULATED</type><key>kubernetes.scheduler.binding_duration_p99[{#SINGLETON}]</key><history>7d</history><discover>NO_DISCOVER</discover><value_type>FLOAT</value_type><units>s</units><params>bucket_percentile(//kubernetes.scheduler.binding_duration[*],5m,99)</params><description>95 percentile of binding latency in seconds.</description><tags><tag><tag>component</tag><value>binding</value></tag></tags></item_prototype></item_prototypes><graph_prototypes><graph_prototype><uuid>1c8da2cb32ae4dfaa0d16cff0cecfc43</uuid><name>Kubernetes Scheduler: [{#SINGLETON}]Binding latency</name><graph_items><graph_item><color>1A7C11</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.binding_duration_p50[{#SINGLETON}]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.binding_duration_p90[{#SINGLETON}]</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.binding_duration_p95[{#SINGLETON}]</key></item></graph_item><graph_item><sortorder>3</sortorder><color>A54F10</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.binding_duration_p99[{#SINGLETON}]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><preprocessing><step><type>PROMETHEUS_TO_JSON</type><parameters><parameter>{__name__=~ &quot;scheduler_binding_duration_seconds_*&quot;}</parameter></parameters></step><step><type>JAVASCRIPT</type><parameters><parameter>var lookup = {},
    result = [];
JSON.parse(value).forEach(function (item) {
    if (item.name === &quot;scheduler_binding_duration_seconds_count&quot;){
        result.push({
            '{#TYPE}': 'totals',
            '{#SINGLETON}': ''
        });

      }
    else if  (item.name === &quot;scheduler_binding_duration_seconds_bucket&quot;){
        result.push({
            '{#TYPE}': 'buckets',
            '{#LE}': item.labels.le
        });
    }
});

return JSON.stringify(result);</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>3h</parameter></parameters></step></preprocessing><overrides><override><name>bucket item</name><step>1</step><filter><conditions><condition><macro>{#TYPE}</macro><value>buckets</value><formulaid>A</formulaid></condition></conditions></filter><operations><operation><operationobject>ITEM_PROTOTYPE</operationobject><operator>LIKE</operator><value>bucket</value><status>ENABLED</status><discover>DISCOVER</discover></operation></operations></override><override><name>total item</name><step>2</step><filter><conditions><condition><macro>{#TYPE}</macro><value>totals</value><formulaid>A</formulaid></condition></conditions></filter><operations><operation><operationobject>ITEM_PROTOTYPE</operationobject><operator>NOT_LIKE</operator><value>bucket</value><status>ENABLED</status><discover>DISCOVER</discover></operation></operations></override></overrides></discovery_rule><discovery_rule><uuid>5d4a17f09a7e4ad3b4ac72c30bac5e7d</uuid><name>Scheduling algorithm histogram</name><type>DEPENDENT</type><key>kubernetes.scheduler.scheduling_algorithm.discovery</key><delay>0</delay><description>Discovery raw data of scheduling algorithm latency.</description><item_prototypes><item_prototype><uuid>c794f7fbd7494bb69d9c51140c443236</uuid><name>Kubernetes Scheduler: Scheduling algorithm duration bucket, {#LE}</name><type>DEPENDENT</type><key>kubernetes.scheduler.scheduling_algorithm_duration[{#LE}]</key><delay>0</delay><history>1h</history><trends>0</trends><discover>NO_DISCOVER</discover><value_type>FLOAT</value_type><description>Scheduling algorithm latency in seconds.</description><preprocessing><step><type>PROMETHEUS_PATTERN</type><parameters><parameter>scheduler_scheduling_algorithm_duration_seconds_bucket{le = &quot;{#LE}&quot;}</parameter><parameter>value</parameter><parameter/></parameters><error_handler>DISCARD_VALUE</error_handler></step></preprocessing><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><tags><tag><tag>component</tag><value>scheduling-algorithm</value></tag></tags></item_prototype><item_prototype><uuid>3df35ee6e86a424f89f51bb74cb40b9d</uuid><name>Kubernetes Scheduler: Scheduling algorithm duration, p50</name><type>CALCULATED</type><key>kubernetes.scheduler.scheduling_algorithm_duration_p50[{#SINGLETON}]</key><history>7d</history><discover>NO_DISCOVER</discover><value_type>FLOAT</value_type><units>s</units><params>bucket_percentile(//kubernetes.scheduler.scheduling_algorithm_duration[*],5m,50)</params><description>50 percentile of scheduling algorithm latency in seconds.</description><tags><tag><tag>component</tag><value>scheduling-algorithm</value></tag></tags></item_prototype><item_prototype><uuid>2368f2c98f3641bdbd030d94ca53a4dd</uuid><name>Kubernetes Scheduler: Scheduling algorithm duration, p90</name><type>CALCULATED</type><key>kubernetes.scheduler.scheduling_algorithm_duration_p90[{#SINGLETON}]</key><history>7d</history><discover>NO_DISCOVER</discover><value_type>FLOAT</value_type><units>s</units><params>bucket_percentile(//kubernetes.scheduler.scheduling_algorithm_duration[*],5m,90)</params><description>90 percentile of scheduling algorithm latency in seconds.</description><tags><tag><tag>component</tag><value>scheduling-algorithm</value></tag></tags></item_prototype><item_prototype><uuid>6ca6a2480c4343a8b9a4e6598ec86501</uuid><name>Kubernetes Scheduler: Scheduling algorithm duration, p95</name><type>CALCULATED</type><key>kubernetes.scheduler.scheduling_algorithm_duration_p95[{#SINGLETON}]</key><history>7d</history><discover>NO_DISCOVER</discover><value_type>FLOAT</value_type><units>s</units><params>bucket_percentile(//kubernetes.scheduler.scheduling_algorithm_duration[*],5m,95)</params><description>95 percentile of scheduling algorithm latency in seconds.</description><tags><tag><tag>component</tag><value>scheduling-algorithm</value></tag></tags></item_prototype><item_prototype><uuid>955f0989372c4f9d82ad364b09f5efea</uuid><name>Kubernetes Scheduler: Scheduling algorithm duration, p99</name><type>CALCULATED</type><key>kubernetes.scheduler.scheduling_algorithm_duration_p99[{#SINGLETON}]</key><history>7d</history><discover>NO_DISCOVER</discover><value_type>FLOAT</value_type><units>s</units><params>bucket_percentile(//kubernetes.scheduler.scheduling_algorithm_duration[*],5m,99)</params><description>99 percentile of scheduling algorithm latency in seconds.</description><tags><tag><tag>component</tag><value>scheduling-algorithm</value></tag></tags></item_prototype></item_prototypes><graph_prototypes><graph_prototype><uuid>94607df22a1c49e5aa290fd50e9c2238</uuid><name>Kubernetes Scheduler: [{#SINGLETON}]Scheduling algorithm duration</name><graph_items><graph_item><color>1A7C11</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.scheduling_algorithm_duration_p50[{#SINGLETON}]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.scheduling_algorithm_duration_p90[{#SINGLETON}]</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.scheduling_algorithm_duration_p95[{#SINGLETON}]</key></item></graph_item><graph_item><sortorder>3</sortorder><color>A54F10</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.scheduling_algorithm_duration_p99[{#SINGLETON}]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes><master_item><key>kubernetes.scheduler.get_metrics</key></master_item><preprocessing><step><type>PROMETHEUS_TO_JSON</type><parameters><parameter>{__name__=~ &quot;scheduler_scheduling_algorithm_duration_seconds_*&quot;}</parameter></parameters></step><step><type>JAVASCRIPT</type><parameters><parameter>var lookup = {},
    result = [];
JSON.parse(value).forEach(function (item) {
    if (item.name === &quot;scheduler_scheduling_algorithm_duration_seconds_count&quot;){
        result.push({
            '{#TYPE}': 'totals',
            '{#SINGLETON}': ''
        });

      }
    else if  (item.name === &quot;scheduler_scheduling_algorithm_duration_seconds_bucket&quot;){
        result.push({
            '{#TYPE}': 'buckets',
            '{#LE}': item.labels.le
        });
    }
});

return JSON.stringify(result);</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>3h</parameter></parameters></step></preprocessing><overrides><override><name>bucket item</name><step>1</step><filter><conditions><condition><macro>{#TYPE}</macro><value>buckets</value><formulaid>A</formulaid></condition></conditions></filter><operations><operation><operationobject>ITEM_PROTOTYPE</operationobject><operator>LIKE</operator><value>bucket</value><status>ENABLED</status><discover>DISCOVER</discover></operation></operations></override><override><name>total item</name><step>2</step><filter><conditions><condition><macro>{#TYPE}</macro><value>totals</value><formulaid>A</formulaid></condition></conditions></filter><operations><operation><operationobject>ITEM_PROTOTYPE</operationobject><operator>NOT_LIKE</operator><value>bucket</value><status>ENABLED</status><discover>DISCOVER</discover></operation></operations></override></overrides></discovery_rule></discovery_rules><tags><tag><tag>class</tag><value>software</value></tag><tag><tag>target</tag><value>kubernetes scheduler</value></tag></tags><macros><macro><macro>{$KUBE.API.TOKEN}</macro><description>API Authorization Token</description></macro><macro><macro>{$KUBE.SCHEDULER.ERROR}</macro><value>2</value><description>Maximum number of scheduling failures with 'error' used for trigger</description></macro><macro><macro>{$KUBE.SCHEDULER.HTTP.CLIENT.ERROR}</macro><value>2</value><description>Maximum number of HTTP client requests failures used for trigger</description></macro><macro><macro>{$KUBE.SCHEDULER.SERVER.URL}</macro><value>http://localhost:10251/metrics</value><description>Instance URL</description></macro><macro><macro>{$KUBE.SCHEDULER.UNSCHEDULABLE}</macro><value>2</value><description>Maximum number of scheduling failures with 'unschedulable' used for trigger</description></macro></macros></template></templates><graphs><graph><uuid>dd98f209541449f4a476718c46a0e721</uuid><name>Kubernetes Scheduler: Memory usage</name><graph_items><graph_item><color>1A7C11</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.process_virtual_memory_bytes</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.process_resident_memory_bytes</key></item></graph_item></graph_items></graph><graph><uuid>fd57f67690424eb6a2e5bee610c305ad</uuid><name>Kubernetes Scheduler: REST Client query rate</name><graph_items><graph_item><color>1A7C11</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.client_http_requests_500.rate</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.client_http_requests_400.rate</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.client_http_requests_300.rate</key></item></graph_item><graph_item><sortorder>3</sortorder><color>A54F10</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.client_http_requests_200.rate</key></item></graph_item></graph_items></graph><graph><uuid>4ee3ca9852a2440ea100e21291ac9103</uuid><name>Kubernetes Scheduler: Scheduling attempts rate</name><graph_items><graph_item><color>1A7C11</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.scheduler_schedule_attempts.scheduled.rate</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.scheduler_schedule_attempts.unschedulable.rate</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>Kubernetes Scheduler by HTTP</host><key>kubernetes.scheduler.scheduler_schedule_attempts.error.rate</key></item></graph_item></graph_items></graph></graphs></zabbix_export>
