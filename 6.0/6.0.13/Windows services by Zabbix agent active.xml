<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>6.0</version><date>2023-02-11T16:14:48Z</date><groups><group><uuid>57b7ae836ca64446ba2c296389c009b7</uuid><name>Templates/Modules</name></group></groups><templates><template><uuid>3366a65bbc3e46348bec303e84e23b15</uuid><template>Windows services by Zabbix agent active</template><name>Windows services by Zabbix agent active</name><description>Template Services OS Windows

Template tooling version used: 0.41</description><groups><group><name>Templates/Modules</name></group></groups><discovery_rules><discovery_rule><uuid>25e19e75eb4d4fd68df976323c7fac21</uuid><name>Windows services discovery</name><type>ZABBIX_ACTIVE</type><key>service.discovery</key><delay>1h</delay><filter><evaltype>AND</evaltype><conditions><condition><macro>{#SERVICE.NAME}</macro><value>{$SERVICE.NAME.MATCHES}</value><formulaid>A</formulaid></condition><condition><macro>{#SERVICE.NAME}</macro><value>{$SERVICE.NAME.NOT_MATCHES}</value><operator>NOT_MATCHES_REGEX</operator><formulaid>B</formulaid></condition><condition><macro>{#SERVICE.STARTUPNAME}</macro><value>{$SERVICE.STARTUPNAME.MATCHES}</value><formulaid>C</formulaid></condition><condition><macro>{#SERVICE.STARTUPNAME}</macro><value>{$SERVICE.STARTUPNAME.NOT_MATCHES}</value><operator>NOT_MATCHES_REGEX</operator><formulaid>D</formulaid></condition></conditions></filter><description>Discovery of Windows services of different types as defined in template's macros.</description><item_prototypes><item_prototype><uuid>c1606f1f7c9e4eb494c0c5e4e4f21ea5</uuid><name>State of service &quot;{#SERVICE.NAME}&quot; ({#SERVICE.DISPLAYNAME})</name><type>ZABBIX_ACTIVE</type><key>service.info[&quot;{#SERVICE.NAME}&quot;,state]</key><history>7d</history><valuemap><name>Windows service state</name></valuemap><tags><tag><tag>component</tag><value>system</value></tag><tag><tag>name</tag><value>{#SERVICE.DISPLAYNAME}</value></tag><tag><tag>service</tag><value>{#SERVICE.NAME}</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>df3247515e2e4b48b2decd8401c11736</uuid><expression>min(/Windows services by Zabbix agent active/service.info[&quot;{#SERVICE.NAME}&quot;,state],#3)&lt;&gt;0</expression><name>&quot;{#SERVICE.NAME}&quot; ({#SERVICE.DISPLAYNAME}) is not running</name><event_name>&quot;{#SERVICE.NAME}&quot; ({#SERVICE.DISPLAYNAME}) is not running (startup type {#SERVICE.STARTUPNAME})</event_name><priority>AVERAGE</priority><description>The service has a state other than &quot;Running&quot; for the last three times.</description><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype></item_prototypes></discovery_rule></discovery_rules><macros><macro><macro>{$SERVICE.NAME.MATCHES}</macro><value>^.*$</value><description>This macro is used in Service discovery. Can be overridden on the host or linked template level.</description></macro><macro><macro>{$SERVICE.NAME.NOT_MATCHES}</macro><value>^(?:RemoteRegistry|MMCSS|gupdate|SysmonLog|clr_optimization_v.+|sppsvc|gpsvc|Pml Driver HPZ12|Net Driver HPZ12|MapsBroker|IntelAudioService|Intel\(R\) TPM Provisioning Service|dbupdate|DoSvc|CDPUserSvc_.+|WpnUserService_.+|OneSyncSvc_.+|WbioSrvc|BITS|tiledatamodelsvc|GISvc|ShellHWDetection|TrustedInstaller|TabletInputService|CDPSvc|wuauserv)$</value><description>This macro is used in Service discovery. Can be overridden on the host or linked template level.</description></macro><macro><macro>{$SERVICE.STARTUPNAME.MATCHES}</macro><value>^(?:automatic|automatic delayed)$</value><description>This macro is used in Service discovery. Can be overridden on the host or linked template level.</description></macro><macro><macro>{$SERVICE.STARTUPNAME.NOT_MATCHES}</macro><value>^(?:manual|disabled)$</value><description>This macro is used in Service discovery. Can be overridden on the host or linked template level.</description></macro></macros><valuemaps><valuemap><uuid>af7bd46d70ed4058afa4961d130dc0b2</uuid><name>Windows service state</name><mappings><mapping><value>0</value><newvalue>Running</newvalue></mapping><mapping><value>1</value><newvalue>Paused</newvalue></mapping><mapping><value>2</value><newvalue>Start pending</newvalue></mapping><mapping><value>3</value><newvalue>Pause pending</newvalue></mapping><mapping><value>4</value><newvalue>Continue pending</newvalue></mapping><mapping><value>5</value><newvalue>Stop pending</newvalue></mapping><mapping><value>6</value><newvalue>Stopped</newvalue></mapping><mapping><value>7</value><newvalue>Unknown</newvalue></mapping><mapping><value>255</value><newvalue>No such service</newvalue></mapping></mappings></valuemap></valuemaps></template></templates></zabbix_export>
