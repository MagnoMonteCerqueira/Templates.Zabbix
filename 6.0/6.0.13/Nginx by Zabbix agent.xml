<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>6.0</version><date>2023-02-11T16:14:40Z</date><groups><group><uuid>a571c0d144b14fd4a87a9d9b2aa9fcd6</uuid><name>Templates/Applications</name></group></groups><templates><template><uuid>27f6424905884dbb96ab9210d987a56c</uuid><template>Nginx by Zabbix agent</template><name>Nginx by Zabbix agent</name><description>Get metrics from stub status module using Zabbix agent running on Linux
https://nginx.ru/en/docs/http/ngx_http_stub_status_module.html


You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/384765-discussion-thread-for-official-zabbix-template-nginx

Template tooling version used: 0.41</description><groups><group><name>Templates/Applications</name></group></groups><items><item><uuid>75a7795df3034835bcfd143f7c3e9b94</uuid><name>Nginx: Service response time</name><key>net.tcp.service.perf[http,&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;]</key><history>7d</history><value_type>FLOAT</value_type><units>s</units><tags><tag><tag>component</tag><value>application</value></tag><tag><tag>component</tag><value>health</value></tag></tags><triggers><trigger><uuid>f5db329410a14609a5f3e883ca493cc8</uuid><expression>min(/Nginx by Zabbix agent/net.tcp.service.perf[http,&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;],5m)&gt;{$NGINX.RESPONSE_TIME.MAX.WARN}</expression><name>Nginx: Service response time is too high</name><event_name>Nginx: Service response time is too high (over {$NGINX.RESPONSE_TIME.MAX.WARN}s for 5m)</event_name><priority>WARNING</priority><manual_close>YES</manual_close><dependencies><dependency><name>Nginx: Process is not running</name><expression>last(/Nginx by Zabbix agent/proc.num[nginx])=0</expression></dependency><dependency><name>Nginx: Service is down</name><expression>last(/Nginx by Zabbix agent/net.tcp.service[http,&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;])=0</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>performance</value></tag></tags></trigger></triggers></item><item><uuid>f06e76888f464e13b7cc4c3db33e8131</uuid><name>Nginx: Service status</name><key>net.tcp.service[http,&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;]</key><history>7d</history><valuemap><name>Service state</name></valuemap><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>10m</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>application</value></tag><tag><tag>component</tag><value>health</value></tag></tags><triggers><trigger><uuid>c043191c22f34522ba4f83430d9f88b1</uuid><expression>last(/Nginx by Zabbix agent/net.tcp.service[http,&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;])=0</expression><name>Nginx: Service is down</name><priority>AVERAGE</priority><manual_close>YES</manual_close><dependencies><dependency><name>Nginx: Process is not running</name><expression>last(/Nginx by Zabbix agent/proc.num[nginx])=0</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>availability</value></tag></tags></trigger></triggers></item><item><uuid>9e2be446ac79491c8be1bcd789392066</uuid><name>Nginx: Connections accepted per second</name><type>DEPENDENT</type><key>nginx.connections.accepted.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The total number of accepted client connections.</description><preprocessing><step><type>REGEX</type><parameters><parameter>server accepts handled requests\s+([0-9]+) ([0-9]+) ([0-9]+)</parameter><parameter>\1</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PATH}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags></item><item><uuid>436f2dc87cda418eb8f19ed6910c7bd0</uuid><name>Nginx: Connections active</name><type>DEPENDENT</type><key>nginx.connections.active</key><delay>0</delay><history>7d</history><description>The current number of active client connections including Waiting connections.</description><preprocessing><step><type>REGEX</type><parameters><parameter>Active connections: ([0-9]+)</parameter><parameter>\1</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PATH}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags></item><item><uuid>4027e6db5e024aff98056faa2d4b43cd</uuid><name>Nginx: Connections dropped per second</name><type>DEPENDENT</type><key>nginx.connections.dropped.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The total number of dropped client connections.</description><preprocessing><step><type>JAVASCRIPT</type><parameters><parameter>var a = value.match(/server accepts handled requests\s+([0-9]+) ([0-9]+) ([0-9]+)/)
if (a) {
    return a[1]-a[2]
}</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PATH}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags><triggers><trigger><uuid>f2d431fa9bc446608caa3f80ef27c41b</uuid><expression>min(/Nginx by Zabbix agent/nginx.connections.dropped.rate,5m) &gt; {$NGINX.DROP_RATE.MAX.WARN}</expression><name>Nginx: High connections drop rate</name><event_name>Nginx: High connections drop rate (more than {$NGINX.DROP_RATE.MAX.WARN} for 5m)</event_name><opdata>Current rate: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><description>The dropping rate connections is greater than {$NGINX.DROP_RATE.MAX.WARN} for the last 5 minutes.</description><dependencies><dependency><name>Nginx: Process is not running</name><expression>last(/Nginx by Zabbix agent/proc.num[nginx])=0</expression></dependency><dependency><name>Nginx: Service is down</name><expression>last(/Nginx by Zabbix agent/net.tcp.service[http,&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;])=0</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>performance</value></tag></tags></trigger></triggers></item><item><uuid>06191636a7104e1bb40d197493b80958</uuid><name>Nginx: Connections handled per second</name><type>DEPENDENT</type><key>nginx.connections.handled.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The total number of handled connections. Generally, the parameter value is the same as accepts unless some resource limits have been reached (for example, the worker_connections limit).</description><preprocessing><step><type>REGEX</type><parameters><parameter>server accepts handled requests\s+([0-9]+) ([0-9]+) ([0-9]+)</parameter><parameter>\2</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PATH}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags></item><item><uuid>f5925c78389143c7924432483a5c716c</uuid><name>Nginx: Connections reading</name><type>DEPENDENT</type><key>nginx.connections.reading</key><delay>0</delay><history>7d</history><description>The current number of connections where nginx is reading the request header.</description><preprocessing><step><type>REGEX</type><parameters><parameter>Reading: ([0-9]+) Writing: ([0-9]+) Waiting: ([0-9]+)</parameter><parameter>\1</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PATH}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags></item><item><uuid>d6cfa828ba344ffe948d8d985b849316</uuid><name>Nginx: Connections waiting</name><type>DEPENDENT</type><key>nginx.connections.waiting</key><delay>0</delay><history>7d</history><description>The current number of idle client connections waiting for a request.</description><preprocessing><step><type>REGEX</type><parameters><parameter>Reading: ([0-9]+) Writing: ([0-9]+) Waiting: ([0-9]+)</parameter><parameter>\3</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PATH}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags></item><item><uuid>c038a572f73f4a418ddcc5aeb8b0a547</uuid><name>Nginx: Connections writing</name><type>DEPENDENT</type><key>nginx.connections.writing</key><delay>0</delay><history>7d</history><description>The current number of connections where nginx is writing the response back to the client.</description><preprocessing><step><type>REGEX</type><parameters><parameter>Reading: ([0-9]+) Writing: ([0-9]+) Waiting: ([0-9]+)</parameter><parameter>\2</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PATH}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags></item><item><uuid>b28444fb9b834d03a72036882c80b921</uuid><name>Nginx: Requests total</name><type>DEPENDENT</type><key>nginx.requests.total</key><delay>0</delay><history>7d</history><description>The total number of client requests.</description><preprocessing><step><type>REGEX</type><parameters><parameter>server accepts handled requests\s+([0-9]+) ([0-9]+) ([0-9]+)</parameter><parameter>\3</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PATH}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>requests</value></tag></tags></item><item><uuid>2600a696278f490f86cadd8c8836f269</uuid><name>Nginx: Requests per second</name><type>DEPENDENT</type><key>nginx.requests.total.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The total number of client requests.</description><preprocessing><step><type>REGEX</type><parameters><parameter>server accepts handled requests\s+([0-9]+) ([0-9]+) ([0-9]+)</parameter><parameter>\3</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PATH}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>requests</value></tag></tags></item><item><uuid>3dcc81006977478f92be6dd040d66eb5</uuid><name>Nginx: Version</name><type>DEPENDENT</type><key>nginx.version</key><delay>0</delay><history>7d</history><trends>0</trends><value_type>CHAR</value_type><preprocessing><step><type>REGEX</type><parameters><parameter>Server: nginx\/(.+(?&lt;!\r))</parameter><parameter>\1</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1d</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PATH}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>application</value></tag></tags><triggers><trigger><uuid>7ad80c508f2f48b59f7659c673db9f36</uuid><expression>last(/Nginx by Zabbix agent/nginx.version,#1)&lt;&gt;last(/Nginx by Zabbix agent/nginx.version,#2) and length(last(/Nginx by Zabbix agent/nginx.version))&gt;0</expression><name>Nginx: Version has changed</name><event_name>Nginx: Version has changed (new version: {ITEM.VALUE})</event_name><priority>INFO</priority><description>Nginx version has changed. Ack to close.</description><manual_close>YES</manual_close><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>84c95c1955bf4ccaa12a060a9acdb478</uuid><name>Nginx: CPU utilization</name><key>proc.cpu.util[nginx]</key><history>7d</history><value_type>FLOAT</value_type><units>%</units><description>Process CPU utilization percentage.</description><tags><tag><tag>component</tag><value>cpu</value></tag></tags></item><item><uuid>64d208475c034bae953a64cde1833ebb</uuid><name>Nginx: Memory usage (rss)</name><key>proc.mem[nginx,,,,rss]</key><history>7d</history><units>B</units><description>Resident set size memory used by process in bytes.</description><tags><tag><tag>component</tag><value>memory</value></tag></tags></item><item><uuid>21fccb0286fb407c85f1972e994c698e</uuid><name>Nginx: Memory usage (vsize)</name><key>proc.mem[nginx,,,,vsize]</key><history>7d</history><units>B</units><description>Virtual memory size used by process in bytes.</description><tags><tag><tag>component</tag><value>memory</value></tag></tags></item><item><uuid>ba3da6baccee4b31947bf20d3cae0e5f</uuid><name>Nginx: Number of processes running</name><key>proc.num[nginx]</key><history>7d</history><description>Number of the Nginx processes running.</description><tags><tag><tag>component</tag><value>system</value></tag></tags><triggers><trigger><uuid>903e6a1f30154ee49df3f8d87e0164cc</uuid><expression>last(/Nginx by Zabbix agent/proc.num[nginx])=0</expression><name>Nginx: Process is not running</name><priority>HIGH</priority><tags><tag><tag>scope</tag><value>availability</value></tag></tags></trigger></triggers></item><item><uuid>52a23a9f6d60490c8f5565b938154f61</uuid><name>Nginx: Get stub status page</name><key>web.page.get[&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PATH}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;]</key><history>1h</history><trends>0</trends><value_type>TEXT</value_type><description>The following status information is provided:
Active connections - the current number of active client connections including Waiting connections.
Accepts - the total number of accepted client connections.
Handled - the total number of handled connections. Generally, the parameter value is the same as accepts unless some resource limits have been reached (for example, the worker_connections limit).
Requests - the total number of client requests.
Reading - the current number of connections where nginx is reading the request header.
Writing - the current number of connections where nginx is writing the response back to the client.
Waiting - the current number of idle client connections waiting for a request.
https://nginx.org/en/docs/http/ngx_http_stub_status_module.html</description><tags><tag><tag>component</tag><value>application</value></tag><tag><tag>component</tag><value>health</value></tag></tags><triggers><trigger><uuid>a497b80eb03f469c9552881b498003b2</uuid><expression>find(/Nginx by Zabbix agent/web.page.get[&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PATH}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;],,&quot;like&quot;,&quot;HTTP/1.1 200&quot;)=0 or
 nodata(/Nginx by Zabbix agent/web.page.get[&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PATH}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;],30m)=1</expression><name>Nginx: Failed to fetch stub status page</name><event_name>Nginx: Failed to fetch stub status page (or no data for 30m)</event_name><priority>WARNING</priority><description>Zabbix has not received data for items for the last 30 minutes.</description><manual_close>YES</manual_close><dependencies><dependency><name>Nginx: Process is not running</name><expression>last(/Nginx by Zabbix agent/proc.num[nginx])=0</expression></dependency><dependency><name>Nginx: Service is down</name><expression>last(/Nginx by Zabbix agent/net.tcp.service[http,&quot;{$NGINX.STUB_STATUS.HOST}&quot;,&quot;{$NGINX.STUB_STATUS.PORT}&quot;])=0</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>availability</value></tag></tags></trigger></triggers></item></items><tags><tag><tag>class</tag><value>software</value></tag><tag><tag>target</tag><value>nginx</value></tag></tags><macros><macro><macro>{$NGINX.DROP_RATE.MAX.WARN}</macro><value>1</value><description>The critical rate of the dropped connections for trigger expression.</description></macro><macro><macro>{$NGINX.RESPONSE_TIME.MAX.WARN}</macro><value>10</value><description>The Nginx maximum response time in seconds for trigger expression.</description></macro><macro><macro>{$NGINX.STUB_STATUS.HOST}</macro><value>localhost</value><description>Hostname or IP of Nginx stub_status host or container.</description></macro><macro><macro>{$NGINX.STUB_STATUS.PATH}</macro><value>basic_status</value><description>The path of Nginx stub_status page.</description></macro><macro><macro>{$NGINX.STUB_STATUS.PORT}</macro><value>80</value><description>The port of Nginx stub_status host or container.</description></macro></macros><dashboards><dashboard><uuid>9d071e3a148c405e85c53ef25d54efaf</uuid><name>Nginx performance</name><pages><page><widgets><widget><type>GRAPH_CLASSIC</type><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>0</value></field><field><type>GRAPH</type><name>graphid</name><value><host>Nginx by Zabbix agent</host><name>Nginx: Connections by state</name></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><x>12</x><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>0</value></field><field><type>GRAPH</type><name>graphid</name><value><host>Nginx by Zabbix agent</host><name>Nginx: Requests per second</name></value></field></fields></widget><widget><type>GRAPH_CLASSIC</type><y>5</y><width>12</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>0</value></field><field><type>GRAPH</type><name>graphid</name><value><host>Nginx by Zabbix agent</host><name>Nginx: Connections per second</name></value></field></fields></widget></widgets></page></pages></dashboard></dashboards><valuemaps><valuemap><uuid>53c8528c18814f30a45d1540ab9e5c00</uuid><name>Service state</name><mappings><mapping><value>0</value><newvalue>Down</newvalue></mapping><mapping><value>1</value><newvalue>Up</newvalue></mapping></mappings></valuemap></valuemaps></template></templates><graphs><graph><uuid>ba234158aeca468a8592d944f9aae691</uuid><name>Nginx: Connections by state</name><graph_items><graph_item><drawtype>BOLD_LINE</drawtype><color>1A7C11</color><item><host>Nginx by Zabbix agent</host><key>nginx.connections.active</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>Nginx by Zabbix agent</host><key>nginx.connections.waiting</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>Nginx by Zabbix agent</host><key>nginx.connections.writing</key></item></graph_item><graph_item><sortorder>3</sortorder><color>A54F10</color><item><host>Nginx by Zabbix agent</host><key>nginx.connections.reading</key></item></graph_item></graph_items></graph><graph><uuid>b82a5b89864a47638421458f3e74563d</uuid><name>Nginx: Connections per second</name><graph_items><graph_item><color>1A7C11</color><item><host>Nginx by Zabbix agent</host><key>nginx.connections.accepted.rate</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>Nginx by Zabbix agent</host><key>nginx.connections.handled.rate</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>Nginx by Zabbix agent</host><key>nginx.connections.dropped.rate</key></item></graph_item></graph_items></graph><graph><uuid>69ca908afa1d468d983a263d06910925</uuid><name>Nginx: Memory usage</name><graph_items><graph_item><color>1A7C11</color><item><host>Nginx by Zabbix agent</host><key>proc.mem[nginx,,,,vsize]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>Nginx by Zabbix agent</host><key>proc.mem[nginx,,,,rss]</key></item></graph_item></graph_items></graph><graph><uuid>a2d2fec823514df09731381304c245e9</uuid><name>Nginx: Requests per second</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>Nginx by Zabbix agent</host><key>nginx.requests.total.rate</key></item></graph_item></graph_items></graph></graphs></zabbix_export>
