<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>6.0</version><date>2023-02-11T16:14:50Z</date><groups><group><uuid>36bff6c29af64692839d077febfc7079</uuid><name>Templates/Network devices</name></group></groups><templates><template><uuid>24bed6339f0a492fab86fe757394b937</uuid><template>Morningstar ProStar PWM by SNMP</template><name>Morningstar ProStar PWM by SNMP</name><description>MIBs used:
PROSTAR-PWM

Template tooling version used: 0.41</description><groups><group><name>Templates/Network devices</name></group></groups><items><item><uuid>953fb8b3c23f420bb6132874ce3e33e2</uuid><name>Array: Voltage</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.31.0</snmp_oid><key>array.voltage[arrayVoltage.0]</key><history>7d</history><value_type>FLOAT</value_type><units>V</units><description>MIB: PROSTAR-PWM
Description:Array Voltage
Scaling Factor:1.0
Units:V
Range:[0, 80]
Modbus address:0x0013</description><tags><tag><tag>component</tag><value>array</value></tag></tags></item><item><uuid>a80ad3ace9b14446bc5fd5d6aaa5af87</uuid><name>Battery: Battery Voltage discovery</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.30.0</snmp_oid><key>battery.voltage.discovery[batteryTerminalVoltage.0]</key><delay>15m</delay><history>0</history><value_type>FLOAT</value_type><units>V</units><description>MIB: PROSTAR-PWM</description><tags><tag><tag>component</tag><value>battery</value></tag><tag><tag>component</tag><value>discovery</value></tag><tag><tag>component</tag><value>raw</value></tag></tags></item><item><uuid>148008b117c94155ba81600e3050ab25</uuid><name>Battery: Charge Current</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.33.0</snmp_oid><key>charge.current[chargeCurrent.0]</key><history>7d</history><value_type>FLOAT</value_type><units>A</units><description>MIB: PROSTAR-PWM
Description:Charge Current
Scaling Factor:1.0
Units:A
Range:[0, 40]
Modbus address:0x0011</description><tags><tag><tag>component</tag><value>battery</value></tag></tags></item><item><uuid>a7ae2d3b911e4bb5a7eeb770470245a5</uuid><name>Battery: Charge State</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.45.0</snmp_oid><key>charge.state[chargeState.0]</key><history>7d</history><value_type>FLOAT</value_type><description>MIB: PROSTAR-PWM
Description:Control State
Modbus address:0x0021

0: Start
1: NightCheck
2: Disconnect
3: Night
4: Fault
5: Bulk
6: Pwm
7: Float
8: Equalize</description><valuemap><name>ProStar PWM charge state</name></valuemap><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>battery</value></tag></tags><triggers><trigger><uuid>f12fc2c1a7a142a287304c18bafa1181</uuid><expression>last(/Morningstar ProStar PWM by SNMP/charge.state[chargeState.0])={$CHARGE.STATE.CRIT}</expression><name>Battery: Device charge in critical state</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>adf8cf02aa1e42fa84e1f11ddae4df01</uuid><expression>last(/Morningstar ProStar PWM by SNMP/charge.state[chargeState.0])={$CHARGE.STATE.WARN}</expression><name>Battery: Device charge in warning state</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><dependencies><dependency><name>Battery: Device charge in critical state</name><expression>last(/Morningstar ProStar PWM by SNMP/charge.state[chargeState.0])={$CHARGE.STATE.CRIT}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>8acd2e7944694a828cf9b739b75513d9</uuid><name>Counter: Charge Amp-hours</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.49.0</snmp_oid><key>counter.charge_amp_hours[ahChargeResettable.0]</key><history>7d</history><value_type>FLOAT</value_type><units>Ah</units><description>MIB: PROSTAR-PWM
Description:Ah Charge (Resettable)
Scaling Factor:0.1
Units:Ah
Range:[0.0, 4294967294]
Modbus addresses:H=0x0026 L=0x0027</description><preprocessing><step><type>MULTIPLIER</type><parameters><parameter>0.1</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>counter</value></tag></tags></item><item><uuid>0e7124df3f2b4298b1a13576d0b2d5e7</uuid><name>Counter: Charge KW-hours</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.51.0</snmp_oid><key>counter.charge_kw_hours[kwhChargeResettable.0]</key><history>7d</history><value_type>FLOAT</value_type><units>!kWh</units><description>MIB: PROSTAR-PWM
Description:Kilowatt Hours Charge (Resettable)
Scaling Factor:1.0
Units:kWh
Range:[0.0, 65535]
Modbus address:0x002A</description><tags><tag><tag>component</tag><value>counter</value></tag></tags></item><item><uuid>104a7db1c27d40b3bbee506f7f922393</uuid><name>Counter: Load Amp-hours</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.56.0</snmp_oid><key>counter.load_amp_hours[ahLoadResettable.0]</key><history>7d</history><value_type>FLOAT</value_type><units>Ah</units><description>MIB: PROSTAR-PWM
Description:Ah Load (Resettable)
Scaling Factor:0.1
Units:Ah
Range:[0.0, 4294967294]
Modbus addresses:H=0x0032 L=0x0033</description><preprocessing><step><type>MULTIPLIER</type><parameters><parameter>0.1</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>counter</value></tag></tags></item><item><uuid>dcade8607cf142a2b88333f9880448fc</uuid><name>Load: Current</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.34.0</snmp_oid><key>load.current[loadCurrent.0]</key><history>7d</history><value_type>FLOAT</value_type><units>A</units><description>MIB: PROSTAR-PWM
Description:Load Current
Scaling Factor:1.0
Units:A
Range:[0, 60]
Modbus address:0x0016</description><tags><tag><tag>component</tag><value>load</value></tag></tags></item><item><uuid>14b3ca3869374f54a467e5e9017f918a</uuid><name>Load: State</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.53.0</snmp_oid><key>load.state[loadState.0]</key><history>7d</history><value_type>FLOAT</value_type><description>MIB: PROSTAR-PWM
Description:Load State
Modbus address:0x002E

0: Start
1: Normal
2: LvdWarning
3: Lvd
4: Fault
5: Disconnect
6: NormalOff
7: Override
8: NotUsed</description><valuemap><name>ProStar PWM load state</name></valuemap><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>load</value></tag></tags><triggers><trigger><uuid>7a8bf4420b6b48ab8a5bc999eecae760</uuid><expression>last(/Morningstar ProStar PWM by SNMP/load.state[loadState.0])={$LOAD.STATE.CRIT:&quot;lvd&quot;} or last(/Morningstar ProStar PWM by SNMP/load.state[loadState.0])={$LOAD.STATE.CRIT:&quot;fault&quot;}</expression><name>Load: Device load in critical state</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>5152f9cd4ee34be485f3cb0a0f60afd5</uuid><expression>last(/Morningstar ProStar PWM by SNMP/load.state[loadState.0])={$LOAD.STATE.WARN:&quot;lvdWarning&quot;}  or last(/Morningstar ProStar PWM by SNMP/load.state[loadState.0])={$LOAD.STATE.WARN:&quot;override&quot;}</expression><name>Load: Device load in warning state</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><dependencies><dependency><name>Load: Device load in critical state</name><expression>last(/Morningstar ProStar PWM by SNMP/load.state[loadState.0])={$LOAD.STATE.CRIT:&quot;lvd&quot;} or last(/Morningstar ProStar PWM by SNMP/load.state[loadState.0])={$LOAD.STATE.CRIT:&quot;fault&quot;}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>cccc0976a62b47b1a558d521704c125d</uuid><name>Load: Voltage</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.32.0</snmp_oid><key>load.voltage[loadVoltage.0]</key><history>7d</history><value_type>FLOAT</value_type><units>V</units><description>MIB: PROSTAR-PWM
Description:Load Voltage
Scaling Factor:1.0
Units:V
Range:[0, 80]
Modbus address:0x0014</description><tags><tag><tag>component</tag><value>load</value></tag></tags></item><item><uuid>7c1c1e03425c4b4bb176cf45458b916a</uuid><name>Status: Alarms</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.59.0</snmp_oid><key>status.alarms[alarms.0]</key><history>1h</history><trends>0</trends><value_type>TEXT</value_type><description>MIB: PROSTAR-PWM
Description:Alarms
Modbus addresses:H=0x0038 L=0x0039</description><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step><step><type>JAVASCRIPT</type><parameters><parameter>var FIELDS = [
  'rtsOpen',
  'rtsShorted',
  'rtsDisconnected',
  'heatsinkTempSensorOpen',
  'heatsinkTempSensorShorted',
  'heatsinkTempLimit',
  'currentLimit',
  'currentMeasurementError',
  'batterySenseOutOfRange',
  'batterySenseDisconnected',
  'uncalibrated',
  'batteryTempOutOfRange',
  'fp10SupplyOutOfRange',
  'mosfetOpen',
  'arrayCurrentOffset',
  'loadCurrentOffset',
  'p33SupplyOutOfRange',
  'p12SupplyOutOfRange',
  'hightInputVoltageLimit',
  'controllerReset',
  'loadLvd',
  'logTimeout',
  'eepromAccessFailure'
];

var flags = parseInt(value.replace(/\x20/g, ''), 16),
  result = [];

for (var i = 0, f = 1 &lt;&lt; 31 &gt;&gt;&gt; 0, l = FIELDS.length; i &lt; l; i++, f &gt;&gt;&gt;= 1) {
    if (flags &amp; f) {
        result.push(FIELDS[i]);
    }
}

return result.length ? result.join('\n') : 'No alarms';</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>status</value></tag></tags><triggers><trigger><uuid>67fd46f034c3486e9af3cabfc5dc8056</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;arrayCurrentOffset&quot;)=2</expression><name>Status: Device has &quot;arrayCurrentOffset&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>31cc0b05b83045de80a7d07f26545010</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;batterySenseDisconnected&quot;)=2</expression><name>Status: Device has &quot;batterySenseDisconnected&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>9e498d21bc7f4ca1937f1628f4b1ea55</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;batterySenseOutOfRange&quot;)=2</expression><name>Status: Device has &quot;batterySenseOutOfRange&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>8a09c7609f9a45cea5b217757a7d2e5e</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;batteryTempOutOfRange&quot;)=2</expression><name>Status: Device has &quot;batteryTempOutOfRange&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>b173b8ca12f8464aae6476009b4c89e8</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;controllerReset&quot;)=2</expression><name>Status: Device has &quot;controllerReset&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>cdbac88810ff49caa35771e661d8b312</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;currentLimit&quot;)=2</expression><name>Status: Device has &quot;currentLimit&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>7758388df28d4540ba393f4423fef00a</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;currentMeasurementError&quot;)=2</expression><name>Status: Device has &quot;currentMeasurementError&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>a56fef1f61c44ba884ec448b0d306c1d</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;eepromAccessFailure&quot;)=2</expression><name>Status: Device has &quot;eepromAccessFailure&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>fefea5daa03d453c8c5148ddb39997f9</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;fp10SupplyOutOfRange&quot;)=2</expression><name>Status: Device has &quot;fp10SupplyOutOfRange&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>c252c82aff2a4ac680965115cb2fab64</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;heatsinkTempLimit&quot;)=2</expression><name>Status: Device has &quot;heatsinkTempLimit&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>5b93a0a09a62481d8096ec743c2ceaff</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;heatsinkTempSensorOpen&quot;)=2</expression><name>Status: Device has &quot;heatsinkTempSensorOpen&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>f28e5143a238470ba93c1345c814f87d</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;heatsinkTempSensorShorted&quot;)=2</expression><name>Status: Device has &quot;heatsinkTempSensorShorted&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>75c84ef378984fca854b34a8ef79668c</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;hightInputVoltageLimit&quot;)=2</expression><name>Status: Device has &quot;hightInputVoltageLimit&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>5c1551f7e2be40e0b8b50ed263f8e293</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;loadCurrentOffset&quot;)=2</expression><name>Status: Device has &quot;loadCurrentOffset&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>665117c5b9b64ea09a1d661e9c40fc43</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;loadLvd&quot;)=2</expression><name>Status: Device has &quot;loadLvd&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>b89c002c859c419ea748b43d575e9e27</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;logTimeout&quot;)=2</expression><name>Status: Device has &quot;logTimeout&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>17f51e7b248b4e63934e8b529b85b2ef</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;mosfetOpen&quot;)=2</expression><name>Status: Device has &quot;mosfetOpen&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>75e23772250741d0b1fc1ddff2a72ef6</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;p12SupplyOutOfRange&quot;)=2</expression><name>Status: Device has &quot;p12SupplyOutOfRange&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>fc374c9ac9fa4f979fbff9f7c7d83565</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;p33SupplyOutOfRange&quot;)=2</expression><name>Status: Device has &quot;p33SupplyOutOfRange&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>fbec2a1fdbe54d8da352471acf67bad1</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;rtsDisconnected&quot;)=2</expression><name>Status: Device has &quot;rtsDisconnected&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>915da6e7b1cd410da9a6c68e3b4abd85</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;rtsShorted&quot;)=2</expression><name>Status: Device has &quot;rtsShorted&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>e8bf2213a5444e2c9923b6f093d43f75</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;uncalibrated&quot;)=2</expression><name>Status: Device has &quot;uncalibrated&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>2517d96e51c14372a0336c9a6ed5d078</uuid><name>Status: Array Faults</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.46.0</snmp_oid><key>status.array_faults[arrayFaults.0]</key><history>1h</history><trends>0</trends><value_type>TEXT</value_type><description>MIB: PROSTAR-PWM
Description:Array Faults
Modbus address:0x0022</description><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step><step><type>JAVASCRIPT</type><parameters><parameter>var FIELDS = [
  'overcurrent',
  'mosfetSShorted',
  'software',
  'batteryHvd',
  'arrayHvd',
  'customSettingsEdit',
  'rtsShorted',
  'rtsNoLongerValid',
  'localTempSensorDamaged',
  'batteryLowVoltageDisconnect',
  'slaveTimeout',
  'dipSwitchChanged',
  'p3Fault',
];

var flags = parseInt(value.replace(/\x20/g, ''), 16),
  result = [];

for (var i = 0, f = 1 &lt;&lt; 31 &gt;&gt;&gt; 0, l = FIELDS.length; i &lt; l; i++, f &gt;&gt;&gt;= 1) {
    if (flags &amp; f) {
        result.push(FIELDS[i]);
    }
}

return result.length ? result.join('\n') : 'No faults';</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>status</value></tag></tags><triggers><trigger><uuid>b2ff69793e124031a79a668b03678fac</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;arrayHvd&quot;)=2</expression><name>Status: Device has &quot;arrayHvd&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>a4ca36ccaa9d45ceb79303afef1c49f0</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;batteryHvd&quot;)=2</expression><name>Status: Device has &quot;batteryHvd&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>f4d1120afb13456b9d45f8795dbc30b7</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;batteryLowVoltageDisconnect&quot;)=2</expression><name>Status: Device has &quot;batteryLowVoltageDisconnect&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>9e5f2c575945458ea8a39f33cb23b833</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;customSettingsEdit&quot;)=2</expression><name>Status: Device has &quot;customSettingsEdit&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>fd904f4469324784ac2c469e64069f94</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;dipSwitchChanged&quot;)=2</expression><name>Status: Device has &quot;dipSwitchChanged&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>62076ce0967049c8bde39f71afcb85d9</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;localTempSensorDamaged&quot;)=2</expression><name>Status: Device has &quot;localTempSensorDamaged&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>ea8487afe1c14bc08f3d9fd7f75d208f</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;mosfetSShorted&quot;)=2</expression><name>Status: Device has &quot;mosfetSShorted&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>b0bb139541ae493bafc40dac9074d898</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;overcurrent&quot;)=2</expression><name>Status: Device has &quot;overcurrent&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>8af94d7ff1a84e18b10122b0e3743d45</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;p3Fault&quot;)=2</expression><name>Status: Device has &quot;p3Fault&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>b41cb2e05acb40f59efa50a25f66cd62</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;rtsNoLongerValid&quot;)=2</expression><name>Status: Device has &quot;rtsNoLongerValid&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>d99c3f126c7e480cb4fcc705349eb61d</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;rtsShorted&quot;)=2</expression><name>Status: Device has &quot;rtsShorted&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>711b28f19cb74c0faeef73263ca1fb8f</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;slaveTimeout&quot;)=2</expression><name>Status: Device has &quot;slaveTimeout&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>e4a261d750d546c7b5d5067dd9a0ec25</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.array_faults[arrayFaults.0],#3,&quot;like&quot;,&quot;software&quot;)=2</expression><name>Status: Device has &quot;software&quot; array faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>2c9f864ac33b4c2d992459c6519d045a</uuid><name>Status: Uptime (hardware)</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.2.1.25.1.1.0</snmp_oid><key>status.hw.uptime</key><history>7d</history><units>uptime</units><description>The amount of time since this host was last initialized. Note that this is different from sysUpTime in the SNMPv2-MIB [RFC1907] because sysUpTime is the uptime of the network management portion of the system.</description><preprocessing><step><type>CHECK_NOT_SUPPORTED</type><parameters><parameter/></parameters><error_handler>CUSTOM_VALUE</error_handler><error_handler_params>0</error_handler_params></step><step><type>MULTIPLIER</type><parameters><parameter>0.01</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>status</value></tag></tags></item><item><uuid>1cd47d04af104cb9ab1cd7dc745a6aea</uuid><name>Status: Load Faults</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.54.0</snmp_oid><key>status.load_faults[loadFaults.0]</key><history>1h</history><trends>0</trends><value_type>TEXT</value_type><description>MIB: PROSTAR-PWM
Description:Load Faults
Modbus address:0x002F</description><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step><step><type>JAVASCRIPT</type><parameters><parameter>var FIELDS = [
  'externalShortCircuit',
  'overcurrent',
  'mosfetShorted',
  'software',
  'loadHvd',
  'highTempDisconnect',
  'dipSwitchChanged',
  'customSettingsEdit',
  'p3Fault'
];

var flags = parseInt(value.replace(/\x20/g, ''), 16),
  result = [];

for (var i = 0, f = 1 &lt;&lt; 31 &gt;&gt;&gt; 0, l = FIELDS.length; i &lt; l; i++, f &gt;&gt;&gt;= 1) {
    if (flags &amp; f) {
        result.push(FIELDS[i]);
    }
}

return result.length ? result.join('\n') : 'No faults';</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>status</value></tag></tags><triggers><trigger><uuid>99ab5f0d3014459a8cd7d137d3a1f688</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.load_faults[loadFaults.0],#3,&quot;like&quot;,&quot;customSettingsEdit&quot;)=2</expression><name>Status: Device has &quot;customSettingsEdit&quot; load faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>77752192092f4f1caceef19c3c164b72</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.load_faults[loadFaults.0],#3,&quot;like&quot;,&quot;dipSwitchChanged&quot;)=2</expression><name>Status: Device has &quot;dipSwitchChanged&quot; load faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>d2e55501d89844aeb47f7887a11754a9</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.load_faults[loadFaults.0],#3,&quot;like&quot;,&quot;externalShortCircuit&quot;)=2</expression><name>Status: Device has &quot;externalShortCircuit&quot; load faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>a6548502cfc4406098ba3129af8efcb5</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.load_faults[loadFaults.0],#3,&quot;like&quot;,&quot;highTempDisconnect&quot;)=2</expression><name>Status: Device has &quot;highTempDisconnect&quot; load faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>6e8f0127bc7b42dea9d867ab174f458c</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.load_faults[loadFaults.0],#3,&quot;like&quot;,&quot;loadHvd&quot;)=2</expression><name>Status: Device has &quot;loadHvd&quot; load faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>2a303d4712e244a9b051fb1b0247fac5</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.load_faults[loadFaults.0],#3,&quot;like&quot;,&quot;mosfetShorted&quot;)=2</expression><name>Status: Device has &quot;mosfetShorted&quot; load faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>5720e2e15e5f42099fd7de361f62c99a</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.load_faults[loadFaults.0],#3,&quot;like&quot;,&quot;overcurrent&quot;)=2</expression><name>Status: Device has &quot;overcurrent&quot; load faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>2f522d50a8124ed2a8af4d7b6417c31c</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.load_faults[loadFaults.0],#3,&quot;like&quot;,&quot;p3Fault&quot;)=2</expression><name>Status: Device has &quot;p3Fault&quot; load faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>e75abe852b9c4e1d91a1f8f83622ef64</uuid><expression>count(/Morningstar ProStar PWM by SNMP/status.load_faults[loadFaults.0],#3,&quot;like&quot;,&quot;software&quot;)=2</expression><name>Status: Device has &quot;software&quot; load faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>42f6a75d923d4262b37d85c4f7d1d322</uuid><name>Status: Uptime (network)</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.2.1.1.3.0</snmp_oid><key>status.net.uptime</key><history>7d</history><units>uptime</units><description>The time (in hundredths of a second) since the network management portion of the system was last re-initialized.</description><preprocessing><step><type>MULTIPLIER</type><parameters><parameter>0.01</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>status</value></tag></tags><triggers><trigger><uuid>16c1444a745a47e59fd22bd1a64baef3</uuid><expression>nodata(/Morningstar ProStar PWM by SNMP/status.net.uptime,5m)=1</expression><name>Status: Failed to fetch data</name><event_name>Status: Failed to fetch data (or no data for 5m)</event_name><priority>WARNING</priority><description>Zabbix has not received data for items for the last 5 minutes.</description><manual_close>YES</manual_close><tags><tag><tag>scope</tag><value>availability</value></tag></tags></trigger></triggers></item><item><uuid>f4b7bfb000754a17b4719863d3755519</uuid><name>Battery: Target Voltage</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.48.0</snmp_oid><key>target.voltage[targetVoltage.0]</key><history>7d</history><value_type>FLOAT</value_type><units>V</units><description>MIB: PROSTAR-PWM
Description:Target Regulation Voltage
Scaling Factor:1.0
Units:V
Range:[0.0, 80.0]
Modbus address:0x0024</description><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>battery</value></tag></tags></item><item><uuid>13d3479a7b5940b5a53d5f13bea9e2d1</uuid><name>Temperature: Ambient</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.40.0</snmp_oid><key>temp.ambient[ambientTemperature.0]</key><history>7d</history><value_type>FLOAT</value_type><units>C</units><description>MIB: PROSTAR-PWM
Description:Ambient Temperature
Scaling Factor:1.0
Units:deg C
Range:[-128, 127]
Modbus address:0x001C</description><tags><tag><tag>component</tag><value>temperature</value></tag></tags></item><item><uuid>39763f7fccd94aefb720a34871c0962b</uuid><name>Temperature: Battery</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.39.0</snmp_oid><key>temp.battery[batteryTemperature.0]</key><history>7d</history><value_type>FLOAT</value_type><units>C</units><description>MIB: PROSTAR-PWM
Description:Battery Temperature
Scaling Factor:1.0
Units:deg C
Range:[-128, 127]
Modbus address:0x001B</description><tags><tag><tag>component</tag><value>temperature</value></tag></tags><triggers><trigger><uuid>46eb3a0e80294a4db8324d56337ed712</uuid><expression>min(/Morningstar ProStar PWM by SNMP/temp.battery[batteryTemperature.0],5m)&gt;{$BATTERY.TEMP.MAX.CRIT}</expression><name>Temperature: Critically high battery temperature</name><event_name>Temperature: Critically high battery temperature (over {$BATTERY.TEMP.MAX.CRIT}C for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>c3f3ba5b2cab4481bb62fa8527554e96</uuid><expression>max(/Morningstar ProStar PWM by SNMP/temp.battery[batteryTemperature.0],5m)&lt;{$BATTERY.TEMP.MIN.CRIT}</expression><name>Temperature: Critically low battery temperature</name><event_name>Temperature: Critically low battery temperature (below {$BATTERY.TEMP.MIN.WARN}C for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>80aaf1de029b4d6eadce9f2a946f6dde</uuid><expression>min(/Morningstar ProStar PWM by SNMP/temp.battery[batteryTemperature.0],5m)&gt;{$BATTERY.TEMP.MAX.WARN}</expression><name>Temperature: High battery temperature</name><event_name>Temperature: High battery temperature (over {$BATTERY.TEMP.MAX.WARN}C for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><dependencies><dependency><name>Temperature: Critically high battery temperature</name><expression>min(/Morningstar ProStar PWM by SNMP/temp.battery[batteryTemperature.0],5m)&gt;{$BATTERY.TEMP.MAX.CRIT}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>cf1db336ea124f9a9fd6eb367f93f0e8</uuid><expression>max(/Morningstar ProStar PWM by SNMP/temp.battery[batteryTemperature.0],5m)&lt;{$BATTERY.TEMP.MIN.WARN}</expression><name>Temperature: Low battery temperature</name><event_name>Temperature: Low battery temperature (below {$BATTERY.TEMP.MIN.WARN}C for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><dependencies><dependency><name>Temperature: Critically low battery temperature</name><expression>max(/Morningstar ProStar PWM by SNMP/temp.battery[batteryTemperature.0],5m)&lt;{$BATTERY.TEMP.MIN.CRIT}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>1d13bd3ea24a4fcab3cd5b7586e6033a</uuid><name>Temperature: Heatsink</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.38.0</snmp_oid><key>temp.heatsink[heatsinkTemperature.0]</key><history>7d</history><value_type>FLOAT</value_type><units>C</units><description>MIB: PROSTAR-PWM
Description:Heatsink Temperature
Scaling Factor:1.0
Units:deg C
Range:[-128, 127]
Modbus address:0x001A</description><tags><tag><tag>component</tag><value>temperature</value></tag></tags></item></items><discovery_rules><discovery_rule><uuid>17148797def9484ba26b0afdcc44bfd5</uuid><name>Battery voltage discovery</name><type>DEPENDENT</type><key>battery.voltage.discovery</key><delay>0</delay><description>Discovery for battery voltage triggers</description><item_prototypes><item_prototype><uuid>6e4ed5ae449c48eeb328d30b76d083a2</uuid><name>Battery: Voltage{#SINGLETON}</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.6.30.0</snmp_oid><key>battery.voltage[batteryTerminalVoltage.0{#SINGLETON}]</key><history>7d</history><value_type>FLOAT</value_type><units>V</units><description>MIB: PROSTAR-PWM
Description:Control State
Modbus address:0x0021</description><tags><tag><tag>component</tag><value>battery</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>e89cf2b8066840c2876642f0d8db1edd</uuid><expression>min(/Morningstar ProStar PWM by SNMP/battery.voltage[batteryTerminalVoltage.0{#SINGLETON}],5m)&gt;{#VOLTAGE.MAX.CRIT}</expression><name>Battery: Critically high battery voltage</name><event_name>Battery: Critically high battery voltage (over {#VOLTAGE.MAX.CRIT}V for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger_prototype><trigger_prototype><uuid>8356aba9afb242b09902873a5f0e1d47</uuid><expression>max(/Morningstar ProStar PWM by SNMP/battery.voltage[batteryTerminalVoltage.0{#SINGLETON}],5m)&lt;{#VOLTAGE.MIN.CRIT}</expression><name>Battery: Critically low battery voltage</name><event_name>Battery: Critically low battery voltage (below {#VOLTAGE.MIN.CRIT}V for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger_prototype><trigger_prototype><uuid>77f130af976c43edb8c823de5cbd57b2</uuid><expression>min(/Morningstar ProStar PWM by SNMP/battery.voltage[batteryTerminalVoltage.0{#SINGLETON}],5m)&gt;{#VOLTAGE.MAX.WARN}</expression><name>Battery: High battery voltage</name><event_name>Battery: High battery voltage (over {#VOLTAGE.MAX.WARN}V for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><dependencies><dependency><name>Battery: Critically high battery voltage</name><expression>min(/Morningstar ProStar PWM by SNMP/battery.voltage[batteryTerminalVoltage.0{#SINGLETON}],5m)&gt;{#VOLTAGE.MAX.CRIT}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger_prototype><trigger_prototype><uuid>6c288c8b28db4f8e95c8ad2aa8b838ef</uuid><expression>max(/Morningstar ProStar PWM by SNMP/battery.voltage[batteryTerminalVoltage.0{#SINGLETON}],5m)&lt;{#VOLTAGE.MIN.WARN}</expression><name>Battery: Low battery voltage</name><event_name>Battery: Low battery voltage (below {#VOLTAGE.MIN.WARN}V for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><dependencies><dependency><name>Battery: Critically low battery voltage</name><expression>max(/Morningstar ProStar PWM by SNMP/battery.voltage[batteryTerminalVoltage.0{#SINGLETON}],5m)&lt;{#VOLTAGE.MIN.CRIT}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype></item_prototypes><graph_prototypes><graph_prototype><uuid>8ecd4f88627a4dadb132fdbb6d911b6b</uuid><name>Voltage: Battery/Load{#SINGLETON}</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>Morningstar ProStar PWM by SNMP</host><key>battery.voltage[batteryTerminalVoltage.0{#SINGLETON}]</key></item></graph_item><graph_item><sortorder>1</sortorder><drawtype>GRADIENT_LINE</drawtype><color>2774A4</color><item><host>Morningstar ProStar PWM by SNMP</host><key>load.voltage[loadVoltage.0]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes><master_item><key>battery.voltage.discovery[batteryTerminalVoltage.0]</key></master_item><preprocessing><step><type>JAVASCRIPT</type><parameters><parameter>var v_range = [
      [[0, 18], [12, 15, 11.5, 15.5]],
      [[18, 36], [24, 30, 23, 31]],
      [[36, 99], [48, 60, 46, 62]],
  ],
  result = [];

for (var idx in v_range) {
    if (v_range[idx][0][0] &lt; value &amp;&amp; value &lt;= v_range[idx][0][1]) {
        result = [{
            '{#VOLTAGE.MIN.WARN}': parseInt({$VOLTAGE.MIN.WARN}) || v_range[idx][1][0],
            '{#VOLTAGE.MAX.WARN}': parseInt({$VOLTAGE.MAX.WARN}) || v_range[idx][1][1],
            '{#VOLTAGE.MIN.CRIT}': parseInt({$VOLTAGE.MIN.CRIT}) || v_range[idx][1][2],
            '{#VOLTAGE.MAX.CRIT}': parseInt({$VOLTAGE.MAX.CRIT}) || v_range[idx][1][3],
            '{#SINGLETON}': ''
        }];
        break;
    }
}

return JSON.stringify(result);</parameter></parameters></step></preprocessing></discovery_rule></discovery_rules><tags><tag><tag>class</tag><value>power</value></tag><tag><tag>target</tag><value>morningstar</value></tag></tags><macros><macro><macro>{$BATTERY.TEMP.MAX.CRIT}</macro><value>60</value><description>Battery high temperature critical value</description></macro><macro><macro>{$BATTERY.TEMP.MAX.WARN}</macro><value>45</value><description>Battery high temperature warning value</description></macro><macro><macro>{$BATTERY.TEMP.MIN.CRIT}</macro><value>-20</value><description>Battery low temperature critical value</description></macro><macro><macro>{$BATTERY.TEMP.MIN.WARN}</macro><value>0</value><description>Battery low temperature warning value</description></macro><macro><macro>{$CHARGE.STATE.CRIT}</macro><value>4</value><description>fault</description></macro><macro><macro>{$CHARGE.STATE.WARN}</macro><value>2</value><description>disconnect</description></macro><macro><macro>{$LOAD.STATE.CRIT:&quot;fault&quot;}</macro><value>4</value><description>fault</description></macro><macro><macro>{$LOAD.STATE.CRIT:&quot;lvd&quot;}</macro><value>3</value><description>lvd</description></macro><macro><macro>{$LOAD.STATE.WARN:&quot;disconnect&quot;}</macro><value>5</value><description>disconnect</description></macro><macro><macro>{$LOAD.STATE.WARN:&quot;lvdWarning&quot;}</macro><value>2</value><description>lvdWarning</description></macro><macro><macro>{$LOAD.STATE.WARN:&quot;override&quot;}</macro><value>7</value><description>override</description></macro><macro><macro>{$VOLTAGE.MAX.CRIT}</macro></macro><macro><macro>{$VOLTAGE.MAX.WARN}</macro></macro><macro><macro>{$VOLTAGE.MIN.CRIT}</macro></macro><macro><macro>{$VOLTAGE.MIN.WARN}</macro></macro></macros><valuemaps><valuemap><uuid>f94eb6ad54c44281878c7c018c6209d1</uuid><name>ProStar PWM charge state</name><mappings><mapping><value>0</value><newvalue>Start</newvalue></mapping><mapping><value>1</value><newvalue>NightCheck</newvalue></mapping><mapping><value>2</value><newvalue>Disconnect</newvalue></mapping><mapping><value>3</value><newvalue>Night</newvalue></mapping><mapping><value>4</value><newvalue>Fault</newvalue></mapping><mapping><value>5</value><newvalue>Bulk</newvalue></mapping><mapping><value>6</value><newvalue>Pwm</newvalue></mapping><mapping><value>7</value><newvalue>Float</newvalue></mapping><mapping><value>8</value><newvalue>Equalize</newvalue></mapping></mappings></valuemap><valuemap><uuid>f0be8765c74e4c4788d4ff99a6c5ccd4</uuid><name>ProStar PWM load state</name><mappings><mapping><value>0</value><newvalue>Start</newvalue></mapping><mapping><value>1</value><newvalue>Normal</newvalue></mapping><mapping><value>2</value><newvalue>LvdWarning</newvalue></mapping><mapping><value>3</value><newvalue>Lvd</newvalue></mapping><mapping><value>4</value><newvalue>Fault</newvalue></mapping><mapping><value>5</value><newvalue>Disconnect</newvalue></mapping><mapping><value>6</value><newvalue>NormalOff</newvalue></mapping><mapping><value>7</value><newvalue>Override</newvalue></mapping><mapping><value>8</value><newvalue>NotUsed</newvalue></mapping></mappings></valuemap></valuemaps></template></templates><triggers><trigger><uuid>dea364bf454746bca6be38d7e0759d06</uuid><expression>(last(/Morningstar ProStar PWM by SNMP/status.hw.uptime)&gt;0 and last(/Morningstar ProStar PWM by SNMP/status.hw.uptime)&lt;10m) or (last(/Morningstar ProStar PWM by SNMP/status.hw.uptime)=0 and last(/Morningstar ProStar PWM by SNMP/status.net.uptime)&lt;10m)</expression><name>Status: Device has been restarted</name><event_name>Status: Device has been restarted (uptime &lt; 10m)</event_name><priority>INFO</priority><description>Uptime is less than 10 minutes.</description><manual_close>YES</manual_close><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers><graphs><graph><uuid>730d1e1e43224d1ea7b08f53988a7a60</uuid><name>Array: Voltage</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>Morningstar ProStar PWM by SNMP</host><key>array.voltage[arrayVoltage.0]</key></item></graph_item></graph_items></graph><graph><uuid>252a40cfba4242deac69f8ed77a04b84</uuid><name>Current: Charge/Load</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>Morningstar ProStar PWM by SNMP</host><key>charge.current[chargeCurrent.0]</key></item></graph_item><graph_item><sortorder>1</sortorder><drawtype>GRADIENT_LINE</drawtype><color>2774A4</color><item><host>Morningstar ProStar PWM by SNMP</host><key>load.current[loadCurrent.0]</key></item></graph_item></graph_items></graph><graph><uuid>94e4d2db752b4c54a8b497516b515fe0</uuid><name>Temperature: Ambient/Battery/Heatsink</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>Morningstar ProStar PWM by SNMP</host><key>temp.ambient[ambientTemperature.0]</key></item></graph_item><graph_item><sortorder>1</sortorder><drawtype>GRADIENT_LINE</drawtype><color>2774A4</color><item><host>Morningstar ProStar PWM by SNMP</host><key>temp.battery[batteryTemperature.0]</key></item></graph_item><graph_item><sortorder>2</sortorder><drawtype>GRADIENT_LINE</drawtype><color>F63100</color><item><host>Morningstar ProStar PWM by SNMP</host><key>temp.heatsink[heatsinkTemperature.0]</key></item></graph_item></graph_items></graph></graphs></zabbix_export>
