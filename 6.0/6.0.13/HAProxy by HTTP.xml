<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>6.0</version><date>2023-02-11T16:14:44Z</date><groups><group><uuid>a571c0d144b14fd4a87a9d9b2aa9fcd6</uuid><name>Templates/Applications</name></group></groups><templates><template><uuid>948d046cb2894e5c8d07767a518cc1a9</uuid><template>HAProxy by HTTP</template><name>HAProxy by HTTP</name><description>Get metrics from status page using HTTP agent
https://www.haproxy.com/blog/exploring-the-haproxy-stats-page/.
Example configuration of HAProxy:
  frontend stats
      bind *:8404
      stats enable
      stats uri /stats
      stats refresh 10s
      #stats auth Username:Password  # Authentication credentials

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/393527-discussion-thread-for-official-zabbix-template-haproxy

Template tooling version used: 0.41</description><groups><group><name>Templates/Applications</name></group></groups><items><item><uuid>93a0ea1e5b0145b5bd2dcdb698d367c2</uuid><name>HAProxy: Get stats</name><type>HTTP_AGENT</type><key>haproxy.get</key><history>0</history><trends>0</trends><value_type>TEXT</value_type><authtype>BASIC</authtype><username>{$HAPROXY.USERNAME}</username><password>{$HAPROXY.PASSWORD}</password><description>HAProxy Statistics Report in CSV format</description><preprocessing><step><type>REGEX</type><parameters><parameter># ([\s\S]*)\n</parameter><parameter>\1</parameter></parameters></step><step><type>CSV_TO_JSON</type><parameters><parameter/><parameter/><parameter>1</parameter></parameters></step></preprocessing><url>{$HAPROXY.STATS.SCHEME}://{HOST.CONN}:{$HAPROXY.STATS.PORT}/{$HAPROXY.STATS.PATH};csv</url><tags><tag><tag>component</tag><value>raw</value></tag></tags></item><item><uuid>6af51d085a2f41f983bc3b20c6f4cc22</uuid><name>HAProxy: Get nodes</name><type>DEPENDENT</type><key>haproxy.get.nodes</key><delay>0</delay><history>0</history><trends>0</trends><value_type>TEXT</value_type><description>Array for LLD rules.</description><preprocessing><step><type>JAVASCRIPT</type><parameters><parameter>return JSON.stringify(JSON.parse(value),['mode','pxname','svname'])</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>raw</value></tag></tags></item><item><uuid>123c03c715494faea6b1d4f8b8fa564d</uuid><name>HAProxy: Get stats page</name><type>HTTP_AGENT</type><key>haproxy.get_html</key><history>0</history><trends>0</trends><value_type>TEXT</value_type><authtype>BASIC</authtype><username>{$HAPROXY.USERNAME}</username><password>{$HAPROXY.PASSWORD}</password><description>HAProxy Statistics Report HTML</description><url>{$HAPROXY.STATS.SCHEME}://{HOST.CONN}:{$HAPROXY.STATS.PORT}/{$HAPROXY.STATS.PATH}</url><tags><tag><tag>component</tag><value>raw</value></tag></tags></item><item><uuid>06a33ebaed3148889c19eba2de859d70</uuid><name>HAProxy: Uptime</name><type>DEPENDENT</type><key>haproxy.uptime</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>s</units><preprocessing><step><type>JAVASCRIPT</type><parameters><parameter>try {
    var t = value.match(/(\d+)d (\d+)h(\d+)m(\d+)s/);
    return t[1] * 86400 + t[2] * 3600 + t[3] * 60 + t[4] * 1;
}
catch (error) {
    throw &quot;HAProxy uptime is not found : &quot; + error;
}</parameter></parameters></step></preprocessing><master_item><key>haproxy.get_html</key></master_item><tags><tag><tag>component</tag><value>application</value></tag></tags><triggers><trigger><uuid>ff606f3c571340389562fabc9e814463</uuid><expression>last(/HAProxy by HTTP/haproxy.uptime)&lt;10m</expression><name>HAProxy: has been restarted</name><event_name>HAProxy: has been restarted (uptime &lt; 10m)</event_name><priority>INFO</priority><description>Uptime is less than 10 minutes</description><manual_close>YES</manual_close><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>a2cd747feaaf4c278972ac7adbd9015a</uuid><name>HAProxy: Version</name><type>DEPENDENT</type><key>haproxy.version</key><delay>0</delay><trends>0</trends><value_type>CHAR</value_type><preprocessing><step><type>REGEX</type><parameters><parameter>HAProxy version ([^,]*),</parameter><parameter>\1</parameter></parameters><error_handler>CUSTOM_ERROR</error_handler><error_handler_params>HAProxy version is not found</error_handler_params></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1d</parameter></parameters></step></preprocessing><master_item><key>haproxy.get_html</key></master_item><tags><tag><tag>component</tag><value>application</value></tag></tags><triggers><trigger><uuid>c4b8346311a34cd19ebc8fbab53737fe</uuid><expression>last(/HAProxy by HTTP/haproxy.version,#1)&lt;&gt;last(/HAProxy by HTTP/haproxy.version,#2) and length(last(/HAProxy by HTTP/haproxy.version))&gt;0</expression><name>HAProxy: Version has changed</name><event_name>HAProxy: Version has changed (new version: {ITEM.VALUE})</event_name><priority>INFO</priority><description>HAProxy version has changed. Ack to close.</description><manual_close>YES</manual_close><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>6f9c22a840764181be9cf98609e7f691</uuid><name>HAProxy: Service response time</name><type>SIMPLE</type><key>net.tcp.service.perf[&quot;{$HAPROXY.STATS.SCHEME}&quot;,&quot;{HOST.CONN}&quot;,&quot;{$HAPROXY.STATS.PORT}&quot;]</key><history>7d</history><value_type>FLOAT</value_type><units>s</units><tags><tag><tag>component</tag><value>health</value></tag><tag><tag>component</tag><value>network</value></tag></tags><triggers><trigger><uuid>1fed5fffc6414e0babe362c0ad742e43</uuid><expression>min(/HAProxy by HTTP/net.tcp.service.perf[&quot;{$HAPROXY.STATS.SCHEME}&quot;,&quot;{HOST.CONN}&quot;,&quot;{$HAPROXY.STATS.PORT}&quot;],5m)&gt;{$HAPROXY.RESPONSE_TIME.MAX.WARN}</expression><name>HAProxy: Service response time is too high</name><event_name>HAProxy: Service response time is too high (over {$HAPROXY.RESPONSE_TIME.MAX.WARN} for 5m)</event_name><priority>WARNING</priority><manual_close>YES</manual_close><dependencies><dependency><name>HAProxy: Service is down</name><expression>last(/HAProxy by HTTP/net.tcp.service[&quot;{$HAPROXY.STATS.SCHEME}&quot;,&quot;{HOST.CONN}&quot;,&quot;{$HAPROXY.STATS.PORT}&quot;])=0</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>performance</value></tag></tags></trigger></triggers></item><item><uuid>68cb52357d7443d79373df3890ed175f</uuid><name>HAProxy: Service status</name><type>SIMPLE</type><key>net.tcp.service[&quot;{$HAPROXY.STATS.SCHEME}&quot;,&quot;{HOST.CONN}&quot;,&quot;{$HAPROXY.STATS.PORT}&quot;]</key><history>7d</history><valuemap><name>Service state</name></valuemap><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>10m</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>health</value></tag><tag><tag>component</tag><value>network</value></tag></tags><triggers><trigger><uuid>b346943ac4d04a96bcef42f3c43fc555</uuid><expression>last(/HAProxy by HTTP/net.tcp.service[&quot;{$HAPROXY.STATS.SCHEME}&quot;,&quot;{HOST.CONN}&quot;,&quot;{$HAPROXY.STATS.PORT}&quot;])=0</expression><name>HAProxy: Service is down</name><priority>AVERAGE</priority><manual_close>YES</manual_close><tags><tag><tag>scope</tag><value>availability</value></tag></tags></trigger></triggers></item></items><discovery_rules><discovery_rule><uuid>7b4ab1338cdf4e499c1fdea4c886ae9a</uuid><name>Backend discovery</name><type>DEPENDENT</type><key>haproxy.backend.discovery</key><delay>0</delay><filter><evaltype>AND</evaltype><conditions><condition><macro>{#SVNAME}</macro><value>BACKEND</value><formulaid>B</formulaid></condition><condition><macro>{#MODE}</macro><value>http|tcp</value><formulaid>A</formulaid></condition></conditions></filter><description>Discovery backends</description><item_prototypes><item_prototype><uuid>d5d9c5c0d84d41d597c85a3562e9b4fa</uuid><name>HAProxy Backend {#PXNAME}: Number of active servers</name><type>DEPENDENT</type><key>haproxy.backend.act[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><description>Number of active servers.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].act.first()</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>servers</value></tag></tags></item_prototype><item_prototype><uuid>08debce7e9084094b38fd1100e03c553</uuid><name>HAProxy Backend {#PXNAME}: Number of backup servers</name><type>DEPENDENT</type><key>haproxy.backend.bck[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><description>Number of backup servers.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].bck.first()</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>servers</value></tag></tags></item_prototype><item_prototype><uuid>8a53b50c1ce441c18fe6e6d5e0ad48d6</uuid><name>HAProxy Backend {#PXNAME}: Incoming traffic</name><type>DEPENDENT</type><key>haproxy.backend.bin.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>bps</units><description>Number of bits received by the backend</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].bin.first()</parameter></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>8</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>network</value></tag></tags></item_prototype><item_prototype><uuid>1c24125e97014d4ba6a8155af5744d38</uuid><name>HAProxy Backend {#PXNAME}: Outgoing traffic</name><type>DEPENDENT</type><key>haproxy.backend.bout.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>bps</units><description>Number of bits sent by the backend</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].bout.first()</parameter></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>8</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>network</value></tag></tags></item_prototype><item_prototype><uuid>59eeafe66fe34334a81d736f62b88ec0</uuid><name>HAProxy Backend {#PXNAME}: Responses denied per second</name><type>DEPENDENT</type><key>haproxy.backend.dresp.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Responses denied due to security concerns (ACL-restricted).</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].dresp.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>responses</value></tag></tags></item_prototype><item_prototype><uuid>e885cb2b53a941cd932211c4ccf334f6</uuid><name>HAProxy Backend {#PXNAME}: Errors connection per second</name><type>DEPENDENT</type><key>haproxy.backend.econ.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of requests that encountered an error attempting to connect to a backend server.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].econ.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>connections</value></tag></tags></item_prototype><item_prototype><uuid>c42f04d1a00c4d4fa96705746cb32631</uuid><name>HAProxy Backend {#PXNAME}: Response errors per second</name><type>DEPENDENT</type><key>haproxy.backend.eresp.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of requests whose responses yielded an error</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].eresp.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>responses</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>efe5a794bd47419398aa3aa35a177f08</uuid><expression>min(/HAProxy by HTTP/haproxy.backend.eresp.rate[{#PXNAME},{#SVNAME}],5m)&gt;{$HAPROXY.BACK_ERESP.MAX.WARN}</expression><name>HAProxy backend {#PXNAME}: Number of responses with error is high</name><event_name>HAProxy backend {#PXNAME}: Number of responses with error is more than {$HAPROXY.BACK_ERESP.MAX.WARN} for 5m</event_name><priority>WARNING</priority><description>Number of requests on backend, whose responses yielded an error, is more than {$HAPROXY.BACK_ERESP.MAX.WARN}.</description><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><uuid>55edb3b8afaa4ee2961d1fead3653dbd</uuid><name>HAProxy Backend {#PXNAME}: Number of responses with codes 1xx per second</name><type>DEPENDENT</type><key>haproxy.backend.hrsp_1xx.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of informational HTTP responses per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].hrsp_1xx.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>responses</value></tag></tags></item_prototype><item_prototype><uuid>a4e5dd0c25c3471e82e28b88b6b42e39</uuid><name>HAProxy Backend {#PXNAME}: Number of responses with codes 2xx per second</name><type>DEPENDENT</type><key>haproxy.backend.hrsp_2xx.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of successful HTTP responses per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].hrsp_2xx.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>responses</value></tag></tags></item_prototype><item_prototype><uuid>7e32a61240004b99bf19caf29c5d1409</uuid><name>HAProxy Backend {#PXNAME}: Number of responses with codes 3xx per second</name><type>DEPENDENT</type><key>haproxy.backend.hrsp_3xx.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of HTTP redirections per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].hrsp_3xx.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>responses</value></tag></tags></item_prototype><item_prototype><uuid>9519222f512e46d8ae1a7ca3a47f3970</uuid><name>HAProxy Backend {#PXNAME}: Number of responses with codes 4xx per second</name><type>DEPENDENT</type><key>haproxy.backend.hrsp_4xx.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of HTTP client errors per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].hrsp_4xx.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>responses</value></tag></tags></item_prototype><item_prototype><uuid>fdaa48cf19164fed8c3f00cc42c3bab8</uuid><name>HAProxy Backend {#PXNAME}: Number of responses with codes 5xx per second</name><type>DEPENDENT</type><key>haproxy.backend.hrsp_5xx.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of HTTP server errors per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].hrsp_5xx.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>responses</value></tag></tags></item_prototype><item_prototype><uuid>7985131c621d49419dfe5bcfecb675f2</uuid><name>HAProxy Backend {#PXNAME}: Unassigned requests</name><type>DEPENDENT</type><key>haproxy.backend.qcur[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><description>Current number of requests unassigned in queue.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].qcur.first()</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>requests</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>be428614e0874726b63d79150813542d</uuid><expression>min(/HAProxy by HTTP/haproxy.backend.qcur[{#PXNAME},{#SVNAME}],5m)&gt;{$HAPROXY.BACK_QCUR.MAX.WARN}</expression><name>HAProxy backend {#PXNAME}: Current number of requests unassigned in queue is high</name><event_name>HAProxy backend {#PXNAME}: Current number of requests unassigned in queue is more than {$HAPROXY.BACK_QCUR.MAX.WARN} for 5m</event_name><priority>WARNING</priority><description>Current number of requests on backend unassigned in queue is more than {$HAPROXY.BACK_QCUR.MAX.WARN}.</description><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><uuid>1592ee4ff7b2448a9e044a0ad7904693</uuid><name>HAProxy Backend {#PXNAME}: Time in queue</name><type>DEPENDENT</type><key>haproxy.backend.qtime[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>s</units><description>Average time spent in queue (in ms) for the last 1,024 requests</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].qtime.first()</parameter></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>0.001</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>requests</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>fa8211069df846a1b2ee8afcdd52f4a0</uuid><expression>min(/HAProxy by HTTP/haproxy.backend.qtime[{#PXNAME},{#SVNAME}],5m)&gt;{$HAPROXY.BACK_QTIME.MAX.WARN}</expression><name>HAProxy backend {#PXNAME}: Average time spent in queue is high</name><event_name>HAProxy backend {#PXNAME}: Average time spent in queue is more than {$HAPROXY.BACK_QTIME.MAX.WARN} for 5m</event_name><priority>WARNING</priority><description>Average time spent in queue (in ms) for the last 1,024 requests is more than {$HAPROXY.BACK_QTIME.MAX.WARN}.</description><tags><tag><tag>scope</tag><value>performance</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><uuid>5ddd3cd8af904faaa69f34df442c9717</uuid><name>HAProxy Backend {#PXNAME}: Responses time</name><type>DEPENDENT</type><key>haproxy.backend.rtime[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>s</units><description>Average backend response time (in ms) for the last 1,024 requests</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].rtime.first()</parameter></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>0.001</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>responses</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>90c0bd8c280246b7903ac90c32553fd5</uuid><expression>min(/HAProxy by HTTP/haproxy.backend.rtime[{#PXNAME},{#SVNAME}],5m)&gt;{$HAPROXY.BACK_RTIME.MAX.WARN}</expression><name>HAProxy backend {#PXNAME}: Average response time is high</name><event_name>HAProxy backend {#PXNAME}: Average response time is more than {$HAPROXY.BACK_RTIME.MAX.WARN} for 5m</event_name><priority>WARNING</priority><description>Average backend response time (in ms) for the last 1,024 requests is more than {$HAPROXY.BACK_RTIME.MAX.WARN}.</description><tags><tag><tag>scope</tag><value>performance</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><uuid>16bb7ee405a84bb4865c46fdf996511f</uuid><name>HAProxy Backend {#PXNAME}: Status</name><type>DEPENDENT</type><key>haproxy.backend.status[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><trends>0</trends><value_type>CHAR</value_type><description>Possible values:
UP - The server is reporting as healthy.
DOWN - The server is reporting as unhealthy and unable to receive requests.
NOLB - You've added http-check disable-on-404 to the backend and the health checked URL has returned an HTTP 404 response.
MAINT - The server has been disabled or put into maintenance mode.
DRAIN - The server has been put into drain mode.
no check - Health checks are not enabled for this server.</description><valuemap><name>Service state</name></valuemap><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].status.first()</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>10m</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>health</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>5ea80b42a6be4df48f048a5aa253c923</uuid><expression>count(/HAProxy by HTTP/haproxy.backend.status[{#PXNAME},{#SVNAME}],#5,&quot;eq&quot;,&quot;DOWN&quot;)=5</expression><name>HAProxy backend {#PXNAME}: Server is DOWN</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>AVERAGE</priority><description>Backend is not available.</description><tags><tag><tag>scope</tag><value>availability</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><uuid>76d9497f428142268a5c1eeb24cbbad7</uuid><name>HAProxy Backend {#PXNAME}: Sessions per second</name><type>DEPENDENT</type><key>haproxy.backend.stot.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Cumulative number of sessions (end-to-end connections) per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].stot.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>sessions</value></tag></tags></item_prototype><item_prototype><uuid>f1d26d9c409d4983b7f94ff412ae72f3</uuid><name>HAProxy Backend {#PXNAME}: Weight</name><type>DEPENDENT</type><key>haproxy.backend.weight[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><description>Total effective weight.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].weight.first()</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>balancer</value></tag></tags></item_prototype><item_prototype><uuid>00d3038c7df34512ae39ba1051712674</uuid><name>HAProxy Backend {#PXNAME}: Redispatched requests per second</name><type>DEPENDENT</type><key>haproxy.backend.wredis.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of times a request was redispatched to a different backend.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].wredis.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>requests</value></tag></tags></item_prototype><item_prototype><uuid>e0eafe2c4d0d40e492822e43f6cf108e</uuid><name>HAProxy Backend {#PXNAME}: Retried connections per second</name><type>DEPENDENT</type><key>haproxy.backend.wretr.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of times a connection was retried.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].wretr.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>backend</tag><value>{#PXNAME}</value></tag><tag><tag>component</tag><value>connections</value></tag></tags></item_prototype></item_prototypes><graph_prototypes><graph_prototype><uuid>47e7dc2c8ff2424eb81f396f83dbb2c0</uuid><name>HAProxy: Backend {#PXNAME} In/Out traffic</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>HAProxy by HTTP</host><key>haproxy.backend.bin.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>1</sortorder><drawtype>GRADIENT_LINE</drawtype><color>2774A4</color><item><host>HAProxy by HTTP</host><key>haproxy.backend.bout.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item></graph_items></graph_prototype><graph_prototype><uuid>2160a789b142498cb2d3e401ee992edb</uuid><name>HAProxy: Backend {#PXNAME} Redispatched requests and retried connections per second</name><graph_items><graph_item><color>1A7C11</color><item><host>HAProxy by HTTP</host><key>haproxy.backend.wredis.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>HAProxy by HTTP</host><key>haproxy.backend.wretr.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item></graph_items></graph_prototype><graph_prototype><uuid>816e4062fc7b45bea96c2a2fbc171088</uuid><name>HAProxy: Backend {#PXNAME} Responses by HTTP code</name><type>STACKED</type><graph_items><graph_item><color>1A7C11</color><item><host>HAProxy by HTTP</host><key>haproxy.backend.hrsp_1xx.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>HAProxy by HTTP</host><key>haproxy.backend.hrsp_2xx.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>HAProxy by HTTP</host><key>haproxy.backend.hrsp_3xx.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>3</sortorder><color>A54F10</color><item><host>HAProxy by HTTP</host><key>haproxy.backend.hrsp_4xx.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>4</sortorder><color>FC6EA3</color><item><host>HAProxy by HTTP</host><key>haproxy.backend.hrsp_5xx.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes><master_item><key>haproxy.get.nodes</key></master_item><lld_macro_paths><lld_macro_path><lld_macro>{#MODE}</lld_macro><path>$.mode</path></lld_macro_path><lld_macro_path><lld_macro>{#PXNAME}</lld_macro><path>$.pxname</path></lld_macro_path><lld_macro_path><lld_macro>{#SVNAME}</lld_macro><path>$.svname</path></lld_macro_path></lld_macro_paths><overrides><override><name>Discard HTTP status codes</name><step>1</step><filter><conditions><condition><macro>{#MODE}</macro><value>tcp</value><formulaid>A</formulaid></condition></conditions></filter><operations><operation><operationobject>ITEM_PROTOTYPE</operationobject><operator>LIKE</operator><value>Number of responses with codes</value><status>ENABLED</status><discover>NO_DISCOVER</discover></operation></operations></override></overrides></discovery_rule><discovery_rule><uuid>37629de766fd4c61a1618f9d1f1e2eab</uuid><name>Frontend discovery</name><type>DEPENDENT</type><key>haproxy.frontend.discovery</key><delay>0</delay><filter><evaltype>AND</evaltype><conditions><condition><macro>{#SVNAME}</macro><value>FRONTEND</value><formulaid>B</formulaid></condition><condition><macro>{#MODE}</macro><value>http|tcp</value><formulaid>A</formulaid></condition></conditions></filter><description>Discovery frontends</description><item_prototypes><item_prototype><uuid>6dac4d4e912b4f8fb7def6bab98d8dc4</uuid><name>HAProxy Frontend {#PXNAME}: Incoming traffic</name><type>DEPENDENT</type><key>haproxy.frontend.bin.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>bps</units><description>Number of bits received by the frontend</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].bin.first()</parameter></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>8</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>network</value></tag><tag><tag>frontend</tag><value>{#PXNAME}</value></tag></tags></item_prototype><item_prototype><uuid>5550e3842d00486999c822b0d514b78e</uuid><name>HAProxy Frontend {#PXNAME}: Outgoing traffic</name><type>DEPENDENT</type><key>haproxy.frontend.bout.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>bps</units><description>Number of bits sent by the frontend</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].bout.first()</parameter></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>8</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>network</value></tag><tag><tag>frontend</tag><value>{#PXNAME}</value></tag></tags></item_prototype><item_prototype><uuid>819b1559cf294958ab03cae8663eb7e3</uuid><name>HAProxy Frontend {#PXNAME}: Denied requests per second</name><type>DEPENDENT</type><key>haproxy.frontend.dreq.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Requests denied due to security concerns (ACL-restricted) per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].dreq.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>requests</value></tag><tag><tag>frontend</tag><value>{#PXNAME}</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>4d8ac22673944752979263b34521af65</uuid><expression>min(/HAProxy by HTTP/haproxy.frontend.dreq.rate[{#PXNAME},{#SVNAME}],5m)&gt;{$HAPROXY.FRONT_DREQ.MAX.WARN}</expression><name>HAProxy frontend {#PXNAME}: Number of requests denied is high</name><event_name>HAProxy frontend {#PXNAME}: Number of requests denied is more than {$HAPROXY.FRONT_DREQ.MAX.WARN} for 5m</event_name><priority>WARNING</priority><description>Number of requests denied due to security concerns (ACL-restricted) is more than {$HAPROXY.FRONT_DREQ.MAX.WARN}.</description><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><uuid>0b2a1b9e1c9045519e4ac52d5d83e86b</uuid><name>HAProxy Frontend {#PXNAME}: Request errors per second</name><type>DEPENDENT</type><key>haproxy.frontend.ereq.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of request errors per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].ereq.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>requests</value></tag><tag><tag>frontend</tag><value>{#PXNAME}</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>c51ac95f4d4a46e1ac1df1d057197f6e</uuid><expression>min(/HAProxy by HTTP/haproxy.frontend.ereq.rate[{#PXNAME},{#SVNAME}],5m)&gt;{$HAPROXY.FRONT_EREQ.MAX.WARN}</expression><name>HAProxy frontend {#PXNAME}: Number of request errors is high</name><event_name>HAProxy frontend {#PXNAME}: Number of request errors is more than {$HAPROXY.FRONT_EREQ.MAX.WARN} for 5m</event_name><priority>WARNING</priority><description>Number of request errors is more than {$HAPROXY.FRONT_EREQ.MAX.WARN}.</description><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><uuid>c287463b994c40caaaeb195a4dca5d37</uuid><name>HAProxy Frontend {#PXNAME}: Number of responses with codes 1xx per second</name><type>DEPENDENT</type><key>haproxy.frontend.hrsp_1xx.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of informational HTTP responses per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].hrsp_1xx.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>responses</value></tag><tag><tag>frontend</tag><value>{#PXNAME}</value></tag></tags></item_prototype><item_prototype><uuid>41cd2084595d482ea204f9edc62a985a</uuid><name>HAProxy Frontend {#PXNAME}: Number of responses with codes 2xx per second</name><type>DEPENDENT</type><key>haproxy.frontend.hrsp_2xx.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of successful HTTP responses per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].hrsp_2xx.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>responses</value></tag><tag><tag>frontend</tag><value>{#PXNAME}</value></tag></tags></item_prototype><item_prototype><uuid>f1ae1b8f477449c9832e80bfd145211a</uuid><name>HAProxy Frontend {#PXNAME}: Number of responses with codes 3xx per second</name><type>DEPENDENT</type><key>haproxy.frontend.hrsp_3xx.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of HTTP redirections per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].hrsp_3xx.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>responses</value></tag><tag><tag>frontend</tag><value>{#PXNAME}</value></tag></tags></item_prototype><item_prototype><uuid>f1635a2f379b4542b9c44c9d5224fc4d</uuid><name>HAProxy Frontend {#PXNAME}: Number of responses with codes 4xx per second</name><type>DEPENDENT</type><key>haproxy.frontend.hrsp_4xx.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of HTTP client errors per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].hrsp_4xx.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>responses</value></tag><tag><tag>frontend</tag><value>{#PXNAME}</value></tag></tags></item_prototype><item_prototype><uuid>cf9ae6b634fd4acc92c180bc10c9b0f5</uuid><name>HAProxy Frontend {#PXNAME}: Number of responses with codes 5xx per second</name><type>DEPENDENT</type><key>haproxy.frontend.hrsp_5xx.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of HTTP server errors per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].hrsp_5xx.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>responses</value></tag><tag><tag>frontend</tag><value>{#PXNAME}</value></tag></tags></item_prototype><item_prototype><uuid>6c09de61332c4d56a4b90ee4e9ab6fe2</uuid><name>HAProxy Frontend {#PXNAME}: Sessions rate</name><type>DEPENDENT</type><key>haproxy.frontend.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><description>Number of sessions created per second</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].rate.first()</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>sessions</value></tag><tag><tag>frontend</tag><value>{#PXNAME}</value></tag></tags></item_prototype><item_prototype><uuid>7097695ee69e4b7895c0d885606b8456</uuid><name>HAProxy Frontend {#PXNAME}: Requests rate</name><type>DEPENDENT</type><key>haproxy.frontend.req_rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><description>HTTP requests per second</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].req_rate.first()</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>requests</value></tag><tag><tag>frontend</tag><value>{#PXNAME}</value></tag></tags></item_prototype><item_prototype><uuid>7985345dcd274811ac6a2e69940f6cb7</uuid><name>HAProxy Frontend {#PXNAME}: Established sessions</name><type>DEPENDENT</type><key>haproxy.frontend.scur[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><description>The current number of established sessions.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].scur.first()</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>sessions</value></tag><tag><tag>frontend</tag><value>{#PXNAME}</value></tag></tags></item_prototype><item_prototype><uuid>8b185b2272244229865315cc0139d43f</uuid><name>HAProxy Frontend {#PXNAME}: Session limits</name><type>DEPENDENT</type><key>haproxy.frontend.slim[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><description>The most simultaneous sessions that are allowed, as defined by the maxconn setting in the frontend.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].slim.first()</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>sessions</value></tag><tag><tag>frontend</tag><value>{#PXNAME}</value></tag></tags></item_prototype><item_prototype><uuid>6e7372afcd6842c0865a1480973fc8e5</uuid><name>HAProxy Frontend {#PXNAME}: Status</name><type>DEPENDENT</type><key>haproxy.frontend.status[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><trends>0</trends><value_type>CHAR</value_type><description>Possible values: OPEN, STOP.
When Status is OPEN, the frontend is operating normally and ready to receive traffic.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].status.first()</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>6h</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>health</value></tag><tag><tag>frontend</tag><value>{#PXNAME}</value></tag></tags></item_prototype><item_prototype><uuid>53efa6139fe3400283c96ec76eb20855</uuid><name>HAProxy Frontend {#PXNAME}: Session utilization</name><type>CALCULATED</type><key>haproxy.frontend.sutil[{#PXNAME},{#SVNAME}]</key><history>7d</history><value_type>FLOAT</value_type><units>%</units><params>last(//haproxy.frontend.scur[{#PXNAME},{#SVNAME}]) / last(//haproxy.frontend.slim[{#PXNAME},{#SVNAME}]) * 100</params><description>Percentage of sessions used (scur / slim * 100).</description><tags><tag><tag>component</tag><value>sessions</value></tag><tag><tag>frontend</tag><value>{#PXNAME}</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>ad33db7c356342e78ee19e904c981f1f</uuid><expression>min(/HAProxy by HTTP/haproxy.frontend.sutil[{#PXNAME},{#SVNAME}],5m)&gt;{$HAPROXY.FRONT_SUTIL.MAX.WARN}</expression><name>HAProxy frontend {#PXNAME}: Session utilization is high</name><event_name>HAProxy frontend {#PXNAME}: Session utilization is more than {$HAPROXY.FRONT_SUTIL.MAX.WARN}% for 5m</event_name><priority>WARNING</priority><description>Alerting on this metric is essential to ensure your server has sufficient capacity to handle all concurrent sessions. Unlike requests, upon reaching the session limit HAProxy will deny additional clients until resource consumption drops. Furthermore, if you find your session usage percentage to be hovering above 80%, it could be time to either modify HAProxy's configuration to allow more sessions, or migrate your HAProxy server to a bigger box.</description><tags><tag><tag>scope</tag><value>performance</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype></item_prototypes><graph_prototypes><graph_prototype><uuid>29c858f57e5447758c9bb39008ba7aa9</uuid><name>HAProxy: Frontend {#PXNAME} Errors and denials per second</name><graph_items><graph_item><color>1A7C11</color><item><host>HAProxy by HTTP</host><key>haproxy.frontend.ereq.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>HAProxy by HTTP</host><key>haproxy.frontend.dreq.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item></graph_items></graph_prototype><graph_prototype><uuid>b7db5c68269b46d4b009f5a6c769e13e</uuid><name>HAProxy: Frontend {#PXNAME} In/Out traffic</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>HAProxy by HTTP</host><key>haproxy.frontend.bin.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>1</sortorder><drawtype>GRADIENT_LINE</drawtype><color>2774A4</color><item><host>HAProxy by HTTP</host><key>haproxy.frontend.bout.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item></graph_items></graph_prototype><graph_prototype><uuid>1550af17c1fe4509922b87dd7d60e8b7</uuid><name>HAProxy: Frontend {#PXNAME} Requests and sessions per second</name><graph_items><graph_item><color>1A7C11</color><item><host>HAProxy by HTTP</host><key>haproxy.frontend.req_rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>HAProxy by HTTP</host><key>haproxy.frontend.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item></graph_items></graph_prototype><graph_prototype><uuid>82817ba44621444c90f7b4dc8abb3107</uuid><name>HAProxy: Frontend {#PXNAME} Responses by HTTP code</name><type>STACKED</type><graph_items><graph_item><color>1A7C11</color><item><host>HAProxy by HTTP</host><key>haproxy.frontend.hrsp_1xx.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>HAProxy by HTTP</host><key>haproxy.frontend.hrsp_2xx.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>HAProxy by HTTP</host><key>haproxy.frontend.hrsp_3xx.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>3</sortorder><color>A54F10</color><item><host>HAProxy by HTTP</host><key>haproxy.frontend.hrsp_4xx.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>4</sortorder><color>FC6EA3</color><item><host>HAProxy by HTTP</host><key>haproxy.frontend.hrsp_5xx.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes><master_item><key>haproxy.get.nodes</key></master_item><lld_macro_paths><lld_macro_path><lld_macro>{#MODE}</lld_macro><path>$.mode</path></lld_macro_path><lld_macro_path><lld_macro>{#PXNAME}</lld_macro><path>$.pxname</path></lld_macro_path><lld_macro_path><lld_macro>{#SVNAME}</lld_macro><path>$.svname</path></lld_macro_path></lld_macro_paths><overrides><override><name>Discard HTTP status codes</name><step>1</step><filter><conditions><condition><macro>{#MODE}</macro><value>tcp</value><formulaid>A</formulaid></condition></conditions></filter><operations><operation><operationobject>ITEM_PROTOTYPE</operationobject><operator>LIKE</operator><value>Number of responses with codes</value><status>ENABLED</status><discover>NO_DISCOVER</discover></operation></operations></override></overrides></discovery_rule><discovery_rule><uuid>134455ad7e8c4444a78255cb2e3fa98b</uuid><name>Server discovery</name><type>DEPENDENT</type><key>haproxy.server.discovery</key><delay>0</delay><filter><evaltype>AND</evaltype><conditions><condition><macro>{#SVNAME}</macro><value>FRONTEND|BACKEND</value><operator>NOT_MATCHES_REGEX</operator><formulaid>B</formulaid></condition><condition><macro>{#MODE}</macro><value>http|tcp</value><formulaid>A</formulaid></condition></conditions></filter><description>Discovery servers</description><item_prototypes><item_prototype><uuid>bd19603777534fe38c9aa1888903d2fa</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Server is active</name><type>DEPENDENT</type><key>haproxy.server.act[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><description>Shows whether the server is active (marked with a Y) or a backup (marked with a -).</description><valuemap><name>Server mode</name></valuemap><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].act.first()</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>role</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags></item_prototype><item_prototype><uuid>49b7da6cc75c4bb7ad2c3b7c25beccb5</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Server is backup</name><type>DEPENDENT</type><key>haproxy.server.bck[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><description>Shows whether the server is a backup (marked with a Y) or active (marked with a -).</description><valuemap><name>Server mode</name></valuemap><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].bck.first()</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>role</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags></item_prototype><item_prototype><uuid>355525dba53747c899f19fe4114a3ca4</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Incoming traffic</name><type>DEPENDENT</type><key>haproxy.server.bin.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>bps</units><description>Number of bits received by the backend</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].bin.first()</parameter></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>8</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>network</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags></item_prototype><item_prototype><uuid>0d721252dd3946818f87815a56ced8d0</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Outgoing traffic</name><type>DEPENDENT</type><key>haproxy.server.bout.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>bps</units><description>Number of bits sent by the backend</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].bout.first()</parameter></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>8</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>network</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags></item_prototype><item_prototype><uuid>6fe4502c3b534ee6b9a39a3fcc8d0b98</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Status of last health check</name><type>DEPENDENT</type><key>haproxy.server.check_status[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><trends>0</trends><value_type>CHAR</value_type><description>Status of last health check, one of:
UNK     -&gt; unknown
INI     -&gt; initializing
SOCKERR -&gt; socket error
L4OK    -&gt; check passed on layer 4, no upper layers testing enabled
L4TOUT  -&gt; layer 1-4 timeout
L4CON   -&gt; layer 1-4 connection problem, for example &quot;Connection refused&quot; (tcp rst) or &quot;No route to host&quot; (icmp)
L6OK    -&gt; check passed on layer 6
L6TOUT  -&gt; layer 6 (SSL) timeout
L6RSP   -&gt; layer 6 invalid response - protocol error
L7OK    -&gt; check passed on layer 7
L7OKC   -&gt; check conditionally passed on layer 7, for example 404 with disable-on-404
L7TOUT  -&gt; layer 7 (HTTP/SMTP) timeout
L7RSP   -&gt; layer 7 invalid response - protocol error
L7STS   -&gt; layer 7 response error, for example HTTP 5xx
Notice: If a check is currently running, the last known status will be reported, prefixed with &quot;* &quot;. e. g. &quot;* L7OK&quot;.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].check_status.first()</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>10m</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>health</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>6c4f8cf76ab046aaa4bd51e41cc10de7</uuid><expression>find(/HAProxy by HTTP/haproxy.server.check_status[{#PXNAME},{#SVNAME}],#3,&quot;regexp&quot;,&quot;(?:L[4-7]OK|^$)&quot;)=0</expression><name>HAProxy {#PXNAME} {#SVNAME}: Health check error</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><description>Please check the server for faults.</description><dependencies><dependency><name>HAProxy {#PXNAME} {#SVNAME}: Server is DOWN</name><expression>count(/HAProxy by HTTP/haproxy.server.status[{#PXNAME},{#SVNAME}],#5,&quot;eq&quot;,&quot;DOWN&quot;)=5</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><uuid>6e5824eca488428eb61a17d1d4efd055</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Responses denied per second</name><type>DEPENDENT</type><key>haproxy.server.dresp.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Responses denied due to security concerns (ACL-restricted).</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].dresp.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>responses</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags></item_prototype><item_prototype><uuid>18533da75eb142dbb216acc7af3bde4b</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Errors connection per second</name><type>DEPENDENT</type><key>haproxy.server.econ.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of requests that encountered an error attempting to connect to a backend server.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].econ.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags></item_prototype><item_prototype><uuid>3412ca47e4fe4481b434f95dda566c5e</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Response errors per second</name><type>DEPENDENT</type><key>haproxy.server.eresp.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of requests whose responses yielded an error.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].eresp.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>responses</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>bf952df23dac4b059d0219b204449830</uuid><expression>min(/HAProxy by HTTP/haproxy.server.eresp.rate[{#PXNAME},{#SVNAME}],5m)&gt;{$HAPROXY.SERVER_ERESP.MAX.WARN}</expression><name>HAProxy {#PXNAME} {#SVNAME}: Number of responses with error is high</name><event_name>HAProxy {#PXNAME} {#SVNAME}: Number of responses with error is more than {$HAPROXY.SERVER_ERESP.MAX.WARN} for 5m</event_name><priority>WARNING</priority><description>Number of requests on server, whose responses yielded an error, is more than {$HAPROXY.SERVER_ERESP.MAX.WARN}.</description><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><uuid>b0a39c6bdf7b4db0a27fce9c0e08aecb</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Number of responses with codes 1xx per second</name><type>DEPENDENT</type><key>haproxy.server.hrsp_1xx.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of informational HTTP responses per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].hrsp_1xx.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>responses</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags></item_prototype><item_prototype><uuid>786330b63708432c963725c83fa1791e</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Number of responses with codes 2xx per second</name><type>DEPENDENT</type><key>haproxy.server.hrsp_2xx.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of successful HTTP responses per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].hrsp_2xx.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>responses</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags></item_prototype><item_prototype><uuid>1a96152c277d4018acced2f9d9ffd6cd</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Number of responses with codes 3xx per second</name><type>DEPENDENT</type><key>haproxy.server.hrsp_3xx.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of HTTP redirections per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].hrsp_3xx.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>responses</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags></item_prototype><item_prototype><uuid>66076fc3a6fc401cb1423fb015dfe187</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Number of responses with codes 4xx per second</name><type>DEPENDENT</type><key>haproxy.server.hrsp_4xx.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of HTTP client errors per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].hrsp_4xx.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>responses</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags></item_prototype><item_prototype><uuid>631d2471fc7346a5b0ce8379a400f13e</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Number of responses with codes 5xx per second</name><type>DEPENDENT</type><key>haproxy.server.hrsp_5xx.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of HTTP server errors per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].hrsp_5xx.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>responses</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags></item_prototype><item_prototype><uuid>ff7d8b0633ce4e119ad2f8976ce0ea18</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Server was selected per second</name><type>DEPENDENT</type><key>haproxy.server.lbtot.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of times that server was selected.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].lbtot.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags></item_prototype><item_prototype><uuid>0bc4c4f25d00423b9dc188c9dbe34db0</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Unassigned requests</name><type>DEPENDENT</type><key>haproxy.server.qcur[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><description>Current number of requests unassigned in queue.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].qcur.first()</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>requests</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>24e803eab76244d38ff90f2fce396b7f</uuid><expression>min(/HAProxy by HTTP/haproxy.server.qcur[{#PXNAME},{#SVNAME}],5m)&gt;{$HAPROXY.SERVER_QCUR.MAX.WARN}</expression><name>HAProxy {#PXNAME} {#SVNAME}: Current number of requests unassigned in queue is high</name><event_name>HAProxy {#PXNAME} {#SVNAME}: Current number of requests unassigned in queue is more than {$HAPROXY.SERVER_QCUR.MAX.WARN} for 5m</event_name><priority>WARNING</priority><description>Current number of requests unassigned in queue is more than {$HAPROXY.SERVER_QCUR.MAX.WARN}.</description><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><uuid>d2d92c67b546498d929b1e38b7a48561</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Configured maxqueue</name><type>DEPENDENT</type><key>haproxy.server.qlimit[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><description>Configured maxqueue for the server, or nothing in the value is 0 (default, meaning no limit).</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].qlimit.first()</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>6h</parameter></parameters></step><step><type>MATCHES_REGEX</type><parameters><parameter>^\d+$</parameter></parameters><error_handler>CUSTOM_VALUE</error_handler><error_handler_params>0</error_handler_params></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>queues</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags></item_prototype><item_prototype><uuid>aa3b73b8d06a463f84b10621461c1577</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Time in queue</name><type>DEPENDENT</type><key>haproxy.server.qtime[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>s</units><description>Average time spent in queue (in ms) for the last 1,024 requests.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].qtime.first()</parameter></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>0.001</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>requests</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>f6d92dc0d2334ca4a7a4c0c81f60c44c</uuid><expression>min(/HAProxy by HTTP/haproxy.server.qtime[{#PXNAME},{#SVNAME}],5m)&gt;{$HAPROXY.SERVER_QTIME.MAX.WARN}</expression><name>HAProxy {#PXNAME} {#SVNAME}: Average time spent in queue is high</name><event_name>HAProxy {#PXNAME} {#SVNAME}: Average time spent in queue is more than {$HAPROXY.SERVER_QTIME.MAX.WARN} for 5m</event_name><priority>WARNING</priority><description>Average time spent in queue (in ms) for the last 1,024 requests is more than {$HAPROXY.SERVER_QTIME.MAX.WARN}.</description><tags><tag><tag>scope</tag><value>performance</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><uuid>f790d237b494452a9b77b4f002a7ca46</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Responses time</name><type>DEPENDENT</type><key>haproxy.server.rtime[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><units>s</units><description>Average server response time (in ms) for the last 1,024 requests.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].rtime.first()</parameter></parameters></step><step><type>MULTIPLIER</type><parameters><parameter>0.001</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>health</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>5a0444417ebf47cab0218e8407f04354</uuid><expression>min(/HAProxy by HTTP/haproxy.server.rtime[{#PXNAME},{#SVNAME}],5m)&gt;{$HAPROXY.SERVER_RTIME.MAX.WARN}</expression><name>HAProxy {#PXNAME} {#SVNAME}: Average response time is high</name><event_name>HAProxy {#PXNAME} {#SVNAME}: Average response time is more than {$HAPROXY.SERVER_RTIME.MAX.WARN} for 5m</event_name><priority>WARNING</priority><description>Average server response time (in ms) for the last 1,024 requests is more than {$HAPROXY.SERVER_RTIME.MAX.WARN}.</description><tags><tag><tag>scope</tag><value>performance</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><uuid>80ceac1d54e94e50988bf205318392a8</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Status</name><type>DEPENDENT</type><key>haproxy.server.status[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><trends>0</trends><value_type>CHAR</value_type><valuemap><name>Service state</name></valuemap><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].status.first()</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>10m</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>health</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>ccf6dbe8970f4f9f9223027e676aa57e</uuid><expression>count(/HAProxy by HTTP/haproxy.server.status[{#PXNAME},{#SVNAME}],#5,&quot;eq&quot;,&quot;DOWN&quot;)=5</expression><name>HAProxy {#PXNAME} {#SVNAME}: Server is DOWN</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><description>Server is not available.</description><tags><tag><tag>scope</tag><value>avialability</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><uuid>10cfb75db0ef4a9fb33670480303522b</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Sessions per second</name><type>DEPENDENT</type><key>haproxy.server.stot.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Cumulative number of sessions (end-to-end connections) per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].stot.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>sessions</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags></item_prototype><item_prototype><uuid>b8b0e8b0c3904335aa391f0727aac871</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Weight</name><type>DEPENDENT</type><key>haproxy.server.weight[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><description>Effective weight.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].weight.first()</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>balancer</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags></item_prototype><item_prototype><uuid>d7419ca33427455688a08ecff8ad6fb0</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Redispatched requests per second</name><type>DEPENDENT</type><key>haproxy.server.wredis.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of times a request was redispatched to a different backend.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].wredis.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>requests</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags></item_prototype><item_prototype><uuid>96cfadc919d8457ebb7519e11ac93d79</uuid><name>HAProxy {#PXNAME} {#SVNAME}: Retried connections per second</name><type>DEPENDENT</type><key>haproxy.server.wretr.rate[{#PXNAME},{#SVNAME}]</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>Number of times a connection was retried.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.[?(@.pxname == '{#PXNAME}' &amp;&amp; @.svname == '{#SVNAME}')].wretr.first()</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>haproxy.get</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag><tag><tag>server</tag><value>{#PXNAME}</value></tag><tag><tag>service</tag><value>{#SVNAME}</value></tag></tags></item_prototype></item_prototypes><graph_prototypes><graph_prototype><uuid>b7170d909b78413daa7057320d4280d8</uuid><name>HAProxy: {#PXNAME} {#SVNAME} In/Out traffic</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>HAProxy by HTTP</host><key>haproxy.server.bin.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>1</sortorder><drawtype>GRADIENT_LINE</drawtype><color>2774A4</color><item><host>HAProxy by HTTP</host><key>haproxy.server.bout.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item></graph_items></graph_prototype><graph_prototype><uuid>d9b0d6babaf04daa942f121aab2d5b9c</uuid><name>HAProxy: {#PXNAME} {#SVNAME} Responses by HTTP code</name><type>STACKED</type><graph_items><graph_item><color>1A7C11</color><item><host>HAProxy by HTTP</host><key>haproxy.server.hrsp_1xx.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>HAProxy by HTTP</host><key>haproxy.server.hrsp_2xx.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>HAProxy by HTTP</host><key>haproxy.server.hrsp_3xx.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>3</sortorder><color>A54F10</color><item><host>HAProxy by HTTP</host><key>haproxy.server.hrsp_4xx.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>4</sortorder><color>FC6EA3</color><item><host>HAProxy by HTTP</host><key>haproxy.server.hrsp_5xx.rate[{#PXNAME},{#SVNAME}]</key></item></graph_item></graph_items></graph_prototype><graph_prototype><uuid>5e1c8f6bf6c04ef6a60ce221c44c6ab6</uuid><name>HAProxy: {#PXNAME} {#SVNAME} Response time and time in queue</name><graph_items><graph_item><color>1A7C11</color><item><host>HAProxy by HTTP</host><key>haproxy.server.rtime[{#PXNAME},{#SVNAME}]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>HAProxy by HTTP</host><key>haproxy.server.qtime[{#PXNAME},{#SVNAME}]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes><master_item><key>haproxy.get.nodes</key></master_item><lld_macro_paths><lld_macro_path><lld_macro>{#MODE}</lld_macro><path>$.mode</path></lld_macro_path><lld_macro_path><lld_macro>{#PXNAME}</lld_macro><path>$.pxname</path></lld_macro_path><lld_macro_path><lld_macro>{#SVNAME}</lld_macro><path>$.svname</path></lld_macro_path></lld_macro_paths><overrides><override><name>Discard HTTP status codes</name><step>1</step><filter><conditions><condition><macro>{#MODE}</macro><value>tcp</value><formulaid>A</formulaid></condition></conditions></filter><operations><operation><operationobject>ITEM_PROTOTYPE</operationobject><operator>LIKE</operator><value>Number of responses with codes</value><status>ENABLED</status><discover>NO_DISCOVER</discover></operation></operations></override></overrides></discovery_rule></discovery_rules><tags><tag><tag>class</tag><value>software</value></tag><tag><tag>target</tag><value>haproxy</value></tag></tags><macros><macro><macro>{$HAPROXY.BACK_ERESP.MAX.WARN}</macro><value>10</value><description>Maximum of responses with error on Backend for trigger expression.</description></macro><macro><macro>{$HAPROXY.BACK_QCUR.MAX.WARN}</macro><value>10</value><description>Maximum number of requests on Backend unassigned in queue for trigger expression.</description></macro><macro><macro>{$HAPROXY.BACK_QTIME.MAX.WARN}</macro><value>10s</value><description>Maximum of average time spent in queue on Backend for trigger expression.</description></macro><macro><macro>{$HAPROXY.BACK_RTIME.MAX.WARN}</macro><value>10s</value><description>Maximum of average Backend response time for trigger expression.</description></macro><macro><macro>{$HAPROXY.FRONT_DREQ.MAX.WARN}</macro><value>10</value><description>The HAProxy maximum denied requests for trigger expression.</description></macro><macro><macro>{$HAPROXY.FRONT_EREQ.MAX.WARN}</macro><value>10</value><description>The HAProxy maximum number of request errors for trigger expression.</description></macro><macro><macro>{$HAPROXY.FRONT_SUTIL.MAX.WARN}</macro><value>80</value><description>Maximum of session usage percentage on frontend for trigger expression.</description></macro><macro><macro>{$HAPROXY.PASSWORD}</macro><description>The password of the HAProxy stats page.</description></macro><macro><macro>{$HAPROXY.RESPONSE_TIME.MAX.WARN}</macro><value>10s</value><description>The HAProxy stats page maximum response time in seconds for trigger expression.</description></macro><macro><macro>{$HAPROXY.SERVER_ERESP.MAX.WARN}</macro><value>10</value><description>Maximum of responses with error on server for trigger expression.</description></macro><macro><macro>{$HAPROXY.SERVER_QCUR.MAX.WARN}</macro><value>10</value><description>Maximum number of requests on server unassigned in queue for trigger expression.</description></macro><macro><macro>{$HAPROXY.SERVER_QTIME.MAX.WARN}</macro><value>10s</value><description>Maximum of average time spent in queue on server for trigger expression.</description></macro><macro><macro>{$HAPROXY.SERVER_RTIME.MAX.WARN}</macro><value>10s</value><description>Maximum of average server response time for trigger expression.</description></macro><macro><macro>{$HAPROXY.STATS.PATH}</macro><value>stats</value><description>The path of the HAProxy stats page.</description></macro><macro><macro>{$HAPROXY.STATS.PORT}</macro><value>8404</value><description>The port of the HAProxy stats host or container.</description></macro><macro><macro>{$HAPROXY.STATS.SCHEME}</macro><value>http</value><description>The scheme of HAProxy stats page(http/https).</description></macro><macro><macro>{$HAPROXY.USERNAME}</macro><description>The username of the HAProxy stats page.</description></macro></macros><dashboards><dashboard><uuid>7910c0c96e014d68966c5ac989e9ebb7</uuid><name>HAProxy Backend performance</name><pages><page><widgets><widget><type>GRAPH_PROTOTYPE</type><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>2</value></field><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>GRAPH_PROTOTYPE</type><name>graphid</name><value><host>HAProxy by HTTP</host><name>HAProxy: Backend {#PXNAME} Redispatched requests and retried connections per second</name></value></field></fields></widget><widget><type>GRAPH_PROTOTYPE</type><y>5</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>2</value></field><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>GRAPH_PROTOTYPE</type><name>graphid</name><value><host>HAProxy by HTTP</host><name>HAProxy: Backend {#PXNAME} Responses by HTTP code</name></value></field></fields></widget><widget><type>GRAPH_PROTOTYPE</type><y>10</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>2</value></field><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>GRAPH_PROTOTYPE</type><name>graphid</name><value><host>HAProxy by HTTP</host><name>HAProxy: Backend {#PXNAME} In/Out traffic</name></value></field></fields></widget></widgets></page></pages></dashboard><dashboard><uuid>d6ba5079de1c49bb9e0e5c47112b3ff9</uuid><name>HAProxy Frontend performance</name><pages><page><widgets><widget><type>GRAPH_PROTOTYPE</type><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>2</value></field><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>GRAPH_PROTOTYPE</type><name>graphid</name><value><host>HAProxy by HTTP</host><name>HAProxy: Frontend {#PXNAME} Requests and sessions per second</name></value></field></fields></widget><widget><type>GRAPH_PROTOTYPE</type><y>5</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>2</value></field><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>GRAPH_PROTOTYPE</type><name>graphid</name><value><host>HAProxy by HTTP</host><name>HAProxy: Frontend {#PXNAME} Errors and denials per second</name></value></field></fields></widget><widget><type>GRAPH_PROTOTYPE</type><y>10</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>2</value></field><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>GRAPH_PROTOTYPE</type><name>graphid</name><value><host>HAProxy by HTTP</host><name>HAProxy: Frontend {#PXNAME} Responses by HTTP code</name></value></field></fields></widget><widget><type>GRAPH_PROTOTYPE</type><y>15</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>2</value></field><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>GRAPH_PROTOTYPE</type><name>graphid</name><value><host>HAProxy by HTTP</host><name>HAProxy: Frontend {#PXNAME} In/Out traffic</name></value></field></fields></widget></widgets></page></pages></dashboard><dashboard><uuid>f41c3a3976dc483d98a386273ab5678f</uuid><name>HAProxy Server performance</name><pages><page><widgets><widget><type>GRAPH_PROTOTYPE</type><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>2</value></field><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>GRAPH_PROTOTYPE</type><name>graphid</name><value><host>HAProxy by HTTP</host><name>HAProxy: {#PXNAME} {#SVNAME} Response time and time in queue</name></value></field></fields></widget><widget><type>GRAPH_PROTOTYPE</type><y>5</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>2</value></field><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>GRAPH_PROTOTYPE</type><name>graphid</name><value><host>HAProxy by HTTP</host><name>HAProxy: {#PXNAME} {#SVNAME} Responses by HTTP code</name></value></field></fields></widget><widget><type>GRAPH_PROTOTYPE</type><y>10</y><width>24</width><height>5</height><fields><field><type>INTEGER</type><name>source_type</name><value>2</value></field><field><type>INTEGER</type><name>columns</name><value>1</value></field><field><type>INTEGER</type><name>rows</name><value>1</value></field><field><type>GRAPH_PROTOTYPE</type><name>graphid</name><value><host>HAProxy by HTTP</host><name>HAProxy: {#PXNAME} {#SVNAME} In/Out traffic</name></value></field></fields></widget></widgets></page></pages></dashboard></dashboards><valuemaps><valuemap><uuid>450c1b2c6d58432b8a5b34dd3b5e8870</uuid><name>Server mode</name><mappings><mapping><value>0</value><newvalue>-</newvalue></mapping><mapping><value>1</value><newvalue>Y</newvalue></mapping></mappings></valuemap><valuemap><uuid>a8a0c20f1d404a79900064ac5d11a8b2</uuid><name>Service state</name><mappings><mapping><value>0</value><newvalue>Down</newvalue></mapping><mapping><value>1</value><newvalue>Up</newvalue></mapping></mappings></valuemap></valuemaps></template></templates></zabbix_export>
