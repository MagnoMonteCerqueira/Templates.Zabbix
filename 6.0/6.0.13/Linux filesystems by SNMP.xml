<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>6.0</version><date>2023-02-11T16:14:41Z</date><groups><group><uuid>57b7ae836ca64446ba2c296389c009b7</uuid><name>Templates/Modules</name></group></groups><templates><template><uuid>cbaf0383cb934294ac53a28ddfd49434</uuid><template>Linux filesystems by SNMP</template><name>Linux filesystems by SNMP</name><description>MIBs used:
HOST-RESOURCES-MIB
UCD-SNMP-MIB

Template tooling version used: 0.41</description><groups><group><name>Templates/Modules</name></group></groups><discovery_rules><discovery_rule><uuid>c55b2f96bd50421482dfcc230e6de01e</uuid><name>Mounted filesystem discovery</name><type>SNMP_AGENT</type><snmp_oid>discovery[{#FSNAME},1.3.6.1.2.1.25.2.3.1.3,{#FSTYPE},1.3.6.1.2.1.25.2.3.1.2,{#ALLOC_UNITS},1.3.6.1.2.1.25.2.3.1.4]</snmp_oid><key>vfs.fs.discovery[snmp]</key><delay>1h</delay><filter><evaltype>AND</evaltype><conditions><condition><macro>{#FSTYPE}</macro><value>{$VFS.FS.FSTYPE.MATCHES}</value><formulaid>C</formulaid></condition><condition><macro>{#FSTYPE}</macro><value>{$VFS.FS.FSTYPE.NOT_MATCHES}</value><operator>NOT_MATCHES_REGEX</operator><formulaid>D</formulaid></condition><condition><macro>{#FSNAME}</macro><value>{$VFS.FS.FSNAME.MATCHES}</value><formulaid>A</formulaid></condition><condition><macro>{#FSNAME}</macro><value>{$VFS.FS.FSNAME.NOT_MATCHES}</value><operator>NOT_MATCHES_REGEX</operator><formulaid>B</formulaid></condition></conditions></filter><description>HOST-RESOURCES-MIB::hrStorage discovery with storage filter</description><item_prototypes><item_prototype><uuid>5c0b2605afe84c288207c04b9946dfbf</uuid><name>{#FSNAME}: Free inodes in %</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.2021.9.1.10[&quot;index&quot;,&quot;1.3.6.1.4.1.2021.9.1.2&quot;, &quot;{#FSNAME}&quot;]</snmp_oid><key>vfs.fs.inode.pfree[dskPercentNode.{#SNMPINDEX}]</key><history>7d</history><value_type>FLOAT</value_type><units>%</units><description>MIB: UCD-SNMP-MIB
If having problems collecting this item make sure access to UCD-SNMP-MIB is allowed.</description><preprocessing><step><type>JAVASCRIPT</type><parameters><parameter>return (100-value);</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>storage</value></tag><tag><tag>filesystem</tag><value>{#FSNAME}</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>377f4ffa529f4b0690a11228f4021294</uuid><expression>min(/Linux filesystems by SNMP/vfs.fs.inode.pfree[dskPercentNode.{#SNMPINDEX}],5m)&lt;{$VFS.FS.INODE.PFREE.MIN.CRIT:&quot;{#FSNAME}&quot;}</expression><name>{#FSNAME}: Running out of free inodes</name><event_name>{#FSNAME}: Running out of free inodes (free &lt; {$VFS.FS.INODE.PFREE.MIN.CRIT:&quot;{#FSNAME}&quot;}%)</event_name><opdata>Free inodes: {ITEM.LASTVALUE1}</opdata><priority>AVERAGE</priority><description>It may become impossible to write to disk if there are no index nodes left.
As symptoms, 'No space left on device' or 'Disk is full' errors may be seen even though free space is available.</description><tags><tag><tag>scope</tag><value>capacity</value></tag><tag><tag>scope</tag><value>performance</value></tag></tags></trigger_prototype><trigger_prototype><uuid>5f80199affa44ed7a6b875c49ca00aa7</uuid><expression>min(/Linux filesystems by SNMP/vfs.fs.inode.pfree[dskPercentNode.{#SNMPINDEX}],5m)&lt;{$VFS.FS.INODE.PFREE.MIN.WARN:&quot;{#FSNAME}&quot;}</expression><name>{#FSNAME}: Running out of free inodes</name><event_name>{#FSNAME}: Running out of free inodes (free &lt; {$VFS.FS.INODE.PFREE.MIN.WARN:&quot;{#FSNAME}&quot;}%)</event_name><opdata>Free inodes: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><description>It may become impossible to write to disk if there are no index nodes left.
As symptoms, 'No space left on device' or 'Disk is full' errors may be seen even though free space is available.</description><dependencies><dependency><name>{#FSNAME}: Running out of free inodes</name><expression>min(/Linux filesystems by SNMP/vfs.fs.inode.pfree[dskPercentNode.{#SNMPINDEX}],5m)&lt;{$VFS.FS.INODE.PFREE.MIN.CRIT:&quot;{#FSNAME}&quot;}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>capacity</value></tag><tag><tag>scope</tag><value>performance</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype><item_prototype><uuid>3cc99f32a3a44b2a94c2bab5f2765c8e</uuid><name>{#FSNAME}: Space utilization</name><type>CALCULATED</type><key>vfs.fs.pused[storageUsedPercentage.{#SNMPINDEX}]</key><history>7d</history><value_type>FLOAT</value_type><units>%</units><params>(last(//vfs.fs.used[hrStorageUsed.{#SNMPINDEX}])/last(//vfs.fs.total[hrStorageSize.{#SNMPINDEX}]))*100</params><description>Space utilization in % for {#FSNAME}</description><tags><tag><tag>component</tag><value>storage</value></tag><tag><tag>filesystem</tag><value>{#FSNAME}</value></tag></tags></item_prototype><item_prototype><uuid>9e9b2eb864164eebb4825ba0331b0b95</uuid><name>{#FSNAME}: Total space</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.2.1.25.2.3.1.5.{#SNMPINDEX}</snmp_oid><key>vfs.fs.total[hrStorageSize.{#SNMPINDEX}]</key><history>7d</history><units>B</units><description>MIB: HOST-RESOURCES-MIB
The size of the storage represented by this entry, in units of hrStorageAllocationUnits.
This object is writable to allow remote configuration of the size of the storage area in those cases where such an operation makes sense and is possible on the underlying system.
For example, the amount of main storage allocated to a buffer pool might be modified or the amount of disk space allocated to virtual storage might be modified.</description><preprocessing><step><type>MULTIPLIER</type><parameters><parameter>{#ALLOC_UNITS}</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>storage</value></tag><tag><tag>filesystem</tag><value>{#FSNAME}</value></tag></tags></item_prototype><item_prototype><uuid>2cfbdae09907476ea6d73af86338f279</uuid><name>{#FSNAME}: Used space</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.2.1.25.2.3.1.6.{#SNMPINDEX}</snmp_oid><key>vfs.fs.used[hrStorageUsed.{#SNMPINDEX}]</key><history>7d</history><units>B</units><description>MIB: HOST-RESOURCES-MIB
The amount of the storage represented by this entry that is allocated, in units of hrStorageAllocationUnits.</description><preprocessing><step><type>MULTIPLIER</type><parameters><parameter>{#ALLOC_UNITS}</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>storage</value></tag><tag><tag>filesystem</tag><value>{#FSNAME}</value></tag></tags></item_prototype></item_prototypes><trigger_prototypes><trigger_prototype><uuid>ae3535ef3f674dccb6c809dc7d01172c</uuid><expression>last(/Linux filesystems by SNMP/vfs.fs.pused[storageUsedPercentage.{#SNMPINDEX}])&gt;{$VFS.FS.PUSED.MAX.CRIT:&quot;{#FSNAME}&quot;} and
((last(/Linux filesystems by SNMP/vfs.fs.total[hrStorageSize.{#SNMPINDEX}])-last(/Linux filesystems by SNMP/vfs.fs.used[hrStorageUsed.{#SNMPINDEX}]))&lt;{$VFS.FS.FREE.MIN.CRIT:&quot;{#FSNAME}&quot;} or timeleft(/Linux filesystems by SNMP/vfs.fs.pused[storageUsedPercentage.{#SNMPINDEX}],1h,100)&lt;1d)</expression><name>{#FSNAME}: Disk space is critically low</name><event_name>{#FSNAME}: Disk space is critically low (used &gt; {$VFS.FS.PUSED.MAX.CRIT:&quot;{#FSNAME}&quot;}%)</event_name><opdata>Space used: {ITEM.LASTVALUE3} of {ITEM.LASTVALUE2} ({ITEM.LASTVALUE1})</opdata><priority>AVERAGE</priority><description>Two conditions should match: First, space utilization should be above {$VFS.FS.PUSED.MAX.CRIT:&quot;{#FSNAME}&quot;}.
 Second condition should be one of the following:
 - The disk free space is less than {$VFS.FS.FREE.MIN.CRIT:&quot;{#FSNAME}&quot;}.
 - The disk will be full in less than 24 hours.</description><manual_close>YES</manual_close><tags><tag><tag>scope</tag><value>availability</value></tag><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger_prototype><trigger_prototype><uuid>3bef4897bcd549288203241c5ca9f017</uuid><expression>last(/Linux filesystems by SNMP/vfs.fs.pused[storageUsedPercentage.{#SNMPINDEX}])&gt;{$VFS.FS.PUSED.MAX.WARN:&quot;{#FSNAME}&quot;} and
((last(/Linux filesystems by SNMP/vfs.fs.total[hrStorageSize.{#SNMPINDEX}])-last(/Linux filesystems by SNMP/vfs.fs.used[hrStorageUsed.{#SNMPINDEX}]))&lt;{$VFS.FS.FREE.MIN.WARN:&quot;{#FSNAME}&quot;} or timeleft(/Linux filesystems by SNMP/vfs.fs.pused[storageUsedPercentage.{#SNMPINDEX}],1h,100)&lt;1d)</expression><name>{#FSNAME}: Disk space is low</name><event_name>{#FSNAME}: Disk space is low (used &gt; {$VFS.FS.PUSED.MAX.WARN:&quot;{#FSNAME}&quot;}%)</event_name><opdata>Space used: {ITEM.LASTVALUE3} of {ITEM.LASTVALUE2} ({ITEM.LASTVALUE1})</opdata><priority>WARNING</priority><description>Two conditions should match: First, space utilization should be above {$VFS.FS.PUSED.MAX.WARN:&quot;{#FSNAME}&quot;}.
 Second condition should be one of the following:
 - The disk free space is less than {$VFS.FS.FREE.MIN.WARN:&quot;{#FSNAME}&quot;}.
 - The disk will be full in less than 24 hours.</description><manual_close>YES</manual_close><dependencies><dependency><name>{#FSNAME}: Disk space is critically low</name><expression>last(/Linux filesystems by SNMP/vfs.fs.pused[storageUsedPercentage.{#SNMPINDEX}])&gt;{$VFS.FS.PUSED.MAX.CRIT:&quot;{#FSNAME}&quot;} and
((last(/Linux filesystems by SNMP/vfs.fs.total[hrStorageSize.{#SNMPINDEX}])-last(/Linux filesystems by SNMP/vfs.fs.used[hrStorageUsed.{#SNMPINDEX}]))&lt;{$VFS.FS.FREE.MIN.CRIT:&quot;{#FSNAME}&quot;} or timeleft(/Linux filesystems by SNMP/vfs.fs.pused[storageUsedPercentage.{#SNMPINDEX}],1h,100)&lt;1d)</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>availability</value></tag><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger_prototype></trigger_prototypes><graph_prototypes><graph_prototype><uuid>f1000d7a017f4954a32103b345ae4fdf</uuid><name>{#FSNAME}: Disk space usage</name><width>600</width><height>340</height><type>PIE</type><show_3d>YES</show_3d><graph_items><graph_item><color>969696</color><calc_fnc>LAST</calc_fnc><type>GRAPH_SUM</type><item><host>Linux filesystems by SNMP</host><key>vfs.fs.total[hrStorageSize.{#SNMPINDEX}]</key></item></graph_item><graph_item><sortorder>1</sortorder><color>C80000</color><calc_fnc>LAST</calc_fnc><item><host>Linux filesystems by SNMP</host><key>vfs.fs.used[hrStorageUsed.{#SNMPINDEX}]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes></discovery_rule></discovery_rules><macros><macro><macro>{$VFS.FS.FREE.MIN.CRIT}</macro><value>5G</value><description>The critical threshold of the filesystem utilization.</description></macro><macro><macro>{$VFS.FS.FREE.MIN.WARN}</macro><value>10G</value><description>The warning threshold of the filesystem utilization.</description></macro><macro><macro>{$VFS.FS.FSNAME.MATCHES}</macro><value>.+</value><description>This macro is used in filesystems discovery. Can be overridden on the host or linked template level</description></macro><macro><macro>{$VFS.FS.FSNAME.NOT_MATCHES}</macro><value>^(/dev|/sys|/run|/proc|.+/shm$)</value><description>This macro is used in filesystems discovery. Can be overridden on the host or linked template level</description></macro><macro><macro>{$VFS.FS.FSTYPE.MATCHES}</macro><value>.*(\.4|\.9|hrStorageFixedDisk|hrStorageFlashMemory)$</value><description>This macro is used in filesystems discovery. Can be overridden on the host or linked template level</description></macro><macro><macro>{$VFS.FS.FSTYPE.NOT_MATCHES}</macro><value>^\s$</value><description>This macro is used in filesystems discovery. Can be overridden on the host or linked template level</description></macro><macro><macro>{$VFS.FS.INODE.PFREE.MIN.CRIT}</macro><value>10</value></macro><macro><macro>{$VFS.FS.INODE.PFREE.MIN.WARN}</macro><value>20</value></macro><macro><macro>{$VFS.FS.PUSED.MAX.CRIT}</macro><value>90</value></macro><macro><macro>{$VFS.FS.PUSED.MAX.WARN}</macro><value>80</value></macro></macros></template></templates></zabbix_export>
