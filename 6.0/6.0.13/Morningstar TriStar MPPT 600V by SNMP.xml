<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>6.0</version><date>2023-02-11T16:14:50Z</date><groups><group><uuid>36bff6c29af64692839d077febfc7079</uuid><name>Templates/Network devices</name></group></groups><templates><template><uuid>2d20a2fbd540492089fdcafc8feb60e3</uuid><template>Morningstar TriStar MPPT 600V by SNMP</template><name>Morningstar TriStar MPPT 600V by SNMP</name><description>MIBs used:
TRISTAR-MPPT

Template tooling version used: 0.41</description><groups><group><name>Templates/Network devices</name></group></groups><items><item><uuid>2e83c42d78e8486f936733e3cb6dee6b</uuid><name>Array: Array Current</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.7.31.0</snmp_oid><key>array.current[arrayCurrent.0]</key><history>7d</history><value_type>FLOAT</value_type><units>A</units><description>MIB: TRISTAR-MPPT
Description:Array Current
Scaling Factor:1.0
Units:A
Range:[-10, 80]
Modbus address:0x001d</description><tags><tag><tag>component</tag><value>array</value></tag></tags></item><item><uuid>9750ce4073d9467fa18f0e35f990c081</uuid><name>Array: Sweep Pmax</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.7.33.0</snmp_oid><key>array.sweep_pmax[arrayPmaxLastSweep.0]</key><history>7d</history><value_type>FLOAT</value_type><units>W</units><description>MIB: TRISTAR-MPPT
Description:Pmax (last sweep)
Scaling Factor:1.0
Units:W
Range:[-10, 5000]
Modbus address:0x003c</description><tags><tag><tag>component</tag><value>array</value></tag></tags></item><item><uuid>de36a1087b2d4ade8369c620c794c881</uuid><name>Array: Sweep Vmp</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.7.34.0</snmp_oid><key>array.sweep_vmp[arrayVmpLastSweep.0]</key><history>7d</history><value_type>FLOAT</value_type><units>V</units><description>MIB: TRISTAR-MPPT
Description:Vmp (last sweep)
Scaling Factor:1.0
Units:V
Range:[-10, 650.0]
Modbus address:0x003d</description><tags><tag><tag>component</tag><value>array</value></tag></tags></item><item><uuid>a8f4819131fe4247aef9b1cd819b47d9</uuid><name>Array: Sweep Voc</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.7.35.0</snmp_oid><key>array.sweep_voc[arrayVocLastSweep.0]</key><history>7d</history><value_type>FLOAT</value_type><units>V</units><description>MIB: TRISTAR-MPPT
Description:Voc (last sweep)
Scaling Factor:1.0
Units:V
Range:[-10, 650.0]
Modbus address:0x003e</description><tags><tag><tag>component</tag><value>array</value></tag></tags></item><item><uuid>e13c3135ce8649ea9c88d4f9eb56219e</uuid><name>Array: Voltage</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.7.30.0</snmp_oid><key>array.voltage[arrayVoltage.0]</key><history>7d</history><value_type>FLOAT</value_type><units>V</units><description>MIB: TRISTAR-MPPT
Description:Array Voltage
Scaling Factor:1.0
Units:V
Range:[-10, 650]
Modbus address:0x001b</description><tags><tag><tag>component</tag><value>array</value></tag></tags></item><item><uuid>058dc403d9b541978aebcb2944ecf75f</uuid><name>Battery: Battery Voltage discovery</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.7.36.0</snmp_oid><key>battery.voltage.discovery[batteryVoltage.0]</key><delay>15m</delay><history>0</history><value_type>FLOAT</value_type><units>V</units><description>MIB: TRISTAR-MPPT
Description:Battery voltage
Scaling Factor:1.0
Units:V
Range:[-10, 80]
Modbus address:0x0018</description><tags><tag><tag>component</tag><value>battery</value></tag><tag><tag>component</tag><value>discovery</value></tag><tag><tag>component</tag><value>raw</value></tag></tags></item><item><uuid>5e42ba3c9a764b9690feb04d4bf7df45</uuid><name>Battery: Charge Current</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.7.42.0</snmp_oid><key>charge.current[batteryCurrent.0]</key><history>7d</history><value_type>FLOAT</value_type><units>A</units><description>MIB: TRISTAR-MPPT
Description:Battery Current
Scaling Factor:1.0
Units:A
Range:[-10, 80]
Modbus address:0x001c</description><tags><tag><tag>component</tag><value>battery</value></tag></tags></item><item><uuid>6e168ff947324068aad1fc16d577369d</uuid><name>Battery: Output Power</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.7.44.0</snmp_oid><key>charge.output_power[ outputPower.0]</key><history>7d</history><value_type>FLOAT</value_type><units>W</units><description>MIB: TRISTAR-MPPT
Description:Output Power
Scaling Factor:1.0
Units:W
Range:[-10, 4000]
Modbus address:0x003a</description><tags><tag><tag>component</tag><value>battery</value></tag></tags></item><item><uuid>aa20a89288c444a492910cb1a7f19499</uuid><name>Battery: Charge State</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.7.46.0</snmp_oid><key>charge.state[chargeState.0]</key><history>7d</history><value_type>FLOAT</value_type><description>MIB: TRISTAR-MPPT
Description:Charge State
Modbus address:0x0032

0: Start
1: NightCheck
2: Disconnect
3: Night
4: Fault
5: Mppt
6: Absorption
7: Float
8: Equalize
9: Slave
10: Fixed</description><valuemap><name>TriStar MPPT 600V charge state</name></valuemap><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>battery</value></tag></tags><triggers><trigger><uuid>ed2b56b78fce47f88b679774640706b5</uuid><expression>last(/Morningstar TriStar MPPT 600V by SNMP/charge.state[chargeState.0])={$CHARGE.STATE.CRIT}</expression><name>Battery: Device charge in critical state</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>6f21bda91cc640809f0f4faf04ba86f4</uuid><expression>last(/Morningstar TriStar MPPT 600V by SNMP/charge.state[chargeState.0])={$CHARGE.STATE.WARN}</expression><name>Battery: Device charge in warning state</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><dependencies><dependency><name>Battery: Device charge in critical state</name><expression>last(/Morningstar TriStar MPPT 600V by SNMP/charge.state[chargeState.0])={$CHARGE.STATE.CRIT}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>3d67ceefb2c443d38051e2d22aca45ce</uuid><name>Counter: Charge Amp-hours</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.7.50.0</snmp_oid><key>counter.charge_amp_hours[ahChargeResetable.0]</key><history>7d</history><value_type>FLOAT</value_type><units>Ah</units><description>MIB: TRISTAR-MPPT
Description:Ah Charge Resettable
Scaling Factor:1.0
Units:Ah
Range:[0.0, 5000]
Modbus addresses:H=0x0034 L=0x0035</description><tags><tag><tag>component</tag><value>counter</value></tag></tags></item><item><uuid>1a7ff2c884784eb4817956e0ecd5b718</uuid><name>Counter: Charge KW-hours</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.7.52.0</snmp_oid><key>counter.charge_kw_hours[kwhChargeResetable.0]</key><history>7d</history><value_type>FLOAT</value_type><units>!kWh</units><description>MIB: TRISTAR-MPPT
Description:kWh Charge Resettable
Scaling Factor:1.0
Units:kWh
Range:[0.0, 65535.0]
Modbus address:0x0038</description><tags><tag><tag>component</tag><value>counter</value></tag></tags></item><item><uuid>a2b5a78fe649480ea0cc580b5fa30bde</uuid><name>Status: Alarms</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.7.57.0</snmp_oid><key>status.alarms[alarms.0]</key><history>1h</history><trends>0</trends><value_type>TEXT</value_type><description>MIB: TRISTAR-MPPT
Description:Alarms
Modbus addresses:H=0x002e L=0x002f</description><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step><step><type>JAVASCRIPT</type><parameters><parameter>var FIELDS = [
  'rtsOpen',
  'rtsShorted',
  'rtsDisconnected',
  'heatsinkTempSensorOpen',
  'heatsinkTempSensorShorted',
  'highTemperatureCurrentLimit',
  'currentLimit',
  'currentOffset',
  'batterySense',
  'batterySenseDisconnected',
  'uncalibrated',
  'rtsMiswire',
  'highVoltageDisconnect',
  'undefined',
  'systemMiswire',
  'mosfetSOpen',
  'p12VoltageOutOfRange',
  'highArrayVCurrentLimit',
  'maxAdcValueReached',
  'controllerWasReset',
  'alarm21Internal',
  'p3VoltageOutOfRange',
  'derateLimit',
  'arrayCurrentOffset',
  'ee-i2cRetryLimit',
  'ethernetAlarm',
  'lvd',
  'software',
  'fp12VoltageOutOfRange',
  'extflashFault',
  'slaveControlFault',
  'alarm32Undefined'
];

var flags = parseInt(value.replace(/\x20/g, ''), 16),
  result = [];

for (var i = 0, f = 1 &lt;&lt; 31 &gt;&gt;&gt; 0, l = FIELDS.length; i &lt; l; i++, f &gt;&gt;&gt;= 1) {
    if (flags &amp; f) {
        result.push(FIELDS[i]);
    }
}

return result.length ? result.join('\n') : 'No alarms';</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>status</value></tag></tags><triggers><trigger><uuid>62d1ffe8417c4ef9b746d17185d8853b</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;alarm21Internal&quot;)=2</expression><name>Status: Device has &quot;alarm21Internal&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>367d91fa49c241e795a2b497739c6f01</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;arrayCurrentOffset&quot;)=2</expression><name>Status: Device has &quot;arrayCurrentOffset&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>1c1baf4eea9e416a98bcf3e12d7ae01f</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;batterySense&quot;)=2</expression><name>Status: Device has &quot;batterySense&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>b627e79de7b446d69ee245b07f755405</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;batterySenseDisconnected&quot;)=2</expression><name>Status: Device has &quot;batterySenseDisconnected&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>73aba1af987843d98542105f2b41c5bd</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;controllerWasReset&quot;)=2</expression><name>Status: Device has &quot;controllerWasReset&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>aae5a3441b9e4394a39e7a8c5ce29e0c</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;currentLimit&quot;)=2</expression><name>Status: Device has &quot;currentLimit&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>f8e42483b1534ed586252db0c8880aa6</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;currentOffset&quot;)=2</expression><name>Status: Device has &quot;currentOffset&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>bd32be9b60334cc1b80d2de129f0f1a2</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;derateLimit&quot;)=2</expression><name>Status: Device has &quot;derateLimit&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>e0886663f4df4ff0965fac33951d4ffc</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;ee-i2cRetryLimit&quot;)=2</expression><name>Status: Device has &quot;ee-i2cRetryLimit&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>abfeb2c3c566401b9f30cd28765aacff</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;ethernetAlarm&quot;)=2</expression><name>Status: Device has &quot;ethernetAlarm&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>a0ffdbf5695d4945960df6ea7defa071</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;extflashFault&quot;)=2</expression><name>Status: Device has &quot;extflashFault&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>f92ce5a55f0a4a65beca0abb748b7c04</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;fp12VoltageOutOfRange&quot;)=2</expression><name>Status: Device has &quot;fp12VoltageOutOfRange&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>5bdcd298878a4baf97aab8df338e1123</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;heatsinkTempSensorOpen&quot;)=2</expression><name>Status: Device has &quot;heatsinkTempSensorOpen&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>9fe220d99b524db8bbfe5b511ee91fa7</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;heatsinkTempSensorShorted&quot;)=2</expression><name>Status: Device has &quot;heatsinkTempSensorShorted&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>dc8d3f71c60643b7a6a25a9d7452ce60</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;highArrayVCurrentLimit&quot;)=2</expression><name>Status: Device has &quot;highArrayVCurrentLimit&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>d279f44217b046c789c865b8b44c9342</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;highTemperatureCurrentLimit&quot;)=2</expression><name>Status: Device has &quot;highTemperatureCurrentLimit&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>b48d1c04e95c4b89a7240fc2a611a499</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;highVoltageDisconnect&quot;)=2</expression><name>Status: Device has &quot;highVoltageDisconnect&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>767be108224d43a99ac2568166c9cd33</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;lvd&quot;)=2</expression><name>Status: Device has &quot;lvd&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>107b8a4a63c146fa908f5b7ccc716258</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;maxAdcValueReached&quot;)=2</expression><name>Status: Device has &quot;maxAdcValueReached&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>5792c3702ab94123891e02ee4c05339f</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;mosfetSOpen&quot;)=2</expression><name>Status: Device has &quot;mosfetSOpen&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>a115f88a282e41179b569633234f04e2</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;p3VoltageOutOfRange&quot;)=2</expression><name>Status: Device has &quot;p3VoltageOutOfRange&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>8a3906ceae5547ca8f9c916ca46e7be8</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;p12VoltageOutOfRange&quot;)=2</expression><name>Status: Device has &quot;p12VoltageOutOfRange&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>49d3fb027a88462aa7f67442a507c051</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;rtsDisconnected&quot;)=2</expression><name>Status: Device has &quot;rtsDisconnected&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>650cf2d3c06f4c55ac90b1dd23ca25d1</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;rtsMiswire&quot;)=2</expression><name>Status: Device has &quot;rtsMiswire&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>48bb77b135c84d6a9e3792d8385f16da</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;rtsShorted&quot;)=2</expression><name>Status: Device has &quot;rtsShorted&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>7e363c7cc8ce4104a9c6269c9e94ac26</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;slaveControlFault&quot;)=2</expression><name>Status: Device has &quot;slaveControlFault&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>e1235a2201a542bb9ac67345c70641e3</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;software&quot;)=2</expression><name>Status: Device has &quot;software&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>cb5b84c99bcf45459bdc955c8604264b</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;systemMiswire&quot;)=2</expression><name>Status: Device has &quot;systemMiswire&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>72ce41657c1848d897255ad3de77d942</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.alarms[alarms.0],#3,&quot;like&quot;,&quot;uncalibrated&quot;)=2</expression><name>Status: Device has &quot;uncalibrated&quot; alarm flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>81efe20cce1b4b26a6eda83e86fbd49c</uuid><name>Status: Faults</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.7.55.0</snmp_oid><key>status.faults[faults.0]</key><history>1h</history><trends>0</trends><value_type>TEXT</value_type><description>MIB: TRISTAR-MPPT
Description:Faults
Modbus addresses:H=0x002c L=0x002d</description><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step><step><type>JAVASCRIPT</type><parameters><parameter>var FIELDS = [
  'overcurrent',
  'fetShort',
  'softwareFault',
  'batteryHvd',
  'arrayHvd',
  'dipSwitchChange',
  'customSettingsEdit',
  'rtsShorted',
  'rtsDisconnected',
  'eepromRetryLimit',
  'controllerWasReset',
  'chargeSlaveControlTimeout',
  'rs232SerialToMeterBridge',
  'batteryLvd',
  'fault14Undefined',
  'powerboardCommunicationFault',
  'fault16Software',
  'fault17Software',
  'fault18Software',
  'fault19Software',
  'fault20Software',
  'fault21Software',
  'fpgaVersion',
  'currentSensorReferenceOutOfRange',
  'ia-refSlaveModeTimeout',
  'blockbusBoot',
  'hscommMaster',
  'hscomm',
  'slave',
];

var flags = parseInt(value.replace(/\x20/g, ''), 16),
  result = [];

for (var i = 0, f = 1 &lt;&lt; 31 &gt;&gt;&gt; 0, l = FIELDS.length; i &lt; l; i++, f &gt;&gt;&gt;= 1) {
    if (flags &amp; f) {
        result.push(FIELDS[i]);
    }
}

return result.length ? result.join('\n') : 'No faults';</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>status</value></tag></tags><triggers><trigger><uuid>747a56182a6f4336b720a95b0609013c</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;arrayHvd&quot;)=2</expression><name>Status: Device has &quot;arrayHvd&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>e9d7a51b64444e27b28b13ebf38a11c3</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;batteryHvd&quot;)=2</expression><name>Status: Device has &quot;batteryHvd&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>b898ac485d094f1cb65020ad5459641b</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;batteryLvd&quot;)=2</expression><name>Status: Device has &quot;batteryLvd&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>806e83938072453ab66895044907c02d</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;blockbusBoot&quot;)=2</expression><name>Status: Device has &quot;blockbusBoot&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>f20f87cd6ce3414182cd2088a947ef24</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;chargeSlaveControlTimeout&quot;)=2</expression><name>Status: Device has &quot;chargeSlaveControlTimeout&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>f4478548ad17400c9cddbf8b27720952</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;controllerWasReset&quot;)=2</expression><name>Status: Device has &quot;controllerWasReset&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>6c9a64ff6f61457daf826e831f51b048</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;currentSensorReferenceOutOfRange&quot;)=2</expression><name>Status: Device has &quot;currentSensorReferenceOutOfRange&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>74d39d01841f454e8f72457104a42cb7</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;customSettingsEdit&quot;)=2</expression><name>Status: Device has &quot;customSettingsEdit&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>12d55fb0398c4fbb87ca948f2e692a38</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;dipSwitchChange&quot;)=2</expression><name>Status: Device has &quot;dipSwitchChange&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>25e71e9c3ad945ed9f48945cac45bb56</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;eepromRetryLimit&quot;)=2</expression><name>Status: Device has &quot;eepromRetryLimit&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>f6fafa09a41a428c87d5ef303071a7f7</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;fault16Software&quot;)=2</expression><name>Status: Device has &quot;fault16Software&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>8f079e7606d14dc2ab6313fdae80bafc</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;fault17Software&quot;)=2</expression><name>Status: Device has &quot;fault17Software&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>c388f647dd48445d8b8e3eee02ea38fc</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;fault18Software&quot;)=2</expression><name>Status: Device has &quot;fault18Software&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>1466954e09704b3092772f0996f692f4</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;fault19Software&quot;)=2</expression><name>Status: Device has &quot;fault19Software&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>86595bafc3054fd99343f24bbfdc44e3</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;fault20Software&quot;)=2</expression><name>Status: Device has &quot;fault20Software&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>d269607e330243fe93e2f85c36d38114</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;fault21Software&quot;)=2</expression><name>Status: Device has &quot;fault21Software&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>68d6b95b6b9e42ada5a212a913d1ae43</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;fetShort&quot;)=2</expression><name>Status: Device has &quot;fetShort&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>dcb1c2bcc704405c8baae825124e3958</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;fpgaVersion&quot;)=2</expression><name>Status: Device has &quot;fpgaVersion&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>351af5c43f984930b4ebdb8690c52e7d</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;hscomm&quot;)=2</expression><name>Status: Device has &quot;hscomm&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>b32067a9b80c4836af4120f9f8e21bbd</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;hscommMaster&quot;)=2</expression><name>Status: Device has &quot;hscommMaster&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>bb61ea6f03c94556bf4f333bc050206f</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;ia-refSlaveModeTimeout&quot;)=2</expression><name>Status: Device has &quot;ia-refSlaveModeTimeout&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>843654df3185400e854c8c1f0229c32c</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;overcurrent&quot;)=2</expression><name>Status: Device has &quot;overcurrent&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>642f03d6eda346aca835e75088b7067b</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;powerboardCommunicationFault&quot;)=2</expression><name>Status: Device has &quot;powerboardCommunicationFault&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>4d8f0244f8d047bc8730ffc2f02a976d</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;rs232SerialToMeterBridge&quot;)=2</expression><name>Status: Device has &quot;rs232SerialToMeterBridge&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>6c125b8f681b47a99f7535292bd0507c</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;rtsDisconnected&quot;)=2</expression><name>Status: Device has &quot;rtsDisconnected&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>abad398631f34dac8094e4bcd14e3613</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;rtsShorted&quot;)=2</expression><name>Status: Device has &quot;rtsShorted&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>6824d221feb042da860248a4b418105c</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;slave&quot;)=2</expression><name>Status: Device has &quot;slave&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>56adf438e90f410497246b27b6da49f4</uuid><expression>count(/Morningstar TriStar MPPT 600V by SNMP/status.faults[faults.0],#3,&quot;like&quot;,&quot;softwareFault&quot;)=2</expression><name>Status: Device has &quot;softwareFault&quot; faults flag</name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>d61bd2d5717740518867bfbf734914c9</uuid><name>Status: Uptime (hardware)</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.2.1.25.1.1.0</snmp_oid><key>status.hw.uptime</key><history>7d</history><units>uptime</units><description>The amount of time since this host was last initialized. Note that this is different from sysUpTime in the SNMPv2-MIB [RFC1907] because sysUpTime is the uptime of the network management portion of the system.</description><preprocessing><step><type>CHECK_NOT_SUPPORTED</type><parameters><parameter/></parameters><error_handler>CUSTOM_VALUE</error_handler><error_handler_params>0</error_handler_params></step><step><type>MULTIPLIER</type><parameters><parameter>0.01</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>status</value></tag></tags></item><item><uuid>e6a4dd0a61c8479985a1179842d22766</uuid><name>Status: Uptime (network)</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.2.1.1.3.0</snmp_oid><key>status.net.uptime</key><history>7d</history><units>uptime</units><description>The time (in hundredths of a second) since the network management portion of the system was last re-initialized.</description><preprocessing><step><type>MULTIPLIER</type><parameters><parameter>0.01</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>status</value></tag></tags><triggers><trigger><uuid>c4f0ea9e18884bc0b546933871017098</uuid><expression>nodata(/Morningstar TriStar MPPT 600V by SNMP/status.net.uptime,5m)=1</expression><name>Status: Failed to fetch data</name><event_name>Status: Failed to fetch data (or no data for 5m)</event_name><priority>WARNING</priority><description>Zabbix has not received data for items for the last 5 minutes.</description><manual_close>YES</manual_close><tags><tag><tag>scope</tag><value>availability</value></tag></tags></trigger></triggers></item><item><uuid>738f2e6d143a4e6db3ecf2736ca843cb</uuid><name>Battery: Target Voltage</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.7.45.0</snmp_oid><key>target.voltage[targetRegulationVoltage.0]</key><history>7d</history><value_type>FLOAT</value_type><units>V</units><description>MIB: TRISTAR-MPPT
Description:Target Voltage
Scaling Factor:1.0
Units:V
Range:[-10, 650.0]
Modbus address:0x0033</description><preprocessing><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>1h</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>battery</value></tag></tags></item><item><uuid>4f3fdc6382704fb584fbe11264a0e5c2</uuid><name>Temperature: Battery</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.7.48.0</snmp_oid><key>temp.battery[batteryTemperature.0]</key><history>7d</history><value_type>FLOAT</value_type><units>C</units><description>MIB: TRISTAR-MPPT
Description:Batt. Temp
Scaling Factor:1.0
Units:C
Range:[-40, 80]
Modbus address:0x0025</description><tags><tag><tag>component</tag><value>temperature</value></tag></tags><triggers><trigger><uuid>bc117de353304889980c7836603abb0d</uuid><expression>min(/Morningstar TriStar MPPT 600V by SNMP/temp.battery[batteryTemperature.0],5m)&gt;{$BATTERY.TEMP.MAX.CRIT}</expression><name>Temperature: Critically high battery temperature</name><event_name>Temperature: Critically high battery temperature (over {$BATTERY.TEMP.MAX.CRIT}C for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>25a8f16d632940c3a2c994a9f2a76851</uuid><expression>max(/Morningstar TriStar MPPT 600V by SNMP/temp.battery[batteryTemperature.0],5m)&lt;{$BATTERY.TEMP.MIN.CRIT}</expression><name>Temperature: Critically low battery temperature</name><event_name>Temperature: Critically low battery temperature (below {$BATTERY.TEMP.MIN.WARN}C for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>db1152c815c84d208be0db3dac63acb4</uuid><expression>min(/Morningstar TriStar MPPT 600V by SNMP/temp.battery[batteryTemperature.0],5m)&gt;{$BATTERY.TEMP.MAX.WARN}</expression><name>Temperature: High battery temperature</name><event_name>Temperature: High battery temperature (over {$BATTERY.TEMP.MAX.WARN}C for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><dependencies><dependency><name>Temperature: Critically high battery temperature</name><expression>min(/Morningstar TriStar MPPT 600V by SNMP/temp.battery[batteryTemperature.0],5m)&gt;{$BATTERY.TEMP.MAX.CRIT}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>9c331fb9a30b4867a3e16acd7e9f8983</uuid><expression>max(/Morningstar TriStar MPPT 600V by SNMP/temp.battery[batteryTemperature.0],5m)&lt;{$BATTERY.TEMP.MIN.WARN}</expression><name>Temperature: Low battery temperature</name><event_name>Temperature: Low battery temperature (below {$BATTERY.TEMP.MIN.WARN}C for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><dependencies><dependency><name>Temperature: Critically low battery temperature</name><expression>max(/Morningstar TriStar MPPT 600V by SNMP/temp.battery[batteryTemperature.0],5m)&lt;{$BATTERY.TEMP.MIN.CRIT}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>d3abc18d718540039adcfcb4a74bea43</uuid><name>Temperature: Heatsink</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.7.49.0</snmp_oid><key>temp.heatsink[heatsinkTemperature.0]</key><history>7d</history><value_type>FLOAT</value_type><units>C</units><description>MIB: TRISTAR-MPPT
Description:HS Temp
Scaling Factor:1.0
Units:C
Range:[-40, 80]
Modbus address:0x0023</description><tags><tag><tag>component</tag><value>temperature</value></tag></tags></item></items><discovery_rules><discovery_rule><uuid>7ba9493b38174751b448419b0b03312e</uuid><name>Battery voltage discovery</name><type>DEPENDENT</type><key>battery.voltage.discovery</key><delay>0</delay><description>Discovery for battery voltage triggers</description><item_prototypes><item_prototype><uuid>429d19822647434ca7df7016f44d690f</uuid><name>Battery: Voltage{#SINGLETON}</name><type>SNMP_AGENT</type><snmp_oid>1.3.6.1.4.1.33333.7.36.0</snmp_oid><key>battery.voltage[batteryVoltage.0{#SINGLETON}]</key><history>7d</history><value_type>FLOAT</value_type><units>V</units><description>MIB: TRISTAR-MPPT
Description:Battery voltage
Scaling Factor:1.0
Units:V
Range:[-10, 80]
Modbus address:0x0018</description><tags><tag><tag>component</tag><value>battery</value></tag></tags><trigger_prototypes><trigger_prototype><uuid>f326b9eb93fe4267bf9f4a07bb578eca</uuid><expression>min(/Morningstar TriStar MPPT 600V by SNMP/battery.voltage[batteryVoltage.0{#SINGLETON}],5m)&gt;{#VOLTAGE.MAX.CRIT}</expression><name>Battery: Critically high battery voltage</name><event_name>Battery: Critically high battery voltage (over {#VOLTAGE.MAX.CRIT}V for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger_prototype><trigger_prototype><uuid>07fb5dd68c954da3982392dfcb2de0b8</uuid><expression>max(/Morningstar TriStar MPPT 600V by SNMP/battery.voltage[batteryVoltage.0{#SINGLETON}],5m)&lt;{#VOLTAGE.MIN.CRIT}</expression><name>Battery: Critically low battery voltage</name><event_name>Battery: Critically low battery voltage (below {#VOLTAGE.MIN.CRIT}V for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>HIGH</priority><tags><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger_prototype><trigger_prototype><uuid>aca6ef49842d4b3ba543fcf470473a96</uuid><expression>min(/Morningstar TriStar MPPT 600V by SNMP/battery.voltage[batteryVoltage.0{#SINGLETON}],5m)&gt;{#VOLTAGE.MAX.WARN}</expression><name>Battery: High battery voltage</name><event_name>Battery: High battery voltage (over {#VOLTAGE.MAX.WARN}V for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><dependencies><dependency><name>Battery: Critically high battery voltage</name><expression>min(/Morningstar TriStar MPPT 600V by SNMP/battery.voltage[batteryVoltage.0{#SINGLETON}],5m)&gt;{#VOLTAGE.MAX.CRIT}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger_prototype><trigger_prototype><uuid>b8673c0802a244d0850730e3fdf5a6dc</uuid><expression>max(/Morningstar TriStar MPPT 600V by SNMP/battery.voltage[batteryVoltage.0{#SINGLETON}],5m)&lt;{#VOLTAGE.MIN.WARN}</expression><name>Battery: Low battery voltage</name><event_name>Battery: Low battery voltage (below {#VOLTAGE.MIN.WARN}V for 5m)</event_name><opdata>Current value: {ITEM.LASTVALUE1}</opdata><priority>WARNING</priority><dependencies><dependency><name>Battery: Critically low battery voltage</name><expression>max(/Morningstar TriStar MPPT 600V by SNMP/battery.voltage[batteryVoltage.0{#SINGLETON}],5m)&lt;{#VOLTAGE.MIN.CRIT}</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger_prototype></trigger_prototypes></item_prototype></item_prototypes><graph_prototypes><graph_prototype><uuid>592990e094e842f68463ab542878d5a9</uuid><name>Battery: Voltage{#SINGLETON}</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>Morningstar TriStar MPPT 600V by SNMP</host><key>battery.voltage[batteryVoltage.0{#SINGLETON}]</key></item></graph_item></graph_items></graph_prototype></graph_prototypes><master_item><key>battery.voltage.discovery[batteryVoltage.0]</key></master_item><preprocessing><step><type>JAVASCRIPT</type><parameters><parameter>var v_range = [
      [[0, 18], [12, 15, 11.5, 15.5]],
      [[18, 36], [24, 30, 23, 31]],
      [[36, 99], [48, 60, 46, 62]],
  ],
  result = [];

for (var idx in v_range) {
    if (v_range[idx][0][0] &lt; value &amp;&amp; value &lt;= v_range[idx][0][1]) {
        result = [{
            '{#VOLTAGE.MIN.WARN}': parseInt({$VOLTAGE.MIN.WARN}) || v_range[idx][1][0],
            '{#VOLTAGE.MAX.WARN}': parseInt({$VOLTAGE.MAX.WARN}) || v_range[idx][1][1],
            '{#VOLTAGE.MIN.CRIT}': parseInt({$VOLTAGE.MIN.CRIT}) || v_range[idx][1][2],
            '{#VOLTAGE.MAX.CRIT}': parseInt({$VOLTAGE.MAX.CRIT}) || v_range[idx][1][3],
            '{#SINGLETON}': ''
        }];
        break;
    }
}

return JSON.stringify(result);</parameter></parameters></step></preprocessing></discovery_rule></discovery_rules><tags><tag><tag>class</tag><value>power</value></tag><tag><tag>target</tag><value>morningstar</value></tag></tags><macros><macro><macro>{$BATTERY.TEMP.MAX.CRIT}</macro><value>60</value><description>Battery high temperature critical value</description></macro><macro><macro>{$BATTERY.TEMP.MAX.WARN}</macro><value>45</value><description>Battery high temperature warning value</description></macro><macro><macro>{$BATTERY.TEMP.MIN.CRIT}</macro><value>-20</value><description>Battery low temperature critical value</description></macro><macro><macro>{$BATTERY.TEMP.MIN.WARN}</macro><value>0</value><description>Battery low temperature warning value</description></macro><macro><macro>{$CHARGE.STATE.CRIT}</macro><value>4</value><description>fault</description></macro><macro><macro>{$CHARGE.STATE.WARN}</macro><value>2</value><description>disconnect</description></macro><macro><macro>{$LOAD.STATE.CRIT:&quot;fault&quot;}</macro><value>4</value><description>fault</description></macro><macro><macro>{$LOAD.STATE.CRIT:&quot;lvd&quot;}</macro><value>3</value><description>lvd</description></macro><macro><macro>{$LOAD.STATE.WARN:&quot;disconnect&quot;}</macro><value>5</value><description>disconnect</description></macro><macro><macro>{$LOAD.STATE.WARN:&quot;lvdWarning&quot;}</macro><value>2</value><description>lvdWarning</description></macro><macro><macro>{$LOAD.STATE.WARN:&quot;override&quot;}</macro><value>7</value><description>override</description></macro><macro><macro>{$VOLTAGE.MAX.CRIT}</macro></macro><macro><macro>{$VOLTAGE.MAX.WARN}</macro></macro><macro><macro>{$VOLTAGE.MIN.CRIT}</macro></macro><macro><macro>{$VOLTAGE.MIN.WARN}</macro></macro></macros><valuemaps><valuemap><uuid>8a0dfdf98d254c219905751cccc878d7</uuid><name>TriStar MPPT 600V charge state</name><mappings><mapping><value>0</value><newvalue>Start</newvalue></mapping><mapping><value>1</value><newvalue>NightCheck</newvalue></mapping><mapping><value>2</value><newvalue>Disconnect</newvalue></mapping><mapping><value>3</value><newvalue>Night</newvalue></mapping><mapping><value>4</value><newvalue>Fault</newvalue></mapping><mapping><value>5</value><newvalue>Mppt</newvalue></mapping><mapping><value>6</value><newvalue>Absorption</newvalue></mapping><mapping><value>7</value><newvalue>Float</newvalue></mapping><mapping><value>8</value><newvalue>Equalize</newvalue></mapping><mapping><value>9</value><newvalue>Slave</newvalue></mapping><mapping><value>10</value><newvalue>Fixed</newvalue></mapping></mappings></valuemap></valuemaps></template></templates><triggers><trigger><uuid>5393dee9b39d438a8c1553a0be0fb0f2</uuid><expression>(last(/Morningstar TriStar MPPT 600V by SNMP/status.hw.uptime)&gt;0 and last(/Morningstar TriStar MPPT 600V by SNMP/status.hw.uptime)&lt;10m) or (last(/Morningstar TriStar MPPT 600V by SNMP/status.hw.uptime)=0 and last(/Morningstar TriStar MPPT 600V by SNMP/status.net.uptime)&lt;10m)</expression><name>Status: Device has been restarted</name><event_name>Status: Device has been restarted (uptime &lt; 10m)</event_name><priority>INFO</priority><description>Uptime is less than 10 minutes.</description><manual_close>YES</manual_close><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers><graphs><graph><uuid>6627675fc86645a88d7be9a80c91a8b4</uuid><name>Array: Voltage</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>Morningstar TriStar MPPT 600V by SNMP</host><key>array.sweep_vmp[arrayVmpLastSweep.0]</key></item></graph_item><graph_item><sortorder>1</sortorder><drawtype>GRADIENT_LINE</drawtype><color>2774A4</color><item><host>Morningstar TriStar MPPT 600V by SNMP</host><key>array.sweep_voc[arrayVocLastSweep.0]</key></item></graph_item><graph_item><sortorder>2</sortorder><drawtype>GRADIENT_LINE</drawtype><color>F63100</color><item><host>Morningstar TriStar MPPT 600V by SNMP</host><key>array.voltage[arrayVoltage.0]</key></item></graph_item></graph_items></graph><graph><uuid>711c5f397c5e4031b36070d20debcc13</uuid><name>Battery: Current</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>Morningstar TriStar MPPT 600V by SNMP</host><key>charge.current[batteryCurrent.0]</key></item></graph_item></graph_items></graph><graph><uuid>12163228805449dcb48116a1a0b470d9</uuid><name>Battery: Output Power (Watts)</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>Morningstar TriStar MPPT 600V by SNMP</host><key>charge.output_power[ outputPower.0]</key></item></graph_item></graph_items></graph><graph><uuid>09e9cd48bb6241e8b667e6e1b9f7c3ad</uuid><name>Temperature: Battery/Heatsink</name><graph_items><graph_item><drawtype>GRADIENT_LINE</drawtype><color>1A7C11</color><item><host>Morningstar TriStar MPPT 600V by SNMP</host><key>temp.battery[batteryTemperature.0]</key></item></graph_item><graph_item><sortorder>1</sortorder><drawtype>GRADIENT_LINE</drawtype><color>2774A4</color><item><host>Morningstar TriStar MPPT 600V by SNMP</host><key>temp.heatsink[heatsinkTemperature.0]</key></item></graph_item></graph_items></graph></graphs></zabbix_export>
