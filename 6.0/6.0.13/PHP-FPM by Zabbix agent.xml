<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>6.0</version><date>2023-02-11T16:14:46Z</date><groups><group><uuid>a571c0d144b14fd4a87a9d9b2aa9fcd6</uuid><name>Templates/Applications</name></group></groups><templates><template><uuid>1cbda0970410435684135884d0cb7090</uuid><template>PHP-FPM by Zabbix agent</template><name>PHP-FPM by Zabbix agent</name><description>Get PHP-FPM metrics using Zabbix agent running on Linux.

Note that depending on your OS distribution, the PHP-FPM process name may vary. Please, check the actual name in the line &quot;Name&quot; from /proc/&lt;pid&gt;/status file (https://www.zabbix.com/documentation/6.0/manual/appendix/items/proc_mem_num_notes) and change {$PHP_FPM.PROCESS_NAME} macro if needed.


Template tooling version used: 0.41</description><groups><group><name>Templates/Applications</name></group></groups><items><item><uuid>9ae9e2a8003a48a7a482ef6d6ae9886c</uuid><name>PHP-FPM: Accepted connections per second</name><type>DEPENDENT</type><key>php-fpm.conn_accepted.rate</key><delay>0</delay><history>7d</history><value_type>FLOAT</value_type><description>The number of accepted requests per second.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.['accepted conn']</parameter></parameters></step><step><type>CHANGE_PER_SECOND</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.STATUS.PAGE}?json&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>connections</value></tag></tags></item><item><uuid>edc6b68194fe499facfb6b22425ff0d4</uuid><name>PHP-FPM: Listen queue</name><type>DEPENDENT</type><key>php-fpm.listen_queue</key><delay>0</delay><history>7d</history><description>The current number of connections that have been initiated, but not yet accepted.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.['listen queue']</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.STATUS.PAGE}?json&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>listen-queue</value></tag></tags></item><item><uuid>aff9f072b06a4b56afb0e0f44b2c83a4</uuid><name>PHP-FPM: Listen queue, len</name><type>DEPENDENT</type><key>php-fpm.listen_queue_len</key><delay>0</delay><history>7d</history><description>Size of the socket queue of pending connections.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.['listen queue len']</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.STATUS.PAGE}?json&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>listen-queue</value></tag></tags></item><item><uuid>de0a543bee5a46c88085b2aba2f4976f</uuid><name>PHP-FPM: Listen queue, max</name><type>DEPENDENT</type><key>php-fpm.listen_queue_max</key><delay>0</delay><history>7d</history><description>The maximum number of requests in the queue of pending connections since this FPM pool has started.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.['max listen queue']</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.STATUS.PAGE}?json&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>listen-queue</value></tag></tags></item><item><uuid>dfabcd55c13449c29a48b70fdce77674</uuid><name>PHP-FPM: Queue usage</name><type>CALCULATED</type><key>php-fpm.listen_queue_usage</key><history>7d</history><value_type>FLOAT</value_type><units>%</units><params>last(//php-fpm.listen_queue)/(last(//php-fpm.listen_queue_len)+(last(//php-fpm.listen_queue_len)=0))*100</params><description>Queue utilization</description><tags><tag><tag>component</tag><value>application</value></tag></tags><triggers><trigger><uuid>a11264f0e1174b7fb81b457dad1a745f</uuid><expression>min(/PHP-FPM by Zabbix agent/php-fpm.listen_queue_usage,15m) &gt; {$PHP_FPM.QUEUE.WARN.MAX}</expression><name>PHP-FPM: Queue utilization is high</name><event_name>PHP-FPM: Queue utilization is high (over {$PHP_FPM.QUEUE.WARN.MAX}% for 15m)</event_name><priority>WARNING</priority><description>The queue for this pool reached {$PHP_FPM.QUEUE.WARN.MAX}% of its maximum capacity. Items in queue represent the current number of connections that have been initiated on this pool, but not yet accepted.</description><tags><tag><tag>scope</tag><value>capacity</value></tag></tags></trigger></triggers></item><item><uuid>e9d49669cf58492a9d5ef7ff997e1a40</uuid><name>PHP-FPM: Max children reached</name><type>DEPENDENT</type><key>php-fpm.max_children</key><delay>0</delay><history>7d</history><description>The number of times that pm.max_children has been reached since the php-fpm pool started</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.['max children reached']</parameter></parameters></step><step><type>SIMPLE_CHANGE</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.STATUS.PAGE}?json&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>application</value></tag></tags></item><item><uuid>830e04be30f04e50ac0fa4783ecdc677</uuid><name>PHP-FPM: Pool name</name><type>DEPENDENT</type><key>php-fpm.name</key><delay>0</delay><history>7d</history><trends>0</trends><value_type>CHAR</value_type><description>The name of current pool.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.pool</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>3h</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.STATUS.PAGE}?json&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>application</value></tag></tags></item><item><uuid>250f346008984a95829dba08d0f95838</uuid><name>PHP-FPM: Ping</name><type>DEPENDENT</type><key>php-fpm.ping</key><delay>0</delay><history>7d</history><valuemap><name>Service state</name></valuemap><preprocessing><step><type>REGEX</type><parameters><parameter>{$PHP_FPM.PING.REPLY}($|\r?\n)</parameter><parameter>1</parameter></parameters><error_handler>CUSTOM_VALUE</error_handler><error_handler_params>0</error_handler_params></step></preprocessing><master_item><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.PING.PAGE}&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>health</value></tag></tags><triggers><trigger><uuid>10d92102d7a24327ada7869a41119fee</uuid><expression>last(/PHP-FPM by Zabbix agent/php-fpm.ping)=0 or nodata(/PHP-FPM by Zabbix agent/php-fpm.ping,3m)=1</expression><name>PHP-FPM: Service is down</name><priority>HIGH</priority><manual_close>YES</manual_close><dependencies><dependency><name>PHP-FPM: Process is not running</name><expression>last(/PHP-FPM by Zabbix agent/proc.num[&quot;{$PHP_FPM.PROCESS_NAME}&quot;])=0</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>availability</value></tag></tags></trigger></triggers></item><item><uuid>8ebee5fc8c854a96b34ed743e3dd0154</uuid><name>PHP-FPM: Processes, active</name><type>DEPENDENT</type><key>php-fpm.processes_active</key><delay>0</delay><history>7d</history><description>The total number of active processes.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.['active processes']</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.STATUS.PAGE}?json&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>system</value></tag></tags></item><item><uuid>11cfd028325242a58d61d9e83aee640b</uuid><name>PHP-FPM: Processes, idle</name><type>DEPENDENT</type><key>php-fpm.processes_idle</key><delay>0</delay><history>7d</history><description>The total number of idle processes.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.['idle processes']</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.STATUS.PAGE}?json&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>system</value></tag></tags></item><item><uuid>3858218f90684bb19cbe27fc9aedf404</uuid><name>PHP-FPM: Processes, max active</name><type>DEPENDENT</type><key>php-fpm.processes_max_active</key><delay>0</delay><history>7d</history><description>The highest value that 'active processes' has reached since the php-fpm server started.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.['max active processes']</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.STATUS.PAGE}?json&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>application</value></tag></tags></item><item><uuid>a79af6cf38ec45518055c64aa7f1f5a2</uuid><name>PHP-FPM: Processes, total</name><type>DEPENDENT</type><key>php-fpm.processes_total</key><delay>0</delay><history>7d</history><description>The total number of server processes currently running.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.['total processes']</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.STATUS.PAGE}?json&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>system</value></tag></tags></item><item><uuid>5ab12fc9f4ef49e5bbf7b2c6a840879e</uuid><name>PHP-FPM: Process manager</name><type>DEPENDENT</type><key>php-fpm.process_manager</key><delay>0</delay><history>7d</history><trends>0</trends><value_type>CHAR</value_type><description>The method used by the process manager to control the number of child processes for this pool.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.['process manager']</parameter></parameters></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>3h</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.STATUS.PAGE}?json&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>application</value></tag></tags><triggers><trigger><uuid>231e0fbfb6e94f34b790576766244602</uuid><expression>last(/PHP-FPM by Zabbix agent/php-fpm.process_manager,#1)&lt;&gt;last(/PHP-FPM by Zabbix agent/php-fpm.process_manager,#2)</expression><name>PHP-FPM: Manager  changed</name><event_name>PHP-FPM: Manager  changed (new value received: {ITEM.VALUE})</event_name><priority>INFO</priority><description>PHP-FPM manager changed. Ack to close.</description><manual_close>YES</manual_close><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>4d17b6d89ac94d0880eac6962ebf7347</uuid><name>PHP-FPM: Slow requests</name><type>DEPENDENT</type><key>php-fpm.slow_requests</key><delay>0</delay><history>7d</history><description>The number of requests that exceeded your request_slowlog_timeout value.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.['slow requests']</parameter></parameters></step><step><type>SIMPLE_CHANGE</type><parameters><parameter/></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.STATUS.PAGE}?json&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>application</value></tag></tags><triggers><trigger><uuid>f30147d8e92f48aa8fedc2d28b8d7c70</uuid><expression>min(/PHP-FPM by Zabbix agent/php-fpm.slow_requests,#3)&gt;0</expression><name>PHP-FPM: Detected slow requests</name><priority>WARNING</priority><description>PHP-FPM detected slow request. A slow request means that it took more time to execute than expected (defined in the configuration of your pool).</description><tags><tag><tag>scope</tag><value>performance</value></tag></tags></trigger></triggers></item><item><uuid>4e4d6eda8fbb4dd2ba7f48fba5723473</uuid><name>PHP-FPM: Start time</name><type>DEPENDENT</type><key>php-fpm.start_time</key><delay>0</delay><history>7d</history><units>unixtime</units><description>The time when this pool was started.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.['start time']</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.STATUS.PAGE}?json&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>application</value></tag></tags></item><item><uuid>2a19b306712a47999e70d3ec30e39b05</uuid><name>PHP-FPM: Uptime</name><type>DEPENDENT</type><key>php-fpm.uptime</key><delay>0</delay><history>7d</history><units>s</units><description>How long has this pool been running.</description><preprocessing><step><type>JSONPATH</type><parameters><parameter>$.['start since']</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.STATUS.PAGE}?json&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>application</value></tag></tags><triggers><trigger><uuid>bdf9962aee2049a8aec000b037b94d60</uuid><expression>nodata(/PHP-FPM by Zabbix agent/php-fpm.uptime,30m)=1</expression><name>PHP-FPM: Failed to fetch info data</name><event_name>PHP-FPM: Failed to fetch info data (or no data for 30m)</event_name><priority>INFO</priority><description>Zabbix has not received data for items for the last 30 minutes</description><manual_close>YES</manual_close><dependencies><dependency><name>PHP-FPM: Process is not running</name><expression>last(/PHP-FPM by Zabbix agent/proc.num[&quot;{$PHP_FPM.PROCESS_NAME}&quot;])=0</expression></dependency></dependencies><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger><trigger><uuid>c6966a6c3ff0452ab4fd112c9299e624</uuid><expression>last(/PHP-FPM by Zabbix agent/php-fpm.uptime)&lt;10m</expression><name>PHP-FPM: Pool has been restarted</name><event_name>PHP-FPM: Pool has been restarted (uptime &lt; 10m)</event_name><priority>INFO</priority><description>Uptime is less than 10 minutes.</description><manual_close>YES</manual_close><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>b53e2e356317468f9d6d3272eb755650</uuid><name>PHP-FPM: Version</name><type>DEPENDENT</type><key>php-fpm.version</key><delay>0</delay><history>7d</history><trends>0</trends><value_type>CHAR</value_type><description>Current version PHP. Get from HTTP-Header &quot;X-Powered-By&quot; and may not work if you change default HTTP-headers.</description><preprocessing><step><type>REGEX</type><parameters><parameter>^[.\s\S]*X-Powered-By: PHP/([.\d]{1,})</parameter><parameter>\1</parameter></parameters><error_handler>DISCARD_VALUE</error_handler></step><step><type>DISCARD_UNCHANGED_HEARTBEAT</type><parameters><parameter>3h</parameter></parameters></step></preprocessing><master_item><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.PING.PAGE}&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key></master_item><tags><tag><tag>component</tag><value>application</value></tag></tags><triggers><trigger><uuid>fb110a37f0fc4a62b51df72e33bc3448</uuid><expression>last(/PHP-FPM by Zabbix agent/php-fpm.version,#1)&lt;&gt;last(/PHP-FPM by Zabbix agent/php-fpm.version,#2) and length(last(/PHP-FPM by Zabbix agent/php-fpm.version))&gt;0</expression><name>PHP-FPM: Version has changed</name><event_name>PHP-FPM: Version has changed (new version: {ITEM.VALUE})</event_name><priority>INFO</priority><description>PHP-FPM version has changed. Ack to close.</description><manual_close>YES</manual_close><tags><tag><tag>scope</tag><value>notice</value></tag></tags></trigger></triggers></item><item><uuid>a709eaae52ad4128a129c618db6525d2</uuid><name>PHP-FPM: CPU utilization</name><key>proc.cpu.util[&quot;{$PHP_FPM.PROCESS_NAME}&quot;]</key><history>7d</history><value_type>FLOAT</value_type><units>%</units><description>Process CPU utilization percentage.</description><tags><tag><tag>component</tag><value>cpu</value></tag></tags></item><item><uuid>ef771994ec9e482babf872d9f867d500</uuid><name>PHP-FPM: Memory usage, %</name><key>proc.mem[&quot;{$PHP_FPM.PROCESS_NAME}&quot;,,,,pmem]</key><history>7d</history><value_type>FLOAT</value_type><units>%</units><description>Memory used percentage relative to total memory available.</description><tags><tag><tag>component</tag><value>memory</value></tag></tags></item><item><uuid>f55a5ef29f864d0a8c1af25df2372f7c</uuid><name>PHP-FPM: Memory usage (rss)</name><key>proc.mem[&quot;{$PHP_FPM.PROCESS_NAME}&quot;,,,,rss]</key><history>7d</history><units>B</units><description>Resident set size memory used by process in bytes.</description><tags><tag><tag>component</tag><value>memory</value></tag></tags></item><item><uuid>ab8dc0d1ce344fe8ae6a22716a168fbd</uuid><name>PHP-FPM: Number of processes running</name><key>proc.num[&quot;{$PHP_FPM.PROCESS_NAME}&quot;]</key><history>7d</history><tags><tag><tag>component</tag><value>system</value></tag></tags><triggers><trigger><uuid>21a03d0ada634602ae9089a2cf3b4d70</uuid><expression>last(/PHP-FPM by Zabbix agent/proc.num[&quot;{$PHP_FPM.PROCESS_NAME}&quot;])=0</expression><name>PHP-FPM: Process is not running</name><priority>HIGH</priority><tags><tag><tag>scope</tag><value>availability</value></tag></tags></trigger></triggers></item><item><uuid>c0c438492c63453496e83938745ffffc</uuid><name>PHP-FPM: php-fpm_ping</name><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.PING.PAGE}&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key><history>0</history><trends>0</trends><value_type>TEXT</value_type><tags><tag><tag>component</tag><value>health</value></tag></tags></item><item><uuid>09ec73291f21417ab8f19f56fda3331f</uuid><name>PHP-FPM: Get status page</name><key>web.page.get[&quot;{$PHP_FPM.HOST}&quot;,&quot;{$PHP_FPM.STATUS.PAGE}?json&quot;,&quot;{$PHP_FPM.PORT}&quot;]</key><history>0</history><trends>0</trends><value_type>TEXT</value_type><preprocessing><step><type>REGEX</type><parameters><parameter>^[.\s\S]*({.+})</parameter><parameter>\1</parameter></parameters></step></preprocessing><tags><tag><tag>component</tag><value>raw</value></tag></tags></item></items><tags><tag><tag>class</tag><value>application</value></tag><tag><tag>target</tag><value>php-fpm</value></tag></tags><macros><macro><macro>{$PHP_FPM.HOST}</macro><value>localhost</value><description>Hostname or IP of PHP-FPM status host or container.</description></macro><macro><macro>{$PHP_FPM.PING.PAGE}</macro><value>ping</value><description>The path of PHP-FPM ping page.</description></macro><macro><macro>{$PHP_FPM.PING.REPLY}</macro><value>pong</value><description>Expected reply to the ping.</description></macro><macro><macro>{$PHP_FPM.PORT}</macro><value>80</value><description>The port of PHP-FPM status host or container.</description></macro><macro><macro>{$PHP_FPM.PROCESS_NAME}</macro><value>php-fpm</value><description>PHP-FPM process name. May vary depending on your OS distribution.</description></macro><macro><macro>{$PHP_FPM.QUEUE.WARN.MAX}</macro><value>80</value><description>The maximum PHP-FPM queue usage percent for trigger expression.</description></macro><macro><macro>{$PHP_FPM.STATUS.PAGE}</macro><value>status</value><description>The path of PHP-FPM status page.</description></macro></macros><valuemaps><valuemap><uuid>1caa1e7c41e14c7492ab8112f93ea068</uuid><name>Service state</name><mappings><mapping><value>0</value><newvalue>Down</newvalue></mapping><mapping><value>1</value><newvalue>Up</newvalue></mapping></mappings></valuemap></valuemaps></template></templates><graphs><graph><uuid>36cd028132d94585877ad5726f0f9e3d</uuid><name>PHP-FPM: Process</name><graph_items><graph_item><color>1A7C11</color><item><host>PHP-FPM by Zabbix agent</host><key>php-fpm.processes_max_active</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>PHP-FPM by Zabbix agent</host><key>php-fpm.processes_idle</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>PHP-FPM by Zabbix agent</host><key>php-fpm.processes_total</key></item></graph_item><graph_item><sortorder>3</sortorder><color>A54F10</color><item><host>PHP-FPM by Zabbix agent</host><key>php-fpm.processes_active</key></item></graph_item></graph_items></graph><graph><uuid>768a3e8aaa4741239887b55be5842f4a</uuid><name>PHP-FPM: Queue</name><graph_items><graph_item><color>1A7C11</color><item><host>PHP-FPM by Zabbix agent</host><key>php-fpm.listen_queue_len</key></item></graph_item><graph_item><sortorder>1</sortorder><color>2774A4</color><item><host>PHP-FPM by Zabbix agent</host><key>php-fpm.listen_queue</key></item></graph_item><graph_item><sortorder>2</sortorder><color>F63100</color><item><host>PHP-FPM by Zabbix agent</host><key>php-fpm.listen_queue_max</key></item></graph_item></graph_items></graph></graphs></zabbix_export>
